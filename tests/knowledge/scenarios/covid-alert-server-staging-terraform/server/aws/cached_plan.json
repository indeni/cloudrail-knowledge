{"format_version":"0.1","terraform_version":"0.13.4","variables":{"billing_tag_key":{"value":"CostCentre"},"billing_tag_value":{"value":"CovidShield"},"claimed_one_time_code_total_critical":{"value":4500},"claimed_one_time_code_total_warn":{"value":3000},"cloudfront_custom_header":{"value":"test123"},"cloudwatch_log_group_name":{"value":"CovidShield"},"cpu_scale_metric":{"value":60},"cpu_units":{"value":512},"diagnosis_key_total_critical":{"value":13500},"diagnosis_key_total_warn":{"value":9000},"ecs_key_retrieval_name":{"value":"KeyRetrieval"},"ecs_key_submission_name":{"value":"KeySubmission"},"ecs_name":{"value":"CovidShield"},"ecs_task_key_retrieval_env_ecdsa_key":{"value":"test123"},"ecs_task_key_retrieval_env_hmac_key":{"value":"test123"},"ecs_task_key_submission_env_key_claim_token":{"value":"test123"},"enable_test_tools":{"value":true},"environment":{"value":"test"},"feature_redis":{"value":true},"feature_shield":{"value":true},"github_sha":{"value":""},"manual_deploy_enabled":{"value":false},"max_capacity":{"value":10},"memory":{"value":1024},"memory_scale_metric":{"value":60},"metric_provider":{"value":"stdout"},"metrics_password":{"value":"test"},"metrics_username":{"value":"test"},"min_capacity":{"value":1},"new_key_claim_allow_list":{"value":["0.0.0.0/1","128.0.0.0/1"]},"rds_db_subnet_group_name":{"value":"server"},"rds_server_allocated_storage":{"value":"5"},"rds_server_db_name":{"value":"server"},"rds_server_db_password":{"value":"test"},"rds_server_db_user":{"value":"root"},"rds_server_instance_class":{"value":"db.t3.small"},"region":{"value":"ca-central-1"},"retrieval_autoscale_enabled":{"value":true},"route53_zone_name":{"value":"test.com"},"scale_in_cooldown":{"value":60},"scale_out_cooldown":{"value":60},"submission_autoscale_enabled":{"value":true},"termination_wait_time_in_minutes":{"value":1},"tracer_provider":{"value":"stdout"},"unclaimed_one_time_code_total_critical":{"value":400},"unclaimed_one_time_code_total_warn":{"value":250},"vpc_cidr_block":{"value":"10.0.0.0/16"},"vpc_name":{"value":"CovidShield"}},"planned_values":{"outputs":{"aws_db_subnet_group":{"sensitive":false,"value":{"arn":"aws_db_subnet_group.covidshield.arn","description":"Managed by Terraform","id":"aws_db_subnet_group.covidshield.id","name":"server","name_prefix":"aws_db_subnet_group.covidshield.name_prefix","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":{"CostCentre":"CovidShield","Name":"server"},"tags_all":{"CostCentre":"CovidShield","Name":"server"}}},"aws_private_subnets":{"sensitive":false},"aws_public_subnets":{"sensitive":false},"cloudwatch_log_group":{"sensitive":false,"value":{"arn":"aws_cloudwatch_log_group.covidshield.arn","id":"aws_cloudwatch_log_group.covidshield.id","kms_key_id":"aws_kms_key.cw.arn","name":"CovidShield","name_prefix":"aws_cloudwatch_log_group.covidshield.name_prefix","retention_in_days":90,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},"ecr_repository_url":{"sensitive":false,"value":{"covid-server/key-retrieval":"aws_ecr_repository.repository[key-retrieval].repository_url","covid-server/key-submission":"aws_ecr_repository.repository[key-submission].repository_url","covid-server/monolith":"aws_ecr_repository.repository[monolith].repository_url"}},"ecs_cluster":{"sensitive":false,"value":{"arn":"aws_ecs_cluster.covidshield.arn","capacity_providers":null,"configuration":[],"default_capacity_provider_strategy":[],"id":"aws_ecs_cluster.covidshield.id","name":"CovidShield","setting":[{"name":"containerInsights","value":"enabled"}],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},"route53_submission_fqdn":{"sensitive":false},"route53_zone":{"sensitive":false},"security_group_load_balancer":{"sensitive":false,"value":{"arn":"aws_security_group.covidshield_load_balancer.arn","description":"Ingress - CovidShield Load Balancer","egress":[{"cidr_blocks":["10.0.0.0/24"],"description":"retrieval target ca-central-1a","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.0.0/24"],"description":"submission target ca-central-1a","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.1.0/24"],"description":"retrieval target ca-central-1b","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.1.0/24"],"description":"submission target ca-central-1b","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.2.0/24"],"description":"retrieval target ca-central-1d","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.2.0/24"],"description":"submission target ca-central-1d","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000}],"id":"aws_security_group.covidshield_load_balancer.id","ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443},{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":8443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8443}],"name":"covidshield-load-balancer","name_prefix":"aws_security_group.covidshield_load_balancer.name_prefix","owner_id":"aws_security_group.covidshield_load_balancer.owner_id","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},"vpc":{"sensitive":false}},"root_module":{"resources":[{"address":"aws_acm_certificate.covidshield","mode":"managed","type":"aws_acm_certificate","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"test.com","domain_validation_options":[{"domain_name":"*.test.com"},{"domain_name":"test.com"}],"options":[],"private_key":null,"subject_alternative_names":["*.test.com"],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"validation_method":"DNS"}},{"address":"aws_acm_certificate.retrieval_covidshield","mode":"managed","type":"aws_acm_certificate","name":"retrieval_covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"retrieval.test.com","domain_validation_options":[{"domain_name":"retrieval.test.com"}],"options":[],"private_key":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"validation_method":"DNS"}},{"address":"aws_acm_certificate_validation.covidshield","mode":"managed","type":"aws_acm_certificate_validation","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_arn":"aws_acm_certificate.covidshield.arn","timeouts":null,"validation_record_fqdns":["aws_route53_record.covidshield_certificate_validation[*.test.com].fqdn","aws_route53_record.covidshield_certificate_validation[test.com].fqdn"]}},{"address":"aws_acm_certificate_validation.retrieval_covidshield","mode":"managed","type":"aws_acm_certificate_validation","name":"retrieval_covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"certificate_arn":"aws_acm_certificate.retrieval_covidshield.arn","timeouts":null,"validation_record_fqdns":["aws_route53_record.retrieval_covidshield_certificate_validation[retrieval.test.com].fqdn"]}},{"address":"aws_appautoscaling_policy.retrieval_cpu[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"retrieval_cpu","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"retrieval_cpu","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeyRetrieval","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageCPUUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]}},{"address":"aws_appautoscaling_policy.retrieval_memory[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"retrieval_memory","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"retrieval_memory","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeyRetrieval","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageMemoryUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]}},{"address":"aws_appautoscaling_policy.submission_cpu[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"submission_cpu","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"submission_cpu","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeySubmission","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageCPUUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]}},{"address":"aws_appautoscaling_policy.submission_memory[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"submission_memory","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"submission_memory","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeySubmission","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageMemoryUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]}},{"address":"aws_appautoscaling_target.retrieval[0]","mode":"managed","type":"aws_appautoscaling_target","name":"retrieval","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"max_capacity":10,"min_capacity":1,"resource_id":"service/aws_ecs_cluster.covidshield.id/KeyRetrieval","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs"}},{"address":"aws_appautoscaling_target.submission[0]","mode":"managed","type":"aws_appautoscaling_target","name":"submission","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"max_capacity":10,"min_capacity":1,"resource_id":"service/aws_ecs_cluster.covidshield.id/KeySubmission","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs"}},{"address":"aws_cloudfront_distribution.key_retrieval_distribution","mode":"managed","type":"aws_cloudfront_distribution","name":"key_retrieval_distribution","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"aliases":["retrieval.test.com"],"comment":null,"custom_error_response":[],"default_cache_behavior":[{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":true,"default_ttl":3600,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"all","whitelisted_names":null}],"headers":["Host"],"query_string":true,"query_string_cache_keys":null}],"function_association":[],"lambda_function_association":[],"max_ttl":7200,"min_ttl":0,"origin_request_policy_id":null,"realtime_log_config_arn":null,"smooth_streaming":null,"target_origin_id":"covidshield-key-retrieval","trusted_key_groups":null,"trusted_signers":null,"viewer_protocol_policy":"https-only"}],"default_root_object":null,"enabled":true,"http_version":"http2","is_ipv6_enabled":true,"logging_config":[{"bucket":"aws_s3_bucket.cloudfront_logs.bucket_domain_name","include_cookies":false,"prefix":"cloudfront"}],"ordered_cache_behavior":[{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":true,"default_ttl":86400,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"none","whitelisted_names":null}],"headers":["Origin"],"query_string":false,"query_string_cache_keys":null}],"function_association":[],"lambda_function_association":[],"max_ttl":31536000,"min_ttl":0,"origin_request_policy_id":null,"path_pattern":"/exposure-configuration/*","realtime_log_config_arn":null,"smooth_streaming":null,"target_origin_id":"covid-shield-exposure-config-test","trusted_key_groups":null,"trusted_signers":null,"viewer_protocol_policy":"https-only"},{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":true,"default_ttl":0,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"all","whitelisted_names":null}],"headers":["Authorization","Host"],"query_string":true,"query_string_cache_keys":null}],"function_association":[],"lambda_function_association":[],"max_ttl":0,"min_ttl":0,"origin_request_policy_id":null,"path_pattern":"/events/*","realtime_log_config_arn":null,"smooth_streaming":null,"target_origin_id":"covidshield-key-retrieval","trusted_key_groups":null,"trusted_signers":null,"viewer_protocol_policy":"https-only"}],"origin":[{"connection_attempts":null,"connection_timeout":null,"custom_header":[{"name":"covidshield","value":"test123"}],"custom_origin_config":[{"http_port":80,"https_port":443,"origin_keepalive_timeout":null,"origin_protocol_policy":"https-only","origin_read_timeout":null,"origin_ssl_protocols":["TLSv1.2"]}],"domain_name":"aws_lb.covidshield_key_retrieval.dns_name","origin_id":"covidshield-key-retrieval","origin_path":null,"origin_shield":[],"s3_origin_config":[]},{"connection_attempts":null,"connection_timeout":null,"custom_header":[],"custom_origin_config":[],"domain_name":"aws_s3_bucket.exposure_config.bucket_regional_domain_name","origin_id":"covid-shield-exposure-config-test","origin_path":null,"origin_shield":[],"s3_origin_config":[{"origin_access_identity":"aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path"}]}],"origin_group":[],"price_class":"PriceClass_100","restrictions":[{"geo_restriction":[{"locations":null,"restriction_type":"none"}]}],"retain_on_delete":false,"tags":null,"viewer_certificate":[{"acm_certificate_arn":"aws_acm_certificate.retrieval_covidshield.arn","cloudfront_default_certificate":null,"iam_certificate_id":null,"minimum_protocol_version":"TLSv1.2_2018","ssl_support_method":"sni-only"}],"wait_for_deployment":true,"web_acl_id":"aws_wafv2_web_acl.key_retrieval_cdn.arn"}},{"address":"aws_cloudfront_origin_access_identity.origin_access_identity","mode":"managed","type":"aws_cloudfront_origin_access_identity","name":"origin_access_identity","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"comment":"cloudfront origin access identity"}},{"address":"aws_cloudwatch_log_group.covidshield","mode":"managed","type":"aws_cloudwatch_log_group","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":"aws_kms_key.cw.arn","name":"CovidShield","name_prefix":null,"retention_in_days":90,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_cloudwatch_log_group.vpc_flow_logs","mode":"managed","type":"aws_cloudwatch_log_group","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"kms_key_id":"aws_kms_key.cw.arn","name":"vpc_flow_logs","name_prefix":null,"retention_in_days":30,"tags":null}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[0]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[0].sum"}],"name":"ClaimedOneTimeCodeTotal0","pattern":"{$.updates[0].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[1]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[1].sum"}],"name":"ClaimedOneTimeCodeTotal1","pattern":"{$.updates[1].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[2]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[2].sum"}],"name":"ClaimedOneTimeCodeTotal2","pattern":"{$.updates[2].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[3]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":3,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[3].sum"}],"name":"ClaimedOneTimeCodeTotal3","pattern":"{$.updates[3].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[4]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":4,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[4].sum"}],"name":"ClaimedOneTimeCodeTotal4","pattern":"{$.updates[4].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[5]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":5,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[5].sum"}],"name":"ClaimedOneTimeCodeTotal5","pattern":"{$.updates[5].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[6]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":6,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[6].sum"}],"name":"ClaimedOneTimeCodeTotal6","pattern":"{$.updates[6].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[7]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":7,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[7].sum"}],"name":"ClaimedOneTimeCodeTotal7","pattern":"{$.updates[7].name = \"covidshield.app.claimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[0]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[0].sum"}],"name":"DiagnosisKeyTotal0","pattern":"{$.updates[0].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[1]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[1].sum"}],"name":"DiagnosisKeyTotal1","pattern":"{$.updates[1].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[2]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[2].sum"}],"name":"DiagnosisKeyTotal2","pattern":"{$.updates[2].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[3]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":3,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[3].sum"}],"name":"DiagnosisKeyTotal3","pattern":"{$.updates[3].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[4]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":4,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[4].sum"}],"name":"DiagnosisKeyTotal4","pattern":"{$.updates[4].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[5]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":5,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[5].sum"}],"name":"DiagnosisKeyTotal5","pattern":"{$.updates[5].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[6]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":6,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[6].sum"}],"name":"DiagnosisKeyTotal6","pattern":"{$.updates[6].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[7]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":7,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[7].sum"}],"name":"DiagnosisKeyTotal7","pattern":"{$.updates[7].name = \"covidshield.app.diagnosis_keys.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[0]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[0].sum"}],"name":"UnclaimedOneTimeCodeTotal0","pattern":"{$.updates[0].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[1]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[1].sum"}],"name":"UnclaimedOneTimeCodeTotal1","pattern":"{$.updates[1].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[2]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[2].sum"}],"name":"UnclaimedOneTimeCodeTotal2","pattern":"{$.updates[2].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[3]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":3,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[3].sum"}],"name":"UnclaimedOneTimeCodeTotal3","pattern":"{$.updates[3].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[4]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":4,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[4].sum"}],"name":"UnclaimedOneTimeCodeTotal4","pattern":"{$.updates[4].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[5]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":5,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[5].sum"}],"name":"UnclaimedOneTimeCodeTotal5","pattern":"{$.updates[5].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[6]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":6,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[6].sum"}],"name":"UnclaimedOneTimeCodeTotal6","pattern":"{$.updates[6].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[7]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":7,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[7].sum"}],"name":"UnclaimedOneTimeCodeTotal7","pattern":"{$.updates[7].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"}},{"address":"aws_cloudwatch_log_metric_filter.error_logged","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"error_logged","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ErrorLogged","namespace":"CovidShield","unit":null,"value":"1"}],"name":"ErrorLogged","pattern":"level=error"}},{"address":"aws_cloudwatch_log_metric_filter.fatal_logged","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"fatal_logged","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"FatalLogged","namespace":"CovidShield","unit":null,"value":"1"}],"name":"FatalLogged","pattern":"level=fatal"}},{"address":"aws_cloudwatch_log_metric_filter.five_hundred_response","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"five_hundred_response","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"500Response","namespace":"CovidShield","unit":null,"value":"1"}],"name":"500Response","pattern":"statusClass=5xx msg=\"http response\""}},{"address":"aws_cloudwatch_log_metric_filter.key_clear_called","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"key_clear_called","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"KeyClearCalled","namespace":"CovidShield","unit":null,"value":"1"}],"name":"KeyClearCalled","pattern":"diagnosis_keys was truncated"}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_new_one_time_code_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_new_one_time_code_requests","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnauthorizedNewOneTimeCodeRequests","namespace":"CovidShield","unit":null,"value":"1"}],"name":"UnauthorizedNewOneTimeCodeRequests","pattern":"statusCode=401 msg=\"http response\" \"path=/new-key-claim\""}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_one_time_code_claim_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_one_time_code_claim_requests","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnauthorizedOneTimeCodeClaimRequests","namespace":"CovidShield","unit":null,"value":"1"}],"name":"UnauthorizedOneTimeCodeClaimRequests","pattern":"statusCode=401 msg=\"http response\" \"path=/claim-key\""}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_upload_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_upload_requests","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnauthorizedUploadRequests","namespace":"CovidShield","unit":null,"value":"1"}],"name":"UnauthorizedUploadRequests","pattern":"statusClass=4xx msg=\"http response\" \"path=/upload\""}},{"address":"aws_cloudwatch_metric_alarm.ClaimedOneTimeCodeTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ClaimedOneTimeCodeTotalCritical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for total claimed codes","alarm_name":"ClaimedOneTimeCodeTotalCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ClaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":4500,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.ClaimedOneTimeCodeTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ClaimedOneTimeCodeTotalWarn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for total claimed codes","alarm_name":"ClaimedOneTimeCodeTotalWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ClaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":3000,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.DiagnosisKeyTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"DiagnosisKeyTotalCritical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for total diagnosis keys","alarm_name":"DiagnosisKeyTotalCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DiagnosisKeyTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":13500,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.DiagnosisKeyTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"DiagnosisKeyTotalWarn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for total diagnosis keys","alarm_name":"DiagnosisKeyTotalWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DiagnosisKeyTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":9000,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.UnclaimedOneTimeCodeTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"UnclaimedOneTimeCodeTotalCritical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for total unclaimed codes","alarm_name":"UnclaimedOneTimeCodeTotalCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnclaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":400,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.UnclaimedOneTimeCodeTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"UnclaimedOneTimeCodeTotalWarn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for total unclaimed codes","alarm_name":"UnclaimedOneTimeCodeTotalWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnclaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":250,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_cdn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_cdn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"This metric monitors for DDoS detected on retrieval CDN","alarm_name":"DDoSDetectedCDN","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"aws_cloudfront_distribution.key_retrieval_distribution.arn"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_retrieval","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for DDoS detected on retrieval ALB","alarm_name":"DDoSDetectedRetrievalALB","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"aws_lb.covidshield_key_retrieval.arn"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_route53","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_route53","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"This metric monitors for DDoS detected on route 53","alarm_name":"DDoSDetectedRoute53","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"arn:aws:route53:::hostedzone/aws_route53_zone.covidshield.zone_id"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_submission","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for DDoS detected on submission ALB","alarm_name":"DDoSDetectedSubmissionALB","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"aws_lb.covidshield_key_submission.arn"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.error_logged_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"error_logged_critical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for an error level logs","alarm_name":"ErrorLoggedCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ErrorLogged","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":10,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.error_logged_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"error_logged_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for an error level logs","alarm_name":"ErrorLoggedWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ErrorLogged","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.fatal_logged_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"fatal_logged_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for a fatal level logs","alarm_name":"FatalLoggedWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"FatalLogged","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.five_hundred_response_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"five_hundred_response_critical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for an 5xx level response","alarm_name":"500ResponseCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"500Response","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":10,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.five_hundred_response_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"five_hundred_response_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for an 5xx level response","alarm_name":"500ResponseWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"500Response","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.key_clear_called_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"key_clear_called_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for a key clear calls (only be called in staging)","alarm_name":"KeyClearCalledWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"KeyClearCalled","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.retrieval_cpu_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"retrieval_cpu_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs cpu utilization","alarm_name":"retrieval-cpu-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeyRetrieval"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.retrieval_memory_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"retrieval_memory_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs memory utilization","alarm_name":"retrieval-memory-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeyRetrieval"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"MemoryUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Retrieval server is in alarm","alarm_name":"Route53RetrievalHealthCheck","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_retrieval_healthcheck.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check_ca_json","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check_ca_json","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Retrieval server is correctly serving CA.json","alarm_name":"Route53RetrievalHealthCheckCAJson","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_ca_json.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check_region_json","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check_region_json","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Retrieval server is correctly serving region.json","alarm_name":"Route53RetrievalHealthCheckRegionJson","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_region_json.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null}},{"address":"aws_cloudwatch_metric_alarm.route53_submission_health_check","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_submission_health_check","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Submission server is in alarm","alarm_name":"Route53SubmissionHealthCheck","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_submission_healthcheck.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null}},{"address":"aws_cloudwatch_metric_alarm.submission_cpu_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"submission_cpu_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs cpu utilization","alarm_name":"submission-cpu-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeySubmission"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.submission_memory_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"submission_memory_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs memory utilization","alarm_name":"submission-memory-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeySubmission"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"MemoryUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_new_one_time_code_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_new_one_time_code_requests_critical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors the 401 response rate for /new-key-claim","alarm_name":"UnauthorizedNewOneTimeCodeRequestsCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedNewOneTimeCodeRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":100,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_new_one_time_code_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_new_one_time_code_requests_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors the 401 response rate for /new-key-claim","alarm_name":"UnauthorizedNewOneTimeCodeRequestsWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedNewOneTimeCodeRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_one_time_code_claim_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_one_time_code_claim_requests_critical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors the 401 response rate for /claim-key","alarm_name":"UnauthorizedOneTimeCodeClaimRequestsCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedOneTimeCodeClaimRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":100,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_one_time_code_claim_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_one_time_code_claim_requests_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors the 401 response rate for /claim-key","alarm_name":"UnauthorizedOneTimeCodeClaimRequestsWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedOneTimeCodeClaimRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_upload_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_upload_requests_critical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors the 4xx response rate for /upload","alarm_name":"UnauthorizedUploadRequestsCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedUploadRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":100,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_upload_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_upload_requests_warn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors the 4xx response rate for /upload","alarm_name":"UnauthorizedUploadRequestsWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedUploadRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null}},{"address":"aws_db_subnet_group.covidshield","mode":"managed","type":"aws_db_subnet_group","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Managed by Terraform","name":"server","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":{"CostCentre":"CovidShield","Name":"server"},"tags_all":{"CostCentre":"CovidShield","Name":"server"}}},{"address":"aws_default_network_acl.covidshield","mode":"managed","type":"aws_default_network_acl","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"default_network_acl_id":"aws_vpc.covidshield.default_network_acl_id","egress":[{"action":"allow","cidr_block":"0.0.0.0/0","from_port":0,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"-1","rule_no":100,"to_port":0}],"ingress":[{"action":"allow","cidr_block":"0.0.0.0/0","from_port":0,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"-1","rule_no":300,"to_port":0},{"action":"deny","cidr_block":"0.0.0.0/0","from_port":22,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"tcp","rule_no":100,"to_port":22},{"action":"deny","cidr_block":"0.0.0.0/0","from_port":3389,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"tcp","rule_no":200,"to_port":3389}],"subnet_ids":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_ecr_lifecycle_policy.policy[\"key-retrieval\"]","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","index":"key-retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n","repository":"covid-server/key-retrieval"}},{"address":"aws_ecr_lifecycle_policy.policy[\"key-submission\"]","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","index":"key-submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n","repository":"covid-server/key-submission"}},{"address":"aws_ecr_lifecycle_policy.policy[\"monolith\"]","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","index":"monolith","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n","repository":"covid-server/monolith"}},{"address":"aws_ecr_repository.repository[\"key-retrieval\"]","mode":"managed","type":"aws_ecr_repository","name":"repository","index":"key-retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"encryption_configuration":[],"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"covid-server/key-retrieval","tags":null,"timeouts":null}},{"address":"aws_ecr_repository.repository[\"key-submission\"]","mode":"managed","type":"aws_ecr_repository","name":"repository","index":"key-submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"encryption_configuration":[],"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"covid-server/key-submission","tags":null,"timeouts":null}},{"address":"aws_ecr_repository.repository[\"monolith\"]","mode":"managed","type":"aws_ecr_repository","name":"repository","index":"monolith","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"encryption_configuration":[],"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"covid-server/monolith","tags":null,"timeouts":null}},{"address":"aws_ecs_cluster.covidshield","mode":"managed","type":"aws_ecs_cluster","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_providers":null,"configuration":[],"default_capacity_provider_strategy":[],"name":"CovidShield","setting":[{"name":"containerInsights","value":"enabled"}],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_ecs_service.covidshield_key_retrieval","mode":"managed","type":"aws_ecs_service","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_provider_strategy":[],"cluster":"aws_ecs_cluster.covidshield.id","deployment_circuit_breaker":[],"deployment_controller":[{"type":"CODE_DEPLOY"}],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":50,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":60,"launch_type":"FARGATE","load_balancer":[{"container_name":"key-retrieval","container_port":8001,"elb_name":null,"target_group_arn":"aws_lb_target_group.covidshield_key_retrieval.arn"}],"name":"KeyRetrieval","network_configuration":[{"assign_public_ip":false,"security_groups":["aws_security_group.covidshield_key_retrieval.id"],"subnets":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"]}],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":"1.4.0","propagate_tags":"SERVICE","scheduling_strategy":"REPLICA","service_registries":[],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_definition":"aws_ecs_task_definition.covidshield_key_retrieval.arn","timeouts":null,"wait_for_steady_state":false}},{"address":"aws_ecs_service.covidshield_key_submission","mode":"managed","type":"aws_ecs_service","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"capacity_provider_strategy":[],"cluster":"aws_ecs_cluster.covidshield.id","deployment_circuit_breaker":[],"deployment_controller":[{"type":"CODE_DEPLOY"}],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":50,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":60,"launch_type":"FARGATE","load_balancer":[{"container_name":"key-submission","container_port":8000,"elb_name":null,"target_group_arn":"aws_lb_target_group.covidshield_key_submission.arn"}],"name":"KeySubmission","network_configuration":[{"assign_public_ip":false,"security_groups":["aws_security_group.covidshield_key_submission.id"],"subnets":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"]}],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":"1.4.0","propagate_tags":"SERVICE","scheduling_strategy":"REPLICA","service_registries":[],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_definition":"aws_ecs_task_definition.covidshield_key_submission.arn","timeouts":null,"wait_for_steady_state":false}},{"address":"aws_ecs_task_definition.covidshield_key_retrieval","mode":"managed","type":"aws_ecs_task_definition","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"container_definitions":"data.template_file.covidshield_key_retrieval_task.rendered","cpu":"512","ephemeral_storage":[],"execution_role_arn":"aws_iam_role.covidshield_key_retrieval.arn","family":"KeyRetrieval","inference_accelerator":[],"ipc_mode":null,"memory":"1024","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_role_arn":"aws_iam_role.covidshield_key_retrieval.arn","volume":[]}},{"address":"aws_ecs_task_definition.covidshield_key_submission","mode":"managed","type":"aws_ecs_task_definition","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"container_definitions":"data.template_file.covidshield_key_submission_task.rendered","cpu":"512","ephemeral_storage":[],"execution_role_arn":"aws_iam_role.covidshield_key_submission.arn","family":"KeySubmission","inference_accelerator":[],"ipc_mode":null,"memory":"1024","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_role_arn":"aws_iam_role.covidshield_key_submission.arn","volume":[]}},{"address":"aws_elasticache_replication_group.covidshield[0]","mode":"managed","type":"aws_elasticache_replication_group","name":"covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"apply_immediately":true,"at_rest_encryption_enabled":true,"auth_token":null,"auto_minor_version_upgrade":true,"automatic_failover_enabled":true,"availability_zones":["ca-central-1a","ca-central-1b","ca-central-1d"],"cluster_mode":[],"engine":"redis","final_snapshot_identifier":null,"kms_key_id":null,"multi_az_enabled":false,"node_type":"cache.t3.small","notification_topic_arn":null,"number_cache_clusters":3,"parameter_group_name":"default.redis5.0","port":6379,"replication_group_description":"covidshield","replication_group_id":"covidshield","security_group_ids":["aws_security_group.covidshield_redis[0].id"],"snapshot_arns":null,"snapshot_name":null,"snapshot_retention_limit":null,"subnet_group_name":"covidshield","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"transit_encryption_enabled":true}},{"address":"aws_elasticache_subnet_group.covidshield[0]","mode":"managed","type":"aws_elasticache_subnet_group","name":"covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":"Managed by Terraform","name":"covidshield","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null}},{"address":"aws_flow_log.vpc_flow_logs","mode":"managed","type":"aws_flow_log","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"eni_id":null,"iam_role_arn":"aws_iam_role.vpc_flow_logs.arn","log_destination":"aws_cloudwatch_log_group.vpc_flow_logs.arn","log_destination_type":"cloud-watch-logs","max_aggregation_interval":600,"subnet_id":null,"tags":null,"traffic_type":"ALL","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_iam_policy.covidshield_secrets_manager_key_retrieval","mode":"managed","type":"aws_iam_policy","name":"covidshield_secrets_manager_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"CovidShieldSecretsManagerKeyRetrieval","name_prefix":null,"path":"/","policy":"data.aws_iam_policy_document.covidshield_secrets_manager_key_retrieval.json","tags":null}},{"address":"aws_iam_policy.covidshield_secrets_manager_key_submission","mode":"managed","type":"aws_iam_policy","name":"covidshield_secrets_manager_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"name":"CovidShieldSecretsManagerKeySubmission","name_prefix":null,"path":"/","policy":"data.aws_iam_policy_document.covidshield_secrets_manager_key_submission.json","tags":null}},{"address":"aws_iam_role.codedeploy","mode":"managed","type":"aws_iam_role","name":"codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"codedeploy.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"codedeploy","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null}},{"address":"aws_iam_role.covidshield_key_retrieval","mode":"managed","type":"aws_iam_role","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"KeyRetrieval","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_iam_role.covidshield_key_submission","mode":"managed","type":"aws_iam_role","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"KeySubmission","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_iam_role.firehose_waf_logs","mode":"managed","type":"aws_iam_role","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"firehose.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"firehose_waf_logs","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null}},{"address":"aws_iam_role.lambda_validate_deploy","mode":"managed","type":"aws_iam_role","name":"lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"lambda-validate-deploy","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null}},{"address":"aws_iam_role.vpc_flow_logs","mode":"managed","type":"aws_iam_role","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"vpc-flow-logs.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"vpc_flow_logs","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null}},{"address":"aws_iam_role_policy.firehose_waf_logs","mode":"managed","type":"aws_iam_role_policy","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"firehose-waf-logs-policy","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:AbortMultipartUpload\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetObject\",\n        \"s3:ListBucket\",\n        \"s3:ListBucketMultipartUploads\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"aws_s3_bucket.firehose_waf_logs.arn\",\n        \"aws_s3_bucket.firehose_waf_logs.arn/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/wafv2.amazonaws.com/AWSServiceRoleForWAFV2Logging\"\n    }\n  ]\n}\n","role":"aws_iam_role.firehose_waf_logs.id"}},{"address":"aws_iam_role_policy.lambda_validate_codedeploy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_validate_codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"LambdaValidateCodeDeploy","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codedeploy:PutLifecycleEventHookExecutionStatus\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","role":"aws_iam_role.lambda_validate_deploy.id"}},{"address":"aws_iam_role_policy.vpc_flow_logs","mode":"managed","type":"aws_iam_role_policy","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"vpc_flow_logs","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","role":"aws_iam_role.vpc_flow_logs.id"}},{"address":"aws_iam_role_policy_attachment.codedeploy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS","role":"codedeploy"}},{"address":"aws_iam_role_policy_attachment.ecs_task_execution_key_retrieval","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_task_execution_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy","role":"KeyRetrieval"}},{"address":"aws_iam_role_policy_attachment.ecs_task_execution_key_submission","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_task_execution_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy","role":"KeySubmission"}},{"address":"aws_iam_role_policy_attachment.lambda_validate_deploy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","role":"lambda-validate-deploy"}},{"address":"aws_iam_role_policy_attachment.secrets_manager_key_retrieval","mode":"managed","type":"aws_iam_role_policy_attachment","name":"secrets_manager_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"aws_iam_policy.covidshield_secrets_manager_key_retrieval.arn","role":"KeyRetrieval"}},{"address":"aws_iam_role_policy_attachment.secrets_manager_key_submission","mode":"managed","type":"aws_iam_role_policy_attachment","name":"secrets_manager_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"policy_arn":"aws_iam_policy.covidshield_secrets_manager_key_submission.arn","role":"KeySubmission"}},{"address":"aws_internet_gateway.covidshield","mode":"managed","type":"aws_internet_gateway","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"tags":{"CostCentre":"CovidShield","Name":"CovidShield"},"tags_all":{"CostCentre":"CovidShield","Name":"CovidShield"},"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_kinesis_firehose_delivery_stream.firehose_waf_logs","mode":"managed","type":"aws_kinesis_firehose_delivery_stream","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"destination":"s3","elasticsearch_configuration":[],"extended_s3_configuration":[],"http_endpoint_configuration":[],"kinesis_source_configuration":[],"name":"aws-waf-logs-covid-shield","redshift_configuration":[],"s3_configuration":[{"bucket_arn":"aws_s3_bucket.firehose_waf_logs.arn","buffer_interval":null,"buffer_size":null,"cloudwatch_logging_options":[],"compression_format":null,"kms_key_arn":null,"prefix":null,"role_arn":"aws_iam_role.firehose_waf_logs.arn"}],"server_side_encryption":[{"enabled":true,"key_arn":null,"key_type":null}],"splunk_configuration":[],"tags":null}},{"address":"aws_kinesis_firehose_delivery_stream.firehose_waf_logs_us_east","mode":"managed","type":"aws_kinesis_firehose_delivery_stream","name":"firehose_waf_logs_us_east","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"destination":"s3","elasticsearch_configuration":[],"extended_s3_configuration":[],"http_endpoint_configuration":[],"kinesis_source_configuration":[],"name":"aws-waf-logs-covid-shield-us-east","redshift_configuration":[],"s3_configuration":[{"bucket_arn":"aws_s3_bucket.firehose_waf_logs.arn","buffer_interval":null,"buffer_size":null,"cloudwatch_logging_options":[],"compression_format":null,"kms_key_arn":null,"prefix":null,"role_arn":"aws_iam_role.firehose_waf_logs.arn"}],"server_side_encryption":[{"enabled":true,"key_arn":null,"key_type":null}],"splunk_configuration":[],"tags":null}},{"address":"aws_kms_key.cw","mode":"managed","type":"aws_kms_key","name":"cw","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":null,"description":"CloudWatch Log Group Key","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n  \"Version\" : \"2012-10-17\",\n  \"Id\" : \"key-default-1\",\n  \"Statement\" : [ {\n      \"Sid\" : \"Enable IAM User Permissions\",\n      \"Effect\" : \"Allow\",\n      \"Principal\" : {\n        \"AWS\" : \"arn:aws:iam::115553109071:root\"\n      },\n      \"Action\" : \"kms:*\",\n      \"Resource\" : \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": { \"Service\": \"logs.ca-central-1.amazonaws.com\" },\n      \"Action\": [ \n        \"kms:Encrypt*\",\n        \"kms:Decrypt*\",\n        \"kms:ReEncrypt*\",\n        \"kms:GenerateDataKey*\",\n        \"kms:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Allow_CloudWatch_for_CMK\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n          \"Service\":[\n              \"cloudwatch.amazonaws.com\"\n          ]\n      },\n      \"Action\": [\n          \"kms:Decrypt\",\"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","tags":null}},{"address":"aws_kms_key.cw_us_east","mode":"managed","type":"aws_kms_key","name":"cw_us_east","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":null,"description":"CloudWatch Log Group Key","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n  \"Version\" : \"2012-10-17\",\n  \"Id\" : \"key-default-1\",\n  \"Statement\" : [ {\n      \"Sid\" : \"Enable IAM User Permissions\",\n      \"Effect\" : \"Allow\",\n      \"Principal\" : {\n        \"AWS\" : \"arn:aws:iam::115553109071:root\"\n      },\n      \"Action\" : \"kms:*\",\n      \"Resource\" : \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": { \"Service\": \"logs.us-east-1.amazonaws.com\" },\n      \"Action\": [ \n        \"kms:Encrypt*\",\n        \"kms:Decrypt*\",\n        \"kms:ReEncrypt*\",\n        \"kms:GenerateDataKey*\",\n        \"kms:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Allow_CloudWatch_for_CMK\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n          \"Service\":[\n              \"cloudwatch.amazonaws.com\"\n          ]\n      },\n      \"Action\": [\n          \"kms:Decrypt\",\"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","tags":null}},{"address":"aws_lambda_function.retrieval_lambda_validate_deploy","mode":"managed","type":"aws_lambda_function","name":"retrieval_lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"CLOUDFRONT_CUSTOM_HEADER":"test123","TEST_LB_ENDPOINT":"https://aws_lb.covidshield_key_retrieval.dns_name:8443/services/ping"}}],"file_system_config":[],"filename":"/tmp/lambda_validate_deploy.rb.zip","function_name":"RetrievalValidateBeforeTraffic","handler":"lambda_validate_deploy.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"reserved_concurrent_executions":-1,"role":"aws_iam_role.lambda_validate_deploy.arn","runtime":"ruby2.7","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"jarV4/mad4XdTehS86tGTX/xBKNvpkUHSWcfWLkX06w=","tags":null,"timeout":3,"timeouts":null,"tracing_config":[],"vpc_config":[]}},{"address":"aws_lambda_function.submission_lambda_validate_deploy","mode":"managed","type":"aws_lambda_function","name":"submission_lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"TEST_LB_ENDPOINT":"https://aws_lb.covidshield_key_submission.dns_name:8443/services/ping"}}],"file_system_config":[],"filename":"/tmp/lambda_validate_deploy.rb.zip","function_name":"SubmissionValidateBeforeTraffic","handler":"lambda_validate_deploy.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"reserved_concurrent_executions":-1,"role":"aws_iam_role.lambda_validate_deploy.arn","runtime":"ruby2.7","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"jarV4/mad4XdTehS86tGTX/xBKNvpkUHSWcfWLkX06w=","tags":null,"timeout":3,"timeouts":null,"tracing_config":[],"vpc_config":[]}},{"address":"aws_lb.covidshield_key_retrieval","mode":"managed","type":"aws_lb","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"access_logs":[],"customer_owned_ipv4_pool":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"idle_timeout":60,"internal":false,"load_balancer_type":"application","name":"covidshield-key-retrieval","name_prefix":null,"security_groups":["aws_security_group.covidshield_load_balancer.id"],"subnet_mapping":[],"subnets":["aws_subnet.covidshield_public[0].id","aws_subnet.covidshield_public[1].id","aws_subnet.covidshield_public[2].id"],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"timeouts":null}},{"address":"aws_lb.covidshield_key_submission","mode":"managed","type":"aws_lb","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"access_logs":[],"customer_owned_ipv4_pool":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"idle_timeout":60,"internal":false,"load_balancer_type":"application","name":"covidshield-key-submission","name_prefix":null,"security_groups":["aws_security_group.covidshield_load_balancer.id"],"subnet_mapping":[],"subnets":["aws_subnet.covidshield_public[0].id","aws_subnet.covidshield_public[1].id","aws_subnet.covidshield_public[2].id"],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"timeouts":null}},{"address":"aws_lb_listener.covidshield_key_retrieval","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_retrieval.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_retrieval.arn","port":443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null}},{"address":"aws_lb_listener.covidshield_key_retrieval_test","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_retrieval_test","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_retrieval.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_retrieval.arn","port":8443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null}},{"address":"aws_lb_listener.covidshield_key_submission","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_submission.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_submission.arn","port":443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null}},{"address":"aws_lb_listener.covidshield_key_submission_test","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_submission_test","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_submission.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_submission.arn","port":8443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null}},{"address":"aws_lb_target_group.covidshield_key_retrieval","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-retrieval","name_prefix":null,"port":8001,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_lb_target_group.covidshield_key_retrieval_2","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_retrieval_2","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-retrieval-2","name_prefix":null,"port":8001,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval-2"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval-2"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_lb_target_group.covidshield_key_submission","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-submission","name_prefix":null,"port":8000,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_lb_target_group.covidshield_key_submission_2","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_submission_2","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-submission-2","name_prefix":null,"port":8000,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-submission-2"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-submission-2"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_rds_cluster.covidshield_server","mode":"managed","type":"aws_rds_cluster","name":"covidshield_server","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"allow_major_version_upgrade":null,"backtrack_window":null,"backup_retention_period":1,"cluster_identifier":"server-cluster","copy_tags_to_snapshot":false,"database_name":"server","db_subnet_group_name":"server","deletion_protection":null,"enable_http_endpoint":false,"enabled_cloudwatch_logs_exports":null,"engine":"aurora","engine_mode":"provisioned","final_snapshot_identifier":"server-random_string.random.result","global_cluster_identifier":null,"iam_database_authentication_enabled":null,"master_password":"test","master_username":"root","preferred_backup_window":"07:00-09:00","replication_source_identifier":null,"restore_to_point_in_time":[],"s3_import":[],"scaling_configuration":[],"skip_final_snapshot":false,"snapshot_identifier":null,"source_region":null,"storage_encrypted":true,"tags":{"CostCentre":"CovidShield","Name":"server-cluster"},"tags_all":{"CostCentre":"CovidShield","Name":"server-cluster"},"timeouts":null,"vpc_security_group_ids":["aws_security_group.covidshield_database.id"]}},{"address":"aws_rds_cluster_instance.covidshield_server_instances[0]","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_minor_version_upgrade":true,"cluster_identifier":"aws_rds_cluster.covidshield_server.id","copy_tags_to_snapshot":false,"db_subnet_group_name":"server","engine":"aurora","identifier":"server-instance-0","instance_class":"db.t3.small","monitoring_interval":0,"performance_insights_enabled":true,"promotion_tier":0,"publicly_accessible":false,"tags":{"CostCentre":"CovidShield","Name":"server-instance"},"tags_all":{"CostCentre":"CovidShield","Name":"server-instance"},"timeouts":null}},{"address":"aws_rds_cluster_instance.covidshield_server_instances[1]","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_minor_version_upgrade":true,"cluster_identifier":"aws_rds_cluster.covidshield_server.id","copy_tags_to_snapshot":false,"db_subnet_group_name":"server","engine":"aurora","identifier":"server-instance-1","instance_class":"db.t3.small","monitoring_interval":0,"performance_insights_enabled":true,"promotion_tier":0,"publicly_accessible":false,"tags":{"CostCentre":"CovidShield","Name":"server-instance"},"tags_all":{"CostCentre":"CovidShield","Name":"server-instance"},"timeouts":null}},{"address":"aws_rds_cluster_instance.covidshield_server_instances[2]","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_minor_version_upgrade":true,"cluster_identifier":"aws_rds_cluster.covidshield_server.id","copy_tags_to_snapshot":false,"db_subnet_group_name":"server","engine":"aurora","identifier":"server-instance-2","instance_class":"db.t3.small","monitoring_interval":0,"performance_insights_enabled":true,"promotion_tier":0,"publicly_accessible":false,"tags":{"CostCentre":"CovidShield","Name":"server-instance"},"tags_all":{"CostCentre":"CovidShield","Name":"server-instance"},"timeouts":null}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"retrieval.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":null,"request_interval":30,"resource_path":"/services/ping","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_ca_json","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck_ca_json","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"retrieval.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":["us-east-1","us-west-1","us-west-2"],"request_interval":30,"resource_path":"/exposure-configuration/CA.json","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_region_json","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck_region_json","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"retrieval.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":["us-east-1","us-west-1","us-west-2"],"request_interval":30,"resource_path":"/exposure-configuration/region.json","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"}},{"address":"aws_route53_health_check.covidshield_key_submission_healthcheck","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_submission_healthcheck","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"submission.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":null,"request_interval":30,"resource_path":"/services/ping","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"}},{"address":"aws_route53_record.covidshield_certificate_validation[\"*.test.com\"]","mode":"managed","type":"aws_route53_record","name":"covidshield_certificate_validation","index":"*.test.com","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"records":[],"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"}},{"address":"aws_route53_record.covidshield_certificate_validation[\"test.com\"]","mode":"managed","type":"aws_route53_record","name":"covidshield_certificate_validation","index":"test.com","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"records":[],"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"}},{"address":"aws_route53_record.covidshield_key_retrieval","mode":"managed","type":"aws_route53_record","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[{"evaluate_target_health":false,"name":"aws_cloudfront_distribution.key_retrieval_distribution.domain_name","zone_id":"aws_cloudfront_distribution.key_retrieval_distribution.hosted_zone_id"}],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"name":"retrieval.test.com","records":null,"set_identifier":null,"ttl":null,"type":"A","weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"}},{"address":"aws_route53_record.covidshield_key_submission","mode":"managed","type":"aws_route53_record","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[{"evaluate_target_health":false,"name":"aws_lb.covidshield_key_submission.dns_name","zone_id":"aws_lb.covidshield_key_submission.zone_id"}],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"name":"submission.test.com","records":null,"set_identifier":null,"ttl":null,"type":"A","weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"}},{"address":"aws_route53_record.retrieval_covidshield_certificate_validation[\"retrieval.test.com\"]","mode":"managed","type":"aws_route53_record","name":"retrieval_covidshield_certificate_validation","index":"retrieval.test.com","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"alias":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"records":[],"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"}},{"address":"aws_route53_zone.covidshield","mode":"managed","type":"aws_route53_zone","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"comment":"Managed by Terraform","delegation_set_id":null,"force_destroy":false,"name":"test.com","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"vpc":[]}},{"address":"aws_route_table.covidshield_public_subnet","mode":"managed","type":"aws_route_table","name":"covidshield_public_subnet","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"route":[{"carrier_gateway_id":null,"cidr_block":"0.0.0.0/0","destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":"aws_internet_gateway.covidshield.id","instance_id":null,"ipv6_cidr_block":null,"local_gateway_id":null,"nat_gateway_id":null,"network_interface_id":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null}],"tags":{"CostCentre":"CovidShield","Name":"Public Subnet Route Table"},"tags_all":{"CostCentre":"CovidShield","Name":"Public Subnet Route Table"},"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_route_table_association.covidshield[0]","mode":"managed","type":"aws_route_table_association","name":"covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"route_table_id":"aws_route_table.covidshield_public_subnet.id","subnet_id":"aws_subnet.covidshield_public[0].id"}},{"address":"aws_route_table_association.covidshield[1]","mode":"managed","type":"aws_route_table_association","name":"covidshield","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"route_table_id":"aws_route_table.covidshield_public_subnet.id","subnet_id":"aws_subnet.covidshield_public[1].id"}},{"address":"aws_route_table_association.covidshield[2]","mode":"managed","type":"aws_route_table_association","name":"covidshield","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"gateway_id":null,"route_table_id":"aws_route_table.covidshield_public_subnet.id","subnet_id":"aws_subnet.covidshield_public[2].id"}},{"address":"aws_s3_bucket.cloudfront_logs","mode":"managed","type":"aws_s3_bucket","name":"cloudfront_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","bucket":"covid-shield-test-cloudfront-logs","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[{"abort_incomplete_multipart_upload_days":null,"enabled":true,"expiration":[{"date":null,"days":90,"expired_object_delete_marker":null}],"id":null,"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"tags":null,"transition":[]}],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]}},{"address":"aws_s3_bucket.exposure_config","mode":"managed","type":"aws_s3_bucket","name":"exposure_config","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","bucket":"covid-shield-exposure-config-test","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[],"logging":[{"target_bucket":"covid-shield-exposure-config-test-logs","target_prefix":null}],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]}},{"address":"aws_s3_bucket.exposure_config_logs","mode":"managed","type":"aws_s3_bucket","name":"exposure_config_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"log-delivery-write","bucket":"covid-shield-exposure-config-test-logs","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[{"abort_incomplete_multipart_upload_days":null,"enabled":true,"expiration":[{"date":null,"days":90,"expired_object_delete_marker":null}],"id":null,"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"tags":null,"transition":[]}],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]}},{"address":"aws_s3_bucket.firehose_waf_logs","mode":"managed","type":"aws_s3_bucket","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"acl":"private","bucket":"covid-shield-test-waf-logs","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[{"abort_incomplete_multipart_upload_days":null,"enabled":true,"expiration":[{"date":null,"days":90,"expired_object_delete_marker":null}],"id":null,"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"tags":null,"transition":[]}],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]}},{"address":"aws_s3_bucket_policy.exposure_config","mode":"managed","type":"aws_s3_bucket_policy","name":"exposure_config","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"bucket":"aws_s3_bucket.exposure_config.id","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"OnlyCloudfrontReadAccess\",\n      \"Principal\": {\n        \"AWS\": \"aws_cloudfront_origin_access_identity.origin_access_identity.iam_arn\"\n      },\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"aws_s3_bucket.exposure_config.arn/*\"\n    }\n  ]\n}\n"}},{"address":"aws_s3_bucket_public_access_block.cloudfront_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"cloudfront_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"bucket":"aws_s3_bucket.cloudfront_logs.id","ignore_public_acls":true,"restrict_public_buckets":true}},{"address":"aws_s3_bucket_public_access_block.exposure_config_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"exposure_config_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"bucket":"aws_s3_bucket.exposure_config_logs.id","ignore_public_acls":true,"restrict_public_buckets":true}},{"address":"aws_s3_bucket_public_access_block.firehose_waf_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_public_acls":true,"block_public_policy":true,"bucket":"aws_s3_bucket.firehose_waf_logs.id","ignore_public_acls":true,"restrict_public_buckets":true}},{"address":"aws_secretsmanager_secret.key_retrieval_env_ecdsa_key","mode":"managed","type":"aws_secretsmanager_secret","name":"key_retrieval_env_ecdsa_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"kms_key_id":null,"name":"key-retrieval-env-ecdsa-key-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null}},{"address":"aws_secretsmanager_secret.key_retrieval_env_hmac_key","mode":"managed","type":"aws_secretsmanager_secret","name":"key_retrieval_env_hmac_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"kms_key_id":null,"name":"key-retrieval-env-hmac-key-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null}},{"address":"aws_secretsmanager_secret.key_submission_env_key_claim_token","mode":"managed","type":"aws_secretsmanager_secret","name":"key_submission_env_key_claim_token","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"kms_key_id":null,"name":"key-submission-env-key-claim-token-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null}},{"address":"aws_secretsmanager_secret.key_submission_metrics_password","mode":"managed","type":"aws_secretsmanager_secret","name":"key_submission_metrics_password","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"kms_key_id":null,"name":"key-metric-password-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null}},{"address":"aws_secretsmanager_secret.server_database_url","mode":"managed","type":"aws_secretsmanager_secret","name":"server_database_url","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"description":null,"kms_key_id":null,"name":"server-database-url-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null}},{"address":"aws_secretsmanager_secret_version.key_retrieval_env_ecdsa_key","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_retrieval_env_ecdsa_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_retrieval_env_ecdsa_key.id","secret_string":"test123"}},{"address":"aws_secretsmanager_secret_version.key_retrieval_env_hmac_key","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_retrieval_env_hmac_key","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_retrieval_env_hmac_key.id","secret_string":"test123"}},{"address":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_submission_env_key_claim_token","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_submission_env_key_claim_token.id","secret_string":"test123"}},{"address":"aws_secretsmanager_secret_version.key_submission_metrics_password","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_submission_metrics_password","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_submission_metrics_password.id","secret_string":"test"}},{"address":"aws_secretsmanager_secret_version.server_database_url","mode":"managed","type":"aws_secretsmanager_secret_version","name":"server_database_url","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.server_database_url.id","secret_string":"root:test@tcp(aws_rds_cluster.covidshield_server.endpoint)/server"}},{"address":"aws_security_group.covidshield_database","mode":"managed","type":"aws_security_group","name":"covidshield_database","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Ingress - CovidShield Database","ingress":[{"cidr_blocks":null,"description":null,"from_port":3306,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":["aws_security_group.covidshield_key_retrieval.id","aws_security_group.covidshield_key_submission.id"],"self":null,"to_port":3306}],"name":"covidshield-database","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_security_group.covidshield_key_retrieval","mode":"managed","type":"aws_security_group","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Ingress - CovidShield Key Retrieval App","name":"covidshield-key-retrieval","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_security_group.covidshield_key_submission","mode":"managed","type":"aws_security_group","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Ingress - CovidShield Key Submission App","name":"covidshield-key-submission","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_security_group.covidshield_load_balancer","mode":"managed","type":"aws_security_group","name":"covidshield_load_balancer","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Ingress - CovidShield Load Balancer","egress":[{"cidr_blocks":["10.0.0.0/24"],"description":"retrieval target ca-central-1a","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.0.0/24"],"description":"submission target ca-central-1a","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.1.0/24"],"description":"retrieval target ca-central-1b","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.1.0/24"],"description":"submission target ca-central-1b","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.2.0/24"],"description":"retrieval target ca-central-1d","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.2.0/24"],"description":"submission target ca-central-1d","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443},{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":8443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8443}],"name":"covidshield-load-balancer","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_security_group.covidshield_redis[0]","mode":"managed","type":"aws_security_group","name":"covidshield_redis","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"Ingress - CovidShield Redis","ingress":[{"cidr_blocks":null,"description":null,"from_port":6379,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":["aws_security_group.covidshield_key_retrieval.id","aws_security_group.covidshield_key_submission.id"],"self":null,"to_port":6379}],"name":"covidshield-redis","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_security_group.privatelink","mode":"managed","type":"aws_security_group","name":"privatelink","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"description":"privatelink endpoints","name":"privatelink","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_database","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_database","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Retrieval DB egress through privatelink","from_port":3306,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.covidshield_database.id","to_port":3306,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Retrieval egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.privatelink.id","to_port":443,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_redis[0]","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_redis","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Retrieval Redis egress through privatelink","from_port":6379,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.covidshield_redis[0].id","to_port":6379,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_s3_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_s3_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Retrieval S3 egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":["aws_vpc_endpoint.s3.prefix_list_id"],"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"to_port":443,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_retrieval_ingress_alb","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_ingress_alb","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Retrieval Ingress ALB","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.covidshield_load_balancer.id","to_port":8001,"type":"ingress"}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_database","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_database","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Submission DB egress through privatelink","from_port":3306,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.covidshield_database.id","to_port":3306,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Submission egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.privatelink.id","to_port":443,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_redis[0]","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_redis","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Submission Redis egress through privatelink","from_port":6379,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.covidshield_redis[0].id","to_port":6379,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_s3_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_s3_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Submission S3 egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":["aws_vpc_endpoint.s3.prefix_list_id"],"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"to_port":443,"type":"egress"}},{"address":"aws_security_group_rule.covidshield_key_submission_ingress_alb","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_ingress_alb","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Submission ingress","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.covidshield_load_balancer.id","to_port":8000,"type":"ingress"}},{"address":"aws_security_group_rule.privatelink_retrieval_ingress","mode":"managed","type":"aws_security_group_rule","name":"privatelink_retrieval_ingress","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Retrieval ingress","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.privatelink.id","self":false,"source_security_group_id":"aws_security_group.covidshield_key_retrieval.id","to_port":443,"type":"ingress"}},{"address":"aws_security_group_rule.privatelink_submission_ingress","mode":"managed","type":"aws_security_group_rule","name":"privatelink_submission_ingress","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":2,"values":{"cidr_blocks":null,"description":"Security group rule for Submission ingressk","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.privatelink.id","self":false,"source_security_group_id":"aws_security_group.covidshield_key_submission.id","to_port":443,"type":"ingress"}},{"address":"aws_shield_protection.alb_covidshield_key_retrieval[0]","mode":"managed","type":"aws_shield_protection","name":"alb_covidshield_key_retrieval","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"alb_covidshield_key_retrieval","resource_arn":"aws_lb.covidshield_key_retrieval.arn","tags":null}},{"address":"aws_shield_protection.alb_covidshield_key_submission[0]","mode":"managed","type":"aws_shield_protection","name":"alb_covidshield_key_submission","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"alb_covidshield_key_submission","resource_arn":"aws_lb.covidshield_key_submission.arn","tags":null}},{"address":"aws_shield_protection.key_retrieval_distribution[0]","mode":"managed","type":"aws_shield_protection","name":"key_retrieval_distribution","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"key_retrieval_distribution","resource_arn":"aws_cloudfront_distribution.key_retrieval_distribution.arn","tags":null}},{"address":"aws_shield_protection.route53_covidshield[0]","mode":"managed","type":"aws_shield_protection","name":"route53_covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"name":"route53_covidshield","resource_arn":"arn:aws:route53:::hostedzone/aws_route53_zone.covidshield.zone_id","tags":null}},{"address":"aws_sns_topic.alert_critical","mode":"managed","type":"aws_sns_topic","name":"alert_critical","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-critical","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_sns_topic.alert_critical_us_east","mode":"managed","type":"aws_sns_topic","name":"alert_critical_us_east","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw_us_east.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-critical","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_sns_topic.alert_warning","mode":"managed","type":"aws_sns_topic","name":"alert_warning","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-warning","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_sns_topic.alert_warning_us_east","mode":"managed","type":"aws_sns_topic","name":"alert_warning_us_east","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw_us_east.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-warning","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}}},{"address":"aws_subnet.covidshield_private[0]","mode":"managed","type":"aws_subnet","name":"covidshield_private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1a","cidr_block":"10.0.0.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 01"},"tags_all":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 01"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_subnet.covidshield_private[1]","mode":"managed","type":"aws_subnet","name":"covidshield_private","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1b","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 02"},"tags_all":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 02"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_subnet.covidshield_private[2]","mode":"managed","type":"aws_subnet","name":"covidshield_private","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1d","cidr_block":"10.0.2.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 03"},"tags_all":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 03"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_subnet.covidshield_public[0]","mode":"managed","type":"aws_subnet","name":"covidshield_public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1a","cidr_block":"10.0.3.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 01"},"tags_all":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 01"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_subnet.covidshield_public[1]","mode":"managed","type":"aws_subnet","name":"covidshield_public","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1b","cidr_block":"10.0.4.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 02"},"tags_all":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 02"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_subnet.covidshield_public[2]","mode":"managed","type":"aws_subnet","name":"covidshield_public","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1d","cidr_block":"10.0.5.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 03"},"tags_all":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 03"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc.covidshield","mode":"managed","type":"aws_vpc","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"assign_generated_ipv6_cidr_block":false,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","tags":{"CostCentre":"CovidShield","Name":"CovidShield"},"tags_all":{"CostCentre":"CovidShield","Name":"CovidShield"}}},{"address":"aws_vpc_endpoint.ecr-api","mode":"managed","type":"aws_vpc_endpoint","name":"ecr-api","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.ecr.api","tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc_endpoint.ecr-dkr","mode":"managed","type":"aws_vpc_endpoint","name":"ecr-dkr","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.ecr.dkr","tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc_endpoint.kms","mode":"managed","type":"aws_vpc_endpoint","name":"kms","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.kms","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc_endpoint.logs","mode":"managed","type":"aws_vpc_endpoint","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.logs","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc_endpoint.monitoring","mode":"managed","type":"aws_vpc_endpoint","name":"monitoring","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.monitoring","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc_endpoint.s3","mode":"managed","type":"aws_vpc_endpoint","name":"s3","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":false,"route_table_ids":["aws_vpc.covidshield.main_route_table_id"],"service_name":"com.amazonaws.ca-central-1.s3","tags":null,"timeouts":null,"vpc_endpoint_type":"Gateway","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_vpc_endpoint.secretsmanager","mode":"managed","type":"aws_vpc_endpoint","name":"secretsmanager","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.secretsmanager","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"}},{"address":"aws_wafv2_ip_set.new_key_claim","mode":"managed","type":"aws_wafv2_ip_set","name":"new_key_claim","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"addresses":["0.0.0.0/1","128.0.0.0/1"],"description":"New Key Claim Allow IPs/CIDRs","ip_address_version":"IPV4","name":"new-key-claim","scope":"REGIONAL","tags":null}},{"address":"aws_wafv2_web_acl.key_retrieval","mode":"managed","type":"aws_wafv2_web_acl","name":"key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":null,"name":"key_retrieval","rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"CloudFrontCustomHeader","override_action":[],"priority":201,"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"covidshield"}],"single_query_argument":[],"uri_path":[]}],"positional_constraint":"EXACTLY","search_string":"test123","text_transformation":[{"priority":1,"type":"NONE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"CloudFrontCustomHeader","sampled_requests_enabled":false}]}],"scope":"REGIONAL","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"CloudFrontCustomHeader","sampled_requests_enabled":false}]}},{"address":"aws_wafv2_web_acl.key_retrieval_cdn","mode":"managed","type":"aws_wafv2_web_acl","name":"key_retrieval_cdn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"description":null,"name":"key_retrieval_cdn","rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeyRetrievalRateLimit","override_action":[],"priority":101,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":10000,"scope_down_statement":[]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeyRetrievalRateLimit","sampled_requests_enabled":true}]}],"scope":"CLOUDFRONT","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"key_retrieval_cdn","sampled_requests_enabled":false}]}},{"address":"aws_wafv2_web_acl.key_submission","mode":"managed","type":"aws_wafv2_web_acl","name":"key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":null,"name":"key_submission","rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"ClearKeysURI","override_action":[],"priority":202,"statement":[{"and_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"STARTS_WITH","search_string":"/clear-diagnosis-keys","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"authorization"}],"single_query_argument":[],"uri_path":[]}],"positional_constraint":"STARTS_WITH","search_string":"Bearer","text_transformation":[{"priority":1,"type":"NONE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[{"arn":"aws_wafv2_ip_set.new_key_claim.arn","ip_set_forwarded_ip_config":[]}],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"ClearKeysURI","sampled_requests_enabled":false}]},{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"KeySubmissionURIs","override_action":[],"priority":200,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"STARTS_WITH","search_string":"/services/","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/upload","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionURIs","sampled_requests_enabled":false}]},{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"NewKeyClaimURI","override_action":[],"priority":201,"statement":[{"and_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"STARTS_WITH","search_string":"/new-key-claim","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"authorization"}],"single_query_argument":[],"uri_path":[]}],"positional_constraint":"STARTS_WITH","search_string":"Bearer","text_transformation":[{"priority":1,"type":"NONE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[{"arn":"aws_wafv2_ip_set.new_key_claim.arn","ip_set_forwarded_ip_config":[]}],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"NewKeyClaimURI","sampled_requests_enabled":false}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit01","override_action":[],"priority":101,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit01","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit02","override_action":[],"priority":102,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit02","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit03","override_action":[],"priority":103,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit03","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit04","override_action":[],"priority":104,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit04","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit05","override_action":[],"priority":105,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit05","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesAmazonIpReputationList","override_action":[{"count":[],"none":[{}]}],"priority":1,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesAmazonIpReputationList","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesAmazonIpReputationList","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":2,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesCommonRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":3,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesKnownBadInputsRuleSet","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesLinuxRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":4,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesLinuxRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesLinuxRuleSet","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesSQLiRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":5,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesSQLiRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesSQLiRuleSet","sampled_requests_enabled":true}]}],"scope":"REGIONAL","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"key_submission","sampled_requests_enabled":false}]}},{"address":"aws_wafv2_web_acl_association.key_retrieval_assocation","mode":"managed","type":"aws_wafv2_web_acl_association","name":"key_retrieval_assocation","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"resource_arn":"aws_lb.covidshield_key_retrieval.arn","web_acl_arn":"aws_wafv2_web_acl.key_retrieval.arn"}},{"address":"aws_wafv2_web_acl_association.key_submission_assocation","mode":"managed","type":"aws_wafv2_web_acl_association","name":"key_submission_assocation","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"resource_arn":"aws_lb.covidshield_key_submission.arn","web_acl_arn":"aws_wafv2_web_acl.key_submission.arn"}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_destination_configs":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs.arn"],"logging_filter":[],"redacted_fields":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"authorization"}],"single_query_argument":[],"uri_path":[]}],"resource_arn":"aws_wafv2_web_acl.key_submission.arn"}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs_retrieval","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_destination_configs":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs.arn"],"logging_filter":[],"redacted_fields":[],"resource_arn":"aws_wafv2_web_acl.key_retrieval.arn"}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs_retrieval_cdn","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs_retrieval_cdn","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"log_destination_configs":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs_us_east.arn"],"logging_filter":[],"redacted_fields":[],"resource_arn":"aws_wafv2_web_acl.key_retrieval_cdn.arn"}},{"address":"data.aws_iam_policy_document.covidshield_secrets_manager_key_retrieval","mode":"data","type":"aws_iam_policy_document","name":"covidshield_secrets_manager_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["secretsmanager:GetSecretValue"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["aws_secretsmanager_secret.key_retrieval_env_ecdsa_key.arn","aws_secretsmanager_secret.key_retrieval_env_hmac_key.arn","aws_secretsmanager_secret.key_submission_env_key_claim_token.arn","aws_secretsmanager_secret.key_submission_metrics_password.arn","aws_secretsmanager_secret.server_database_url.arn"],"sid":null}],"version":null}},{"address":"data.aws_iam_policy_document.covidshield_secrets_manager_key_submission","mode":"data","type":"aws_iam_policy_document","name":"covidshield_secrets_manager_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["secretsmanager:GetSecretValue"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["aws_secretsmanager_secret.key_submission_env_key_claim_token.arn","aws_secretsmanager_secret.server_database_url.arn"],"sid":null}],"version":null}},{"address":"data.aws_subnet_ids.ecr_endpoint_available","mode":"data","type":"aws_subnet_ids","name":"ecr_endpoint_available","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"filter":[{"name":"availability-zone","values":["ca-central-1a","ca-central-1b"]},{"name":"tag:Access","values":["private"]}],"vpc_id":"aws_vpc.covidshield.id"}},{"address":"data.template_file.covidshield_key_retrieval_task","mode":"data","type":"template_file","name":"covidshield_key_retrieval_task","provider_name":"registry.terraform.io/hashicorp/template","schema_version":0,"values":{"filename":null,"template":"[\n    {\n      \"name\": \"key-retrieval\",\n      \"image\": \"${image}\",\n      \"portMappings\": [\n        {\n          \"containerPort\": 8001\n        }\n      ],\n      \"linuxParameters\": {\n        \"capabilities\": {\n          \"drop\": [\"ALL\"]\n        }\n      },\n      \"logConfiguration\": {\n        \"logDriver\": \"awslogs\",\n        \"options\": {\n          \"awslogs-group\": \"${awslogs-group}\",\n          \"awslogs-region\": \"${awslogs-region}\",\n          \"awslogs-stream-prefix\": \"${awslogs-stream-prefix}\"\n        }\n      },\n      \"environment\": [\n        {\n          \"name\": \"METRIC_PROVIDER\",\n          \"value\": \"${metric_provider}\"\n        },\n        {\n          \"name\": \"TRACER_PROVIDER\",\n          \"value\": \"${tracer_provider}\"\n        },\n        {\n          \"name\": \"ENV\",\n          \"value\": \"${env}\"\n        },\n        {\n          \"name\": \"METRICS_USERNAME\",\n          \"value\": \"${metrics_username}\"\n        }\n      ],\n      \"secrets\": [\n        {\n          \"name\": \"KEY_CLAIM_TOKEN\",\n          \"valueFrom\": \"${key_claim_token}\"\n        },\n        {\n          \"name\": \"RETRIEVE_HMAC_KEY\",\n          \"valueFrom\": \"${retrieve_hmac_key}\"\n        },\n        {\n          \"name\": \"ECDSA_KEY\",\n          \"valueFrom\": \"${ecdsa_key}\"\n        },\n        {\n          \"name\": \"DATABASE_URL\",\n          \"valueFrom\": \"${database_url}\"\n        },\n        {\n          \"name\": \"METRICS_PASSWORD\",\n          \"valueFrom\": \"${metrics_password}\"\n        }\n      ]\n    }\n  ]\n","vars":{"awslogs-group":"CovidShield","awslogs-region":"ca-central-1","awslogs-stream-prefix":"ecs-KeyRetrieval","database_url":"aws_secretsmanager_secret_version.server_database_url.arn","ecdsa_key":"aws_secretsmanager_secret_version.key_retrieval_env_ecdsa_key.arn","env":"test","image":"aws_ecr_repository.repository[key-retrieval].repository_url","key_claim_token":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token.arn","metric_provider":"stdout","metrics_password":"aws_secretsmanager_secret_version.key_submission_metrics_password.arn","metrics_username":"test","retrieve_hmac_key":"aws_secretsmanager_secret_version.key_retrieval_env_hmac_key.arn","tracer_provider":"stdout"}}},{"address":"data.template_file.covidshield_key_submission_task","mode":"data","type":"template_file","name":"covidshield_key_submission_task","provider_name":"registry.terraform.io/hashicorp/template","schema_version":0,"values":{"filename":null,"template":"[\n    {\n      \"name\": \"key-submission\",\n      \"image\": \"${image}\",\n      \"portMappings\": [\n        {\n          \"containerPort\": 8000\n        }\n      ],\n      \"ulimits\": [\n          {\n            \"name\": \"nofile\",\n            \"softLimit\": 1000000,\n            \"hardLimit\": 1000000\n          }\n      ],\n      \"linuxParameters\": {\n        \"capabilities\": {\n          \"drop\": [\"ALL\"]\n        }\n      },\n      \"logConfiguration\": {\n        \"logDriver\": \"awslogs\",\n        \"options\": {\n          \"awslogs-group\": \"${awslogs-group}\",\n          \"awslogs-region\": \"${awslogs-region}\",\n          \"awslogs-stream-prefix\": \"${awslogs-stream-prefix}\"\n        }\n      },\n      \"environment\": [\n        {\n            \"name\": \"METRIC_PROVIDER\",\n            \"value\": \"${metric_provider}\"\n        },\n        {\n          \"name\": \"TRACER_PROVIDER\",\n          \"value\": \"${tracer_provider}\"\n        },\n        {\n          \"name\": \"ENV\",\n          \"value\": \"${env}\"\n        },\n        {\n          \"name\": \"ENABLE_TEST_TOOLS\",\n          \"value\": \"${enable_test_tools}\"\n        }\n      ],\n      \"secrets\": [\n        {\n          \"name\": \"KEY_CLAIM_TOKEN\",\n          \"valueFrom\": \"${key_claim_token}\"\n        },\n        {\n          \"name\": \"DATABASE_URL\",\n          \"valueFrom\": \"${database_url}\"\n        }\n      ]\n    }\n  ]\n","vars":{"awslogs-group":"CovidShield","awslogs-region":"ca-central-1","awslogs-stream-prefix":"ecs-KeySubmission","database_url":"aws_secretsmanager_secret_version.server_database_url.arn","enable_test_tools":"true","env":"test","image":"aws_ecr_repository.repository[key-submission].repository_url","key_claim_token":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token.arn","metric_provider":"stdout","tracer_provider":"stdout"}}},{"address":"random_string.random","mode":"managed","type":"random_string","name":"random","provider_name":"registry.terraform.io/hashicorp/random","schema_version":1,"values":{"keepers":null,"length":6,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":true,"override_special":null,"special":false,"upper":false}}],"child_modules":[{"resources":[{"address":"module.covid-shield-retrieval.aws_codedeploy_app.app","mode":"managed","type":"aws_codedeploy_app","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"compute_platform":"ECS","name":"AppECS-CovidShield-KeyRetrieval","tags":null}},{"address":"module.covid-shield-retrieval.aws_codedeploy_deployment_group.app","mode":"managed","type":"aws_codedeploy_deployment_group","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alarm_configuration":[],"app_name":"AppECS-CovidShield-KeyRetrieval","auto_rollback_configuration":[{"enabled":true,"events":["DEPLOYMENT_FAILURE"]}],"autoscaling_groups":null,"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":"CONTINUE_DEPLOYMENT","wait_time_in_minutes":null}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{"action":"TERMINATE","termination_wait_time_in_minutes":1}]}],"deployment_config_name":"CodeDeployDefault.ECSAllAtOnce","deployment_group_name":"DgpECS-CovidShield-KeyRetrieval","deployment_style":[{"deployment_option":"WITH_TRAFFIC_CONTROL","deployment_type":"BLUE_GREEN"}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{"cluster_name":"CovidShield","service_name":"KeyRetrieval"}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_retrieval.arn"]}],"target_group":[{"name":"covidshield-key-retrieval"},{"name":"covidshield-key-retrieval-2"}],"test_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_retrieval_test.arn"]}]}]}],"on_premises_instance_tag_filter":[],"service_role_arn":"aws_iam_role.codedeploy.arn","tags":null,"trigger_configuration":[]}}],"address":"module.covid-shield-retrieval"},{"resources":[{"address":"module.covid-shield-submission.aws_codedeploy_app.app","mode":"managed","type":"aws_codedeploy_app","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"compute_platform":"ECS","name":"AppECS-CovidShield-KeySubmission","tags":null}},{"address":"module.covid-shield-submission.aws_codedeploy_deployment_group.app","mode":"managed","type":"aws_codedeploy_deployment_group","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alarm_configuration":[],"app_name":"AppECS-CovidShield-KeySubmission","auto_rollback_configuration":[{"enabled":true,"events":["DEPLOYMENT_FAILURE"]}],"autoscaling_groups":null,"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":"CONTINUE_DEPLOYMENT","wait_time_in_minutes":null}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{"action":"TERMINATE","termination_wait_time_in_minutes":1}]}],"deployment_config_name":"CodeDeployDefault.ECSAllAtOnce","deployment_group_name":"DgpECS-CovidShield-KeySubmission","deployment_style":[{"deployment_option":"WITH_TRAFFIC_CONTROL","deployment_type":"BLUE_GREEN"}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{"cluster_name":"CovidShield","service_name":"KeySubmission"}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_submission.arn"]}],"target_group":[{"name":"covidshield-key-submission"},{"name":"covidshield-key-submission-2"}],"test_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_submission_test.arn"]}]}]}],"on_premises_instance_tag_filter":[],"service_role_arn":"aws_iam_role.codedeploy.arn","tags":null,"trigger_configuration":[]}}],"address":"module.covid-shield-submission"}]}},"resource_changes":[{"address":"aws_acm_certificate.covidshield","mode":"managed","type":"aws_acm_certificate","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"test.com","domain_validation_options":[{"domain_name":"*.test.com"},{"domain_name":"test.com"}],"options":[],"private_key":null,"subject_alternative_names":["*.test.com"],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"validation_method":"DNS"},"after_unknown":{"arn":true,"domain_validation_options":[{"resource_record_name":true,"resource_record_type":true,"resource_record_value":true},{"resource_record_name":true,"resource_record_type":true,"resource_record_value":true}],"id":true,"options":[],"status":true,"subject_alternative_names":[false],"tags":{},"tags_all":{},"validation_emails":true}}},{"address":"aws_acm_certificate.retrieval_covidshield","mode":"managed","type":"aws_acm_certificate","name":"retrieval_covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_authority_arn":null,"certificate_body":null,"certificate_chain":null,"domain_name":"retrieval.test.com","domain_validation_options":[{"domain_name":"retrieval.test.com"}],"options":[],"private_key":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"validation_method":"DNS"},"after_unknown":{"arn":true,"domain_validation_options":[{"resource_record_name":true,"resource_record_type":true,"resource_record_value":true}],"id":true,"options":[],"status":true,"subject_alternative_names":true,"tags":{},"tags_all":{},"validation_emails":true}}},{"address":"aws_acm_certificate_validation.covidshield","mode":"managed","type":"aws_acm_certificate_validation","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_arn":"aws_acm_certificate.covidshield.arn","timeouts":null,"validation_record_fqdns":["aws_route53_record.covidshield_certificate_validation[*.test.com].fqdn","aws_route53_record.covidshield_certificate_validation[test.com].fqdn"]},"after_unknown":{"id":true,"validation_record_fqdns":[false,false]}}},{"address":"aws_acm_certificate_validation.retrieval_covidshield","mode":"managed","type":"aws_acm_certificate_validation","name":"retrieval_covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"certificate_arn":"aws_acm_certificate.retrieval_covidshield.arn","timeouts":null,"validation_record_fqdns":["aws_route53_record.retrieval_covidshield_certificate_validation[retrieval.test.com].fqdn"]},"after_unknown":{"id":true,"validation_record_fqdns":[false]}}},{"address":"aws_appautoscaling_policy.retrieval_cpu[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"retrieval_cpu","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"retrieval_cpu","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeyRetrieval","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageCPUUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]},"after_unknown":{"arn":true,"id":true,"step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"predefined_metric_specification":[{}]}]}}},{"address":"aws_appautoscaling_policy.retrieval_memory[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"retrieval_memory","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"retrieval_memory","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeyRetrieval","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageMemoryUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]},"after_unknown":{"arn":true,"id":true,"step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"predefined_metric_specification":[{}]}]}}},{"address":"aws_appautoscaling_policy.submission_cpu[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"submission_cpu","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"submission_cpu","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeySubmission","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageCPUUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]},"after_unknown":{"arn":true,"id":true,"step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"predefined_metric_specification":[{}]}]}}},{"address":"aws_appautoscaling_policy.submission_memory[0]","mode":"managed","type":"aws_appautoscaling_policy","name":"submission_memory","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"submission_memory","policy_type":"TargetTrackingScaling","resource_id":"service/aws_ecs_cluster.covidshield.id/KeySubmission","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs","step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"disable_scale_in":null,"predefined_metric_specification":[{"predefined_metric_type":"ECSServiceAverageMemoryUtilization","resource_label":null}],"scale_in_cooldown":60,"scale_out_cooldown":60,"target_value":60}]},"after_unknown":{"arn":true,"id":true,"step_scaling_policy_configuration":[],"target_tracking_scaling_policy_configuration":[{"customized_metric_specification":[],"predefined_metric_specification":[{}]}]}}},{"address":"aws_appautoscaling_target.retrieval[0]","mode":"managed","type":"aws_appautoscaling_target","name":"retrieval","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"max_capacity":10,"min_capacity":1,"resource_id":"service/aws_ecs_cluster.covidshield.id/KeyRetrieval","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs"},"after_unknown":{"id":true,"role_arn":true}}},{"address":"aws_appautoscaling_target.submission[0]","mode":"managed","type":"aws_appautoscaling_target","name":"submission","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"max_capacity":10,"min_capacity":1,"resource_id":"service/aws_ecs_cluster.covidshield.id/KeySubmission","scalable_dimension":"ecs:service:DesiredCount","service_namespace":"ecs"},"after_unknown":{"id":true,"role_arn":true}}},{"address":"aws_cloudfront_distribution.key_retrieval_distribution","mode":"managed","type":"aws_cloudfront_distribution","name":"key_retrieval_distribution","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"aliases":["retrieval.test.com"],"comment":null,"custom_error_response":[],"default_cache_behavior":[{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":true,"default_ttl":3600,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"all","whitelisted_names":null}],"headers":["Host"],"query_string":true,"query_string_cache_keys":null}],"function_association":[],"lambda_function_association":[],"max_ttl":7200,"min_ttl":0,"origin_request_policy_id":null,"realtime_log_config_arn":null,"smooth_streaming":null,"target_origin_id":"covidshield-key-retrieval","trusted_key_groups":null,"trusted_signers":null,"viewer_protocol_policy":"https-only"}],"default_root_object":null,"enabled":true,"http_version":"http2","is_ipv6_enabled":true,"logging_config":[{"bucket":"aws_s3_bucket.cloudfront_logs.bucket_domain_name","include_cookies":false,"prefix":"cloudfront"}],"ordered_cache_behavior":[{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":true,"default_ttl":86400,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"none","whitelisted_names":null}],"headers":["Origin"],"query_string":false,"query_string_cache_keys":null}],"function_association":[],"lambda_function_association":[],"max_ttl":31536000,"min_ttl":0,"origin_request_policy_id":null,"path_pattern":"/exposure-configuration/*","realtime_log_config_arn":null,"smooth_streaming":null,"target_origin_id":"covid-shield-exposure-config-test","trusted_key_groups":null,"trusted_signers":null,"viewer_protocol_policy":"https-only"},{"allowed_methods":["GET","HEAD"],"cache_policy_id":null,"cached_methods":["GET","HEAD"],"compress":true,"default_ttl":0,"field_level_encryption_id":null,"forwarded_values":[{"cookies":[{"forward":"all","whitelisted_names":null}],"headers":["Authorization","Host"],"query_string":true,"query_string_cache_keys":null}],"function_association":[],"lambda_function_association":[],"max_ttl":0,"min_ttl":0,"origin_request_policy_id":null,"path_pattern":"/events/*","realtime_log_config_arn":null,"smooth_streaming":null,"target_origin_id":"covidshield-key-retrieval","trusted_key_groups":null,"trusted_signers":null,"viewer_protocol_policy":"https-only"}],"origin":[{"connection_attempts":null,"connection_timeout":null,"custom_header":[{"name":"covidshield","value":"test123"}],"custom_origin_config":[{"http_port":80,"https_port":443,"origin_keepalive_timeout":null,"origin_protocol_policy":"https-only","origin_read_timeout":null,"origin_ssl_protocols":["TLSv1.2"]}],"domain_name":"aws_lb.covidshield_key_retrieval.dns_name","origin_id":"covidshield-key-retrieval","origin_path":null,"origin_shield":[],"s3_origin_config":[]},{"connection_attempts":null,"connection_timeout":null,"custom_header":[],"custom_origin_config":[],"domain_name":"aws_s3_bucket.exposure_config.bucket_regional_domain_name","origin_id":"covid-shield-exposure-config-test","origin_path":null,"origin_shield":[],"s3_origin_config":[{"origin_access_identity":"aws_cloudfront_origin_access_identity.origin_access_identity.cloudfront_access_identity_path"}]}],"origin_group":[],"price_class":"PriceClass_100","restrictions":[{"geo_restriction":[{"locations":null,"restriction_type":"none"}]}],"retain_on_delete":false,"tags":null,"viewer_certificate":[{"acm_certificate_arn":"aws_acm_certificate.retrieval_covidshield.arn","cloudfront_default_certificate":null,"iam_certificate_id":null,"minimum_protocol_version":"TLSv1.2_2018","ssl_support_method":"sni-only"}],"wait_for_deployment":true,"web_acl_id":"aws_wafv2_web_acl.key_retrieval_cdn.arn"},"after_unknown":{"aliases":[false],"arn":true,"caller_reference":true,"custom_error_response":[],"default_cache_behavior":[{"allowed_methods":[false,false],"cached_methods":[false,false],"forwarded_values":[{"cookies":[{}],"headers":[false]}],"function_association":[],"lambda_function_association":[]}],"domain_name":true,"etag":true,"hosted_zone_id":true,"id":true,"in_progress_validation_batches":true,"last_modified_time":true,"logging_config":[{}],"ordered_cache_behavior":[{"allowed_methods":[false,false],"cached_methods":[false,false],"forwarded_values":[{"cookies":[{}],"headers":[false]}],"function_association":[],"lambda_function_association":[]},{"allowed_methods":[false,false],"cached_methods":[false,false],"forwarded_values":[{"cookies":[{}],"headers":[false,false]}],"function_association":[],"lambda_function_association":[]}],"origin":[{"custom_header":[{}],"custom_origin_config":[{"origin_ssl_protocols":[false]}],"origin_shield":[],"s3_origin_config":[]},{"custom_header":[],"custom_origin_config":[],"origin_shield":[],"s3_origin_config":[{}]}],"origin_group":[],"restrictions":[{"geo_restriction":[{}]}],"status":true,"tags_all":true,"trusted_key_groups":true,"trusted_signers":true,"viewer_certificate":[{}]}}},{"address":"aws_cloudfront_origin_access_identity.origin_access_identity","mode":"managed","type":"aws_cloudfront_origin_access_identity","name":"origin_access_identity","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"comment":"cloudfront origin access identity"},"after_unknown":{"caller_reference":true,"cloudfront_access_identity_path":true,"etag":true,"iam_arn":true,"id":true,"s3_canonical_user_id":true}}},{"address":"aws_cloudwatch_log_group.covidshield","mode":"managed","type":"aws_cloudwatch_log_group","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":"aws_kms_key.cw.arn","name":"CovidShield","name_prefix":null,"retention_in_days":90,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"id":true,"tags":{},"tags_all":{}}}},{"address":"aws_cloudwatch_log_group.vpc_flow_logs","mode":"managed","type":"aws_cloudwatch_log_group","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"kms_key_id":"aws_kms_key.cw.arn","name":"vpc_flow_logs","name_prefix":null,"retention_in_days":30,"tags":null},"after_unknown":{"arn":true,"id":true,"tags_all":true}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[0]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[0].sum"}],"name":"ClaimedOneTimeCodeTotal0","pattern":"{$.updates[0].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[1]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[1].sum"}],"name":"ClaimedOneTimeCodeTotal1","pattern":"{$.updates[1].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[2]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[2].sum"}],"name":"ClaimedOneTimeCodeTotal2","pattern":"{$.updates[2].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[3]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":3,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[3].sum"}],"name":"ClaimedOneTimeCodeTotal3","pattern":"{$.updates[3].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[4]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":4,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[4].sum"}],"name":"ClaimedOneTimeCodeTotal4","pattern":"{$.updates[4].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[5]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":5,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[5].sum"}],"name":"ClaimedOneTimeCodeTotal5","pattern":"{$.updates[5].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[6]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":6,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[6].sum"}],"name":"ClaimedOneTimeCodeTotal6","pattern":"{$.updates[6].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal[7]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","index":7,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ClaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[7].sum"}],"name":"ClaimedOneTimeCodeTotal7","pattern":"{$.updates[7].name = \"covidshield.app.claimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[0]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[0].sum"}],"name":"DiagnosisKeyTotal0","pattern":"{$.updates[0].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[1]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[1].sum"}],"name":"DiagnosisKeyTotal1","pattern":"{$.updates[1].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[2]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[2].sum"}],"name":"DiagnosisKeyTotal2","pattern":"{$.updates[2].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[3]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":3,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[3].sum"}],"name":"DiagnosisKeyTotal3","pattern":"{$.updates[3].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[4]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":4,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[4].sum"}],"name":"DiagnosisKeyTotal4","pattern":"{$.updates[4].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[5]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":5,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[5].sum"}],"name":"DiagnosisKeyTotal5","pattern":"{$.updates[5].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[6]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":6,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[6].sum"}],"name":"DiagnosisKeyTotal6","pattern":"{$.updates[6].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal[7]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","index":7,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"DiagnosisKeyTotal","namespace":"CovidShield","unit":null,"value":"$.updates[7].sum"}],"name":"DiagnosisKeyTotal7","pattern":"{$.updates[7].name = \"covidshield.app.diagnosis_keys.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[0]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[0].sum"}],"name":"UnclaimedOneTimeCodeTotal0","pattern":"{$.updates[0].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[1]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[1].sum"}],"name":"UnclaimedOneTimeCodeTotal1","pattern":"{$.updates[1].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[2]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[2].sum"}],"name":"UnclaimedOneTimeCodeTotal2","pattern":"{$.updates[2].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[3]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":3,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[3].sum"}],"name":"UnclaimedOneTimeCodeTotal3","pattern":"{$.updates[3].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[4]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":4,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[4].sum"}],"name":"UnclaimedOneTimeCodeTotal4","pattern":"{$.updates[4].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[5]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":5,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[5].sum"}],"name":"UnclaimedOneTimeCodeTotal5","pattern":"{$.updates[5].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[6]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":6,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[6].sum"}],"name":"UnclaimedOneTimeCodeTotal6","pattern":"{$.updates[6].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal[7]","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","index":7,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnclaimedOneTimeCodeTotal","namespace":"CovidShield","unit":null,"value":"$.updates[7].sum"}],"name":"UnclaimedOneTimeCodeTotal7","pattern":"{$.updates[7].name = \"covidshield.app.unclaimed_one_time_codes.total\"}"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.error_logged","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"error_logged","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"ErrorLogged","namespace":"CovidShield","unit":null,"value":"1"}],"name":"ErrorLogged","pattern":"level=error"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.fatal_logged","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"fatal_logged","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"FatalLogged","namespace":"CovidShield","unit":null,"value":"1"}],"name":"FatalLogged","pattern":"level=fatal"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.five_hundred_response","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"five_hundred_response","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"500Response","namespace":"CovidShield","unit":null,"value":"1"}],"name":"500Response","pattern":"statusClass=5xx msg=\"http response\""},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.key_clear_called","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"key_clear_called","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"KeyClearCalled","namespace":"CovidShield","unit":null,"value":"1"}],"name":"KeyClearCalled","pattern":"diagnosis_keys was truncated"},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_new_one_time_code_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_new_one_time_code_requests","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnauthorizedNewOneTimeCodeRequests","namespace":"CovidShield","unit":null,"value":"1"}],"name":"UnauthorizedNewOneTimeCodeRequests","pattern":"statusCode=401 msg=\"http response\" \"path=/new-key-claim\""},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_one_time_code_claim_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_one_time_code_claim_requests","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnauthorizedOneTimeCodeClaimRequests","namespace":"CovidShield","unit":null,"value":"1"}],"name":"UnauthorizedOneTimeCodeClaimRequests","pattern":"statusCode=401 msg=\"http response\" \"path=/claim-key\""},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_upload_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_upload_requests","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_group_name":"CovidShield","metric_transformation":[{"default_value":null,"dimensions":null,"name":"UnauthorizedUploadRequests","namespace":"CovidShield","unit":null,"value":"1"}],"name":"UnauthorizedUploadRequests","pattern":"statusClass=4xx msg=\"http response\" \"path=/upload\""},"after_unknown":{"id":true,"metric_transformation":[{}]}}},{"address":"aws_cloudwatch_metric_alarm.ClaimedOneTimeCodeTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ClaimedOneTimeCodeTotalCritical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for total claimed codes","alarm_name":"ClaimedOneTimeCodeTotalCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ClaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":4500,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.ClaimedOneTimeCodeTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ClaimedOneTimeCodeTotalWarn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for total claimed codes","alarm_name":"ClaimedOneTimeCodeTotalWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ClaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":3000,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.DiagnosisKeyTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"DiagnosisKeyTotalCritical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for total diagnosis keys","alarm_name":"DiagnosisKeyTotalCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DiagnosisKeyTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":13500,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.DiagnosisKeyTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"DiagnosisKeyTotalWarn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for total diagnosis keys","alarm_name":"DiagnosisKeyTotalWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DiagnosisKeyTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":9000,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.UnclaimedOneTimeCodeTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"UnclaimedOneTimeCodeTotalCritical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for total unclaimed codes","alarm_name":"UnclaimedOneTimeCodeTotalCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnclaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":400,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.UnclaimedOneTimeCodeTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"UnclaimedOneTimeCodeTotalWarn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for total unclaimed codes","alarm_name":"UnclaimedOneTimeCodeTotalWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnclaimedOneTimeCodeTotal","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Maximum","tags":null,"threshold":250,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_cdn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_cdn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"This metric monitors for DDoS detected on retrieval CDN","alarm_name":"DDoSDetectedCDN","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"aws_cloudfront_distribution.key_retrieval_distribution.arn"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_retrieval","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for DDoS detected on retrieval ALB","alarm_name":"DDoSDetectedRetrievalALB","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"aws_lb.covidshield_key_retrieval.arn"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_route53","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_route53","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"This metric monitors for DDoS detected on route 53","alarm_name":"DDoSDetectedRoute53","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"arn:aws:route53:::hostedzone/aws_route53_zone.covidshield.zone_id"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_submission","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for DDoS detected on submission ALB","alarm_name":"DDoSDetectedSubmissionALB","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ResourceArn":"aws_lb.covidshield_key_submission.arn"},"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"DDoSDetected","metric_query":[],"namespace":"AWS/DDoSProtection","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.error_logged_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"error_logged_critical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for an error level logs","alarm_name":"ErrorLoggedCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ErrorLogged","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":10,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.error_logged_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"error_logged_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for an error level logs","alarm_name":"ErrorLoggedWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"ErrorLogged","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.fatal_logged_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"fatal_logged_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for a fatal level logs","alarm_name":"FatalLoggedWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"FatalLogged","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.five_hundred_response_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"five_hundred_response_critical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors for an 5xx level response","alarm_name":"500ResponseCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"500Response","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":10,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.five_hundred_response_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"five_hundred_response_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for an 5xx level response","alarm_name":"500ResponseWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"500Response","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.key_clear_called_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"key_clear_called_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn","aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors for a key clear calls (only be called in staging)","alarm_name":"KeyClearCalledWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"KeyClearCalled","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":60,"statistic":"Sum","tags":null,"threshold":0,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.retrieval_cpu_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"retrieval_cpu_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs cpu utilization","alarm_name":"retrieval-cpu-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeyRetrieval"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.retrieval_memory_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"retrieval_memory_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs memory utilization","alarm_name":"retrieval-memory-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeyRetrieval"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"MemoryUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Retrieval server is in alarm","alarm_name":"Route53RetrievalHealthCheck","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_retrieval_healthcheck.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check_ca_json","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check_ca_json","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Retrieval server is correctly serving CA.json","alarm_name":"Route53RetrievalHealthCheckCAJson","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_ca_json.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check_region_json","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check_region_json","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Retrieval server is correctly serving region.json","alarm_name":"Route53RetrievalHealthCheckRegionJson","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_region_json.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.route53_submission_health_check","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_submission_health_check","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical_us_east.arn","aws_sns_topic.alert_warning_us_east.arn"],"alarm_description":"Check that the Submission server is in alarm","alarm_name":"Route53SubmissionHealthCheck","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"HealthCheckId":"aws_route53_health_check.covidshield_key_submission_healthcheck.id"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"HealthCheckStatus","metric_query":[],"namespace":"AWS/Route53","ok_actions":null,"period":60,"statistic":"Average","tags":null,"threshold":1,"threshold_metric_id":null,"treat_missing_data":"breaching","unit":null},"after_unknown":{"alarm_actions":[false,false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.submission_cpu_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"submission_cpu_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs cpu utilization","alarm_name":"submission-cpu-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeySubmission"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.submission_memory_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"submission_memory_utilization_high","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors ecs memory utilization","alarm_name":"submission-memory-utilization-high","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"ClusterName":"CovidShield","ServiceName":"KeySubmission"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"MemoryUtilization","metric_query":[],"namespace":"AWS/ECS","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":50,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_new_one_time_code_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_new_one_time_code_requests_critical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors the 401 response rate for /new-key-claim","alarm_name":"UnauthorizedNewOneTimeCodeRequestsCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedNewOneTimeCodeRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":100,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_new_one_time_code_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_new_one_time_code_requests_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors the 401 response rate for /new-key-claim","alarm_name":"UnauthorizedNewOneTimeCodeRequestsWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedNewOneTimeCodeRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_one_time_code_claim_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_one_time_code_claim_requests_critical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors the 401 response rate for /claim-key","alarm_name":"UnauthorizedOneTimeCodeClaimRequestsCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedOneTimeCodeClaimRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":100,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_one_time_code_claim_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_one_time_code_claim_requests_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors the 401 response rate for /claim-key","alarm_name":"UnauthorizedOneTimeCodeClaimRequestsWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedOneTimeCodeClaimRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_upload_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_upload_requests_critical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_critical.arn"],"alarm_description":"This metric monitors the 4xx response rate for /upload","alarm_name":"UnauthorizedUploadRequestsCritical","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedUploadRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":100,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_upload_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_upload_requests_warn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_actions":["aws_sns_topic.alert_warning.arn"],"alarm_description":"This metric monitors the 4xx response rate for /upload","alarm_name":"UnauthorizedUploadRequestsWarn","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":null,"evaluation_periods":1,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"UnauthorizedUploadRequests","metric_query":[],"namespace":"CovidShield","ok_actions":null,"period":300,"statistic":"Sum","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":[false],"arn":true,"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true}}},{"address":"aws_db_subnet_group.covidshield","mode":"managed","type":"aws_db_subnet_group","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","name":"server","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":{"CostCentre":"CovidShield","Name":"server"},"tags_all":{"CostCentre":"CovidShield","Name":"server"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"subnet_ids":[false,false,false],"tags":{},"tags_all":{}}}},{"address":"aws_default_network_acl.covidshield","mode":"managed","type":"aws_default_network_acl","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"default_network_acl_id":"aws_vpc.covidshield.default_network_acl_id","egress":[{"action":"allow","cidr_block":"0.0.0.0/0","from_port":0,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"-1","rule_no":100,"to_port":0}],"ingress":[{"action":"allow","cidr_block":"0.0.0.0/0","from_port":0,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"-1","rule_no":300,"to_port":0},{"action":"deny","cidr_block":"0.0.0.0/0","from_port":22,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"tcp","rule_no":100,"to_port":22},{"action":"deny","cidr_block":"0.0.0.0/0","from_port":3389,"icmp_code":null,"icmp_type":null,"ipv6_cidr_block":null,"protocol":"tcp","rule_no":200,"to_port":3389}],"subnet_ids":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"egress":[{}],"id":true,"ingress":[{},{},{}],"owner_id":true,"tags":{},"tags_all":{},"vpc_id":true}}},{"address":"aws_ecr_lifecycle_policy.policy[\"key-retrieval\"]","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","index":"key-retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n","repository":"covid-server/key-retrieval"},"after_unknown":{"id":true,"registry_id":true}}},{"address":"aws_ecr_lifecycle_policy.policy[\"key-submission\"]","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","index":"key-submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n","repository":"covid-server/key-submission"},"after_unknown":{"id":true,"registry_id":true}}},{"address":"aws_ecr_lifecycle_policy.policy[\"monolith\"]","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","index":"monolith","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n","repository":"covid-server/monolith"},"after_unknown":{"id":true,"registry_id":true}}},{"address":"aws_ecr_repository.repository[\"key-retrieval\"]","mode":"managed","type":"aws_ecr_repository","name":"repository","index":"key-retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"encryption_configuration":[],"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"covid-server/key-retrieval","tags":null,"timeouts":null},"after_unknown":{"arn":true,"encryption_configuration":[],"id":true,"image_scanning_configuration":[{}],"registry_id":true,"repository_url":true,"tags_all":true}}},{"address":"aws_ecr_repository.repository[\"key-submission\"]","mode":"managed","type":"aws_ecr_repository","name":"repository","index":"key-submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"encryption_configuration":[],"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"covid-server/key-submission","tags":null,"timeouts":null},"after_unknown":{"arn":true,"encryption_configuration":[],"id":true,"image_scanning_configuration":[{}],"registry_id":true,"repository_url":true,"tags_all":true}}},{"address":"aws_ecr_repository.repository[\"monolith\"]","mode":"managed","type":"aws_ecr_repository","name":"repository","index":"monolith","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"encryption_configuration":[],"image_scanning_configuration":[{"scan_on_push":true}],"image_tag_mutability":"MUTABLE","name":"covid-server/monolith","tags":null,"timeouts":null},"after_unknown":{"arn":true,"encryption_configuration":[],"id":true,"image_scanning_configuration":[{}],"registry_id":true,"repository_url":true,"tags_all":true}}},{"address":"aws_ecs_cluster.covidshield","mode":"managed","type":"aws_ecs_cluster","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_providers":null,"configuration":[],"default_capacity_provider_strategy":[],"name":"CovidShield","setting":[{"name":"containerInsights","value":"enabled"}],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"configuration":[],"default_capacity_provider_strategy":[],"id":true,"setting":[{}],"tags":{},"tags_all":{}}}},{"address":"aws_ecs_service.covidshield_key_retrieval","mode":"managed","type":"aws_ecs_service","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_provider_strategy":[],"cluster":"aws_ecs_cluster.covidshield.id","deployment_circuit_breaker":[],"deployment_controller":[{"type":"CODE_DEPLOY"}],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":50,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":60,"launch_type":"FARGATE","load_balancer":[{"container_name":"key-retrieval","container_port":8001,"elb_name":null,"target_group_arn":"aws_lb_target_group.covidshield_key_retrieval.arn"}],"name":"KeyRetrieval","network_configuration":[{"assign_public_ip":false,"security_groups":["aws_security_group.covidshield_key_retrieval.id"],"subnets":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"]}],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":"1.4.0","propagate_tags":"SERVICE","scheduling_strategy":"REPLICA","service_registries":[],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_definition":"aws_ecs_task_definition.covidshield_key_retrieval.arn","timeouts":null,"wait_for_steady_state":false},"after_unknown":{"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[{}],"iam_role":true,"id":true,"load_balancer":[{}],"network_configuration":[{"security_groups":[false],"subnets":[false,false,false]}],"ordered_placement_strategy":[],"placement_constraints":[],"service_registries":[],"tags":{},"tags_all":{}}}},{"address":"aws_ecs_service.covidshield_key_submission","mode":"managed","type":"aws_ecs_service","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_provider_strategy":[],"cluster":"aws_ecs_cluster.covidshield.id","deployment_circuit_breaker":[],"deployment_controller":[{"type":"CODE_DEPLOY"}],"deployment_maximum_percent":200,"deployment_minimum_healthy_percent":50,"desired_count":1,"enable_ecs_managed_tags":false,"enable_execute_command":false,"force_new_deployment":null,"health_check_grace_period_seconds":60,"launch_type":"FARGATE","load_balancer":[{"container_name":"key-submission","container_port":8000,"elb_name":null,"target_group_arn":"aws_lb_target_group.covidshield_key_submission.arn"}],"name":"KeySubmission","network_configuration":[{"assign_public_ip":false,"security_groups":["aws_security_group.covidshield_key_submission.id"],"subnets":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"]}],"ordered_placement_strategy":[],"placement_constraints":[],"platform_version":"1.4.0","propagate_tags":"SERVICE","scheduling_strategy":"REPLICA","service_registries":[],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_definition":"aws_ecs_task_definition.covidshield_key_submission.arn","timeouts":null,"wait_for_steady_state":false},"after_unknown":{"capacity_provider_strategy":[],"deployment_circuit_breaker":[],"deployment_controller":[{}],"iam_role":true,"id":true,"load_balancer":[{}],"network_configuration":[{"security_groups":[false],"subnets":[false,false,false]}],"ordered_placement_strategy":[],"placement_constraints":[],"service_registries":[],"tags":{},"tags_all":{}}}},{"address":"aws_ecs_task_definition.covidshield_key_retrieval","mode":"managed","type":"aws_ecs_task_definition","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"container_definitions":"data.template_file.covidshield_key_retrieval_task.rendered","cpu":"512","ephemeral_storage":[],"execution_role_arn":"aws_iam_role.covidshield_key_retrieval.arn","family":"KeyRetrieval","inference_accelerator":[],"ipc_mode":null,"memory":"1024","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_role_arn":"aws_iam_role.covidshield_key_retrieval.arn","volume":[]},"after_unknown":{"arn":true,"ephemeral_storage":[],"id":true,"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"revision":true,"tags":{},"tags_all":{},"volume":[]}}},{"address":"aws_ecs_task_definition.covidshield_key_submission","mode":"managed","type":"aws_ecs_task_definition","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"container_definitions":"data.template_file.covidshield_key_submission_task.rendered","cpu":"512","ephemeral_storage":[],"execution_role_arn":"aws_iam_role.covidshield_key_submission.arn","family":"KeySubmission","inference_accelerator":[],"ipc_mode":null,"memory":"1024","network_mode":"awsvpc","pid_mode":null,"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":["FARGATE"],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"task_role_arn":"aws_iam_role.covidshield_key_submission.arn","volume":[]},"after_unknown":{"arn":true,"ephemeral_storage":[],"id":true,"inference_accelerator":[],"placement_constraints":[],"proxy_configuration":[],"requires_compatibilities":[false],"revision":true,"tags":{},"tags_all":{},"volume":[]}}},{"address":"aws_elasticache_replication_group.covidshield[0]","mode":"managed","type":"aws_elasticache_replication_group","name":"covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"apply_immediately":true,"at_rest_encryption_enabled":true,"auth_token":null,"auto_minor_version_upgrade":true,"automatic_failover_enabled":true,"availability_zones":["ca-central-1a","ca-central-1b","ca-central-1d"],"cluster_mode":[],"engine":"redis","final_snapshot_identifier":null,"kms_key_id":null,"multi_az_enabled":false,"node_type":"cache.t3.small","notification_topic_arn":null,"number_cache_clusters":3,"parameter_group_name":"default.redis5.0","port":6379,"replication_group_description":"covidshield","replication_group_id":"covidshield","security_group_ids":["aws_security_group.covidshield_redis[0].id"],"snapshot_arns":null,"snapshot_name":null,"snapshot_retention_limit":null,"subnet_group_name":"covidshield","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"transit_encryption_enabled":true},"after_unknown":{"arn":true,"availability_zones":[false,false,false],"cluster_enabled":true,"cluster_mode":[],"configuration_endpoint_address":true,"engine_version":true,"engine_version_actual":true,"global_replication_group_id":true,"id":true,"maintenance_window":true,"member_clusters":true,"primary_endpoint_address":true,"reader_endpoint_address":true,"security_group_ids":[false],"security_group_names":true,"snapshot_window":true,"tags":{},"tags_all":{}}}},{"address":"aws_elasticache_subnet_group.covidshield[0]","mode":"managed","type":"aws_elasticache_subnet_group","name":"covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Managed by Terraform","name":"covidshield","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null},"after_unknown":{"arn":true,"id":true,"subnet_ids":[false,false,false],"tags_all":true}}},{"address":"aws_flow_log.vpc_flow_logs","mode":"managed","type":"aws_flow_log","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"eni_id":null,"iam_role_arn":"aws_iam_role.vpc_flow_logs.arn","log_destination":"aws_cloudwatch_log_group.vpc_flow_logs.arn","log_destination_type":"cloud-watch-logs","max_aggregation_interval":600,"subnet_id":null,"tags":null,"traffic_type":"ALL","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"id":true,"log_format":true,"log_group_name":true,"tags_all":true}}},{"address":"aws_iam_policy.covidshield_secrets_manager_key_retrieval","mode":"managed","type":"aws_iam_policy","name":"covidshield_secrets_manager_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"CovidShieldSecretsManagerKeyRetrieval","name_prefix":null,"path":"/","policy":"data.aws_iam_policy_document.covidshield_secrets_manager_key_retrieval.json","tags":null},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags_all":true}}},{"address":"aws_iam_policy.covidshield_secrets_manager_key_submission","mode":"managed","type":"aws_iam_policy","name":"covidshield_secrets_manager_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"name":"CovidShieldSecretsManagerKeySubmission","name_prefix":null,"path":"/","policy":"data.aws_iam_policy_document.covidshield_secrets_manager_key_submission.json","tags":null},"after_unknown":{"arn":true,"id":true,"policy_id":true,"tags_all":true}}},{"address":"aws_iam_role.codedeploy","mode":"managed","type":"aws_iam_role","name":"codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"codedeploy.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"codedeploy","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags_all":true,"unique_id":true}}},{"address":"aws_iam_role.covidshield_key_retrieval","mode":"managed","type":"aws_iam_role","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"KeyRetrieval","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags":{},"tags_all":{},"unique_id":true}}},{"address":"aws_iam_role.covidshield_key_submission","mode":"managed","type":"aws_iam_role","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      }\n    }\n  ]\n}","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"KeySubmission","name_prefix":null,"path":"/","permissions_boundary":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags":{},"tags_all":{},"unique_id":true}}},{"address":"aws_iam_role.firehose_waf_logs","mode":"managed","type":"aws_iam_role","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"firehose.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"firehose_waf_logs","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags_all":true,"unique_id":true}}},{"address":"aws_iam_role.lambda_validate_deploy","mode":"managed","type":"aws_iam_role","name":"lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"lambda-validate-deploy","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags_all":true,"unique_id":true}}},{"address":"aws_iam_role.vpc_flow_logs","mode":"managed","type":"aws_iam_role","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assume_role_policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"vpc-flow-logs.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n","description":null,"force_detach_policies":false,"inline_policy":[],"max_session_duration":3600,"name":"vpc_flow_logs","name_prefix":null,"path":"/","permissions_boundary":null,"tags":null},"after_unknown":{"arn":true,"create_date":true,"id":true,"inline_policy":[],"managed_policy_arns":true,"tags_all":true,"unique_id":true}}},{"address":"aws_iam_role_policy.firehose_waf_logs","mode":"managed","type":"aws_iam_role_policy","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"firehose-waf-logs-policy","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:AbortMultipartUpload\",\n        \"s3:GetBucketLocation\",\n        \"s3:GetObject\",\n        \"s3:ListBucket\",\n        \"s3:ListBucketMultipartUploads\",\n        \"s3:PutObject\"\n      ],\n      \"Resource\": [\n        \"aws_s3_bucket.firehose_waf_logs.arn\",\n        \"aws_s3_bucket.firehose_waf_logs.arn/*\"\n      ]\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": \"iam:CreateServiceLinkedRole\",\n      \"Resource\": \"arn:aws:iam::*:role/aws-service-role/wafv2.amazonaws.com/AWSServiceRoleForWAFV2Logging\"\n    }\n  ]\n}\n","role":"aws_iam_role.firehose_waf_logs.id"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy.lambda_validate_codedeploy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_validate_codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"LambdaValidateCodeDeploy","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codedeploy:PutLifecycleEventHookExecutionStatus\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","role":"aws_iam_role.lambda_validate_deploy.id"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy.vpc_flow_logs","mode":"managed","type":"aws_iam_role_policy","name":"vpc_flow_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"vpc_flow_logs","name_prefix":null,"policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","role":"aws_iam_role.vpc_flow_logs.id"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy_attachment.codedeploy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS","role":"codedeploy"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy_attachment.ecs_task_execution_key_retrieval","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_task_execution_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy","role":"KeyRetrieval"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy_attachment.ecs_task_execution_key_submission","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_task_execution_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy","role":"KeySubmission"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy_attachment.lambda_validate_deploy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole","role":"lambda-validate-deploy"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy_attachment.secrets_manager_key_retrieval","mode":"managed","type":"aws_iam_role_policy_attachment","name":"secrets_manager_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"aws_iam_policy.covidshield_secrets_manager_key_retrieval.arn","role":"KeyRetrieval"},"after_unknown":{"id":true}}},{"address":"aws_iam_role_policy_attachment.secrets_manager_key_submission","mode":"managed","type":"aws_iam_role_policy_attachment","name":"secrets_manager_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"policy_arn":"aws_iam_policy.covidshield_secrets_manager_key_submission.arn","role":"KeySubmission"},"after_unknown":{"id":true}}},{"address":"aws_internet_gateway.covidshield","mode":"managed","type":"aws_internet_gateway","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"tags":{"CostCentre":"CovidShield","Name":"CovidShield"},"tags_all":{"CostCentre":"CovidShield","Name":"CovidShield"},"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_kinesis_firehose_delivery_stream.firehose_waf_logs","mode":"managed","type":"aws_kinesis_firehose_delivery_stream","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"destination":"s3","elasticsearch_configuration":[],"extended_s3_configuration":[],"http_endpoint_configuration":[],"kinesis_source_configuration":[],"name":"aws-waf-logs-covid-shield","redshift_configuration":[],"s3_configuration":[{"bucket_arn":"aws_s3_bucket.firehose_waf_logs.arn","buffer_interval":null,"buffer_size":null,"cloudwatch_logging_options":[],"compression_format":null,"kms_key_arn":null,"prefix":null,"role_arn":"aws_iam_role.firehose_waf_logs.arn"}],"server_side_encryption":[{"enabled":true,"key_arn":null,"key_type":null}],"splunk_configuration":[],"tags":null},"after_unknown":{"arn":true,"destination_id":true,"elasticsearch_configuration":[],"extended_s3_configuration":[],"http_endpoint_configuration":[],"id":true,"kinesis_source_configuration":[],"redshift_configuration":[],"s3_configuration":[{"cloudwatch_logging_options":[]}],"server_side_encryption":[{}],"splunk_configuration":[],"tags_all":true,"version_id":true}}},{"address":"aws_kinesis_firehose_delivery_stream.firehose_waf_logs_us_east","mode":"managed","type":"aws_kinesis_firehose_delivery_stream","name":"firehose_waf_logs_us_east","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"destination":"s3","elasticsearch_configuration":[],"extended_s3_configuration":[],"http_endpoint_configuration":[],"kinesis_source_configuration":[],"name":"aws-waf-logs-covid-shield-us-east","redshift_configuration":[],"s3_configuration":[{"bucket_arn":"aws_s3_bucket.firehose_waf_logs.arn","buffer_interval":null,"buffer_size":null,"cloudwatch_logging_options":[],"compression_format":null,"kms_key_arn":null,"prefix":null,"role_arn":"aws_iam_role.firehose_waf_logs.arn"}],"server_side_encryption":[{"enabled":true,"key_arn":null,"key_type":null}],"splunk_configuration":[],"tags":null},"after_unknown":{"arn":true,"destination_id":true,"elasticsearch_configuration":[],"extended_s3_configuration":[],"http_endpoint_configuration":[],"id":true,"kinesis_source_configuration":[],"redshift_configuration":[],"s3_configuration":[{"cloudwatch_logging_options":[]}],"server_side_encryption":[{}],"splunk_configuration":[],"tags_all":true,"version_id":true}}},{"address":"aws_kms_key.cw","mode":"managed","type":"aws_kms_key","name":"cw","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":null,"description":"CloudWatch Log Group Key","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n  \"Version\" : \"2012-10-17\",\n  \"Id\" : \"key-default-1\",\n  \"Statement\" : [ {\n      \"Sid\" : \"Enable IAM User Permissions\",\n      \"Effect\" : \"Allow\",\n      \"Principal\" : {\n        \"AWS\" : \"arn:aws:iam::115553109071:root\"\n      },\n      \"Action\" : \"kms:*\",\n      \"Resource\" : \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": { \"Service\": \"logs.ca-central-1.amazonaws.com\" },\n      \"Action\": [ \n        \"kms:Encrypt*\",\n        \"kms:Decrypt*\",\n        \"kms:ReEncrypt*\",\n        \"kms:GenerateDataKey*\",\n        \"kms:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Allow_CloudWatch_for_CMK\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n          \"Service\":[\n              \"cloudwatch.amazonaws.com\"\n          ]\n      },\n      \"Action\": [\n          \"kms:Decrypt\",\"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","tags":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"tags_all":true}}},{"address":"aws_kms_key.cw_us_east","mode":"managed","type":"aws_kms_key","name":"cw_us_east","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"customer_master_key_spec":"SYMMETRIC_DEFAULT","deletion_window_in_days":null,"description":"CloudWatch Log Group Key","enable_key_rotation":true,"is_enabled":true,"key_usage":"ENCRYPT_DECRYPT","policy":"{\n  \"Version\" : \"2012-10-17\",\n  \"Id\" : \"key-default-1\",\n  \"Statement\" : [ {\n      \"Sid\" : \"Enable IAM User Permissions\",\n      \"Effect\" : \"Allow\",\n      \"Principal\" : {\n        \"AWS\" : \"arn:aws:iam::115553109071:root\"\n      },\n      \"Action\" : \"kms:*\",\n      \"Resource\" : \"*\"\n    },\n    {\n      \"Effect\": \"Allow\",\n      \"Principal\": { \"Service\": \"logs.us-east-1.amazonaws.com\" },\n      \"Action\": [ \n        \"kms:Encrypt*\",\n        \"kms:Decrypt*\",\n        \"kms:ReEncrypt*\",\n        \"kms:GenerateDataKey*\",\n        \"kms:Describe*\"\n      ],\n      \"Resource\": \"*\"\n    },\n    {\n      \"Sid\": \"Allow_CloudWatch_for_CMK\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n          \"Service\":[\n              \"cloudwatch.amazonaws.com\"\n          ]\n      },\n      \"Action\": [\n          \"kms:Decrypt\",\"kms:GenerateDataKey\"\n      ],\n      \"Resource\": \"*\"\n    }\n  ]\n}\n","tags":null},"after_unknown":{"arn":true,"id":true,"key_id":true,"tags_all":true}}},{"address":"aws_lambda_function.retrieval_lambda_validate_deploy","mode":"managed","type":"aws_lambda_function","name":"retrieval_lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"CLOUDFRONT_CUSTOM_HEADER":"test123","TEST_LB_ENDPOINT":"https://aws_lb.covidshield_key_retrieval.dns_name:8443/services/ping"}}],"file_system_config":[],"filename":"/tmp/lambda_validate_deploy.rb.zip","function_name":"RetrievalValidateBeforeTraffic","handler":"lambda_validate_deploy.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"reserved_concurrent_executions":-1,"role":"aws_iam_role.lambda_validate_deploy.arn","runtime":"ruby2.7","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"jarV4/mad4XdTehS86tGTX/xBKNvpkUHSWcfWLkX06w=","tags":null,"timeout":3,"timeouts":null,"tracing_config":[],"vpc_config":[]},"after_unknown":{"arn":true,"dead_letter_config":[],"environment":[{"variables":{}}],"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"qualified_arn":true,"signing_job_arn":true,"signing_profile_version_arn":true,"source_code_size":true,"tags_all":true,"tracing_config":[],"version":true,"vpc_config":[]}}},{"address":"aws_lambda_function.submission_lambda_validate_deploy","mode":"managed","type":"aws_lambda_function","name":"submission_lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"code_signing_config_arn":null,"dead_letter_config":[],"description":null,"environment":[{"variables":{"TEST_LB_ENDPOINT":"https://aws_lb.covidshield_key_submission.dns_name:8443/services/ping"}}],"file_system_config":[],"filename":"/tmp/lambda_validate_deploy.rb.zip","function_name":"SubmissionValidateBeforeTraffic","handler":"lambda_validate_deploy.handler","image_config":[],"image_uri":null,"kms_key_arn":null,"layers":null,"memory_size":128,"package_type":"Zip","publish":false,"reserved_concurrent_executions":-1,"role":"aws_iam_role.lambda_validate_deploy.arn","runtime":"ruby2.7","s3_bucket":null,"s3_key":null,"s3_object_version":null,"source_code_hash":"jarV4/mad4XdTehS86tGTX/xBKNvpkUHSWcfWLkX06w=","tags":null,"timeout":3,"timeouts":null,"tracing_config":[],"vpc_config":[]},"after_unknown":{"arn":true,"dead_letter_config":[],"environment":[{"variables":{}}],"file_system_config":[],"id":true,"image_config":[],"invoke_arn":true,"last_modified":true,"qualified_arn":true,"signing_job_arn":true,"signing_profile_version_arn":true,"source_code_size":true,"tags_all":true,"tracing_config":[],"version":true,"vpc_config":[]}}},{"address":"aws_lb.covidshield_key_retrieval","mode":"managed","type":"aws_lb","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"access_logs":[],"customer_owned_ipv4_pool":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"idle_timeout":60,"internal":false,"load_balancer_type":"application","name":"covidshield-key-retrieval","name_prefix":null,"security_groups":["aws_security_group.covidshield_load_balancer.id"],"subnet_mapping":[],"subnets":["aws_subnet.covidshield_public[0].id","aws_subnet.covidshield_public[1].id","aws_subnet.covidshield_public[2].id"],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"timeouts":null},"after_unknown":{"access_logs":[],"arn":true,"arn_suffix":true,"dns_name":true,"id":true,"ip_address_type":true,"security_groups":[false],"subnet_mapping":[],"subnets":[false,false,false],"tags":{},"tags_all":{},"vpc_id":true,"zone_id":true}}},{"address":"aws_lb.covidshield_key_submission","mode":"managed","type":"aws_lb","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"access_logs":[],"customer_owned_ipv4_pool":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"idle_timeout":60,"internal":false,"load_balancer_type":"application","name":"covidshield-key-submission","name_prefix":null,"security_groups":["aws_security_group.covidshield_load_balancer.id"],"subnet_mapping":[],"subnets":["aws_subnet.covidshield_public[0].id","aws_subnet.covidshield_public[1].id","aws_subnet.covidshield_public[2].id"],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"timeouts":null},"after_unknown":{"access_logs":[],"arn":true,"arn_suffix":true,"dns_name":true,"id":true,"ip_address_type":true,"security_groups":[false],"subnet_mapping":[],"subnets":[false,false,false],"tags":{},"tags_all":{},"vpc_id":true,"zone_id":true}}},{"address":"aws_lb_listener.covidshield_key_retrieval","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_retrieval.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_retrieval.arn","port":443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"id":true,"tags_all":true}}},{"address":"aws_lb_listener.covidshield_key_retrieval_test","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_retrieval_test","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_retrieval.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_retrieval.arn","port":8443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"id":true,"tags_all":true}}},{"address":"aws_lb_listener.covidshield_key_submission","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_submission.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_submission.arn","port":443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"id":true,"tags_all":true}}},{"address":"aws_lb_listener.covidshield_key_submission_test","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_submission_test","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":"aws_acm_certificate.covidshield.arn","default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":null,"redirect":[],"target_group_arn":"aws_lb_target_group.covidshield_key_submission.arn","type":"forward"}],"load_balancer_arn":"aws_lb.covidshield_key_submission.arn","port":8443,"protocol":"HTTPS","ssl_policy":"ELBSecurityPolicy-FS-1-2-Res-2019-08","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"id":true,"tags_all":true}}},{"address":"aws_lb_target_group.covidshield_key_retrieval","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-retrieval","name_prefix":null,"port":8001,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"arn_suffix":true,"health_check":[{}],"id":true,"load_balancing_algorithm_type":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":[],"tags":{},"tags_all":{}}}},{"address":"aws_lb_target_group.covidshield_key_retrieval_2","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_retrieval_2","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-retrieval-2","name_prefix":null,"port":8001,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval-2"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-retrieval-2"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"arn_suffix":true,"health_check":[{}],"id":true,"load_balancing_algorithm_type":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":[],"tags":{},"tags_all":{}}}},{"address":"aws_lb_target_group.covidshield_key_submission","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-submission","name_prefix":null,"port":8000,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-submission"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"arn_suffix":true,"health_check":[{}],"id":true,"load_balancing_algorithm_type":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":[],"tags":{},"tags_all":{}}}},{"address":"aws_lb_target_group.covidshield_key_submission_2","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_submission_2","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":30,"health_check":[{"enabled":true,"healthy_threshold":2,"interval":10,"matcher":null,"path":"/services/ping","port":null,"protocol":null,"timeout":5,"unhealthy_threshold":2}],"lambda_multi_value_headers_enabled":false,"name":"covidshield-key-submission-2","name_prefix":null,"port":8000,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"stickiness":[],"tags":{"CostCentre":"CovidShield","Name":"covidshield-key-submission-2"},"tags_all":{"CostCentre":"CovidShield","Name":"covidshield-key-submission-2"},"target_type":"ip","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"arn_suffix":true,"health_check":[{}],"id":true,"load_balancing_algorithm_type":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":[],"tags":{},"tags_all":{}}}},{"address":"aws_rds_cluster.covidshield_server","mode":"managed","type":"aws_rds_cluster","name":"covidshield_server","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"allow_major_version_upgrade":null,"backtrack_window":null,"backup_retention_period":1,"cluster_identifier":"server-cluster","copy_tags_to_snapshot":false,"database_name":"server","db_subnet_group_name":"server","deletion_protection":null,"enable_http_endpoint":false,"enabled_cloudwatch_logs_exports":null,"engine":"aurora","engine_mode":"provisioned","final_snapshot_identifier":"server-random_string.random.result","global_cluster_identifier":null,"iam_database_authentication_enabled":null,"master_password":"test","master_username":"root","preferred_backup_window":"07:00-09:00","replication_source_identifier":null,"restore_to_point_in_time":[],"s3_import":[],"scaling_configuration":[],"skip_final_snapshot":false,"snapshot_identifier":null,"source_region":null,"storage_encrypted":true,"tags":{"CostCentre":"CovidShield","Name":"server-cluster"},"tags_all":{"CostCentre":"CovidShield","Name":"server-cluster"},"timeouts":null,"vpc_security_group_ids":["aws_security_group.covidshield_database.id"]},"after_unknown":{"apply_immediately":true,"arn":true,"availability_zones":true,"cluster_identifier_prefix":true,"cluster_members":true,"cluster_resource_id":true,"db_cluster_parameter_group_name":true,"endpoint":true,"engine_version":true,"hosted_zone_id":true,"iam_roles":true,"id":true,"kms_key_id":true,"port":true,"preferred_maintenance_window":true,"reader_endpoint":true,"restore_to_point_in_time":[],"s3_import":[],"scaling_configuration":[],"tags":{},"tags_all":{},"vpc_security_group_ids":[false]}}},{"address":"aws_rds_cluster_instance.covidshield_server_instances[0]","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_minor_version_upgrade":true,"cluster_identifier":"aws_rds_cluster.covidshield_server.id","copy_tags_to_snapshot":false,"db_subnet_group_name":"server","engine":"aurora","identifier":"server-instance-0","instance_class":"db.t3.small","monitoring_interval":0,"performance_insights_enabled":true,"promotion_tier":0,"publicly_accessible":false,"tags":{"CostCentre":"CovidShield","Name":"server-instance"},"tags_all":{"CostCentre":"CovidShield","Name":"server-instance"},"timeouts":null},"after_unknown":{"apply_immediately":true,"arn":true,"availability_zone":true,"ca_cert_identifier":true,"db_parameter_group_name":true,"dbi_resource_id":true,"endpoint":true,"engine_version":true,"id":true,"identifier_prefix":true,"kms_key_id":true,"monitoring_role_arn":true,"performance_insights_kms_key_id":true,"port":true,"preferred_backup_window":true,"preferred_maintenance_window":true,"storage_encrypted":true,"tags":{},"tags_all":{},"writer":true}}},{"address":"aws_rds_cluster_instance.covidshield_server_instances[1]","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_minor_version_upgrade":true,"cluster_identifier":"aws_rds_cluster.covidshield_server.id","copy_tags_to_snapshot":false,"db_subnet_group_name":"server","engine":"aurora","identifier":"server-instance-1","instance_class":"db.t3.small","monitoring_interval":0,"performance_insights_enabled":true,"promotion_tier":0,"publicly_accessible":false,"tags":{"CostCentre":"CovidShield","Name":"server-instance"},"tags_all":{"CostCentre":"CovidShield","Name":"server-instance"},"timeouts":null},"after_unknown":{"apply_immediately":true,"arn":true,"availability_zone":true,"ca_cert_identifier":true,"db_parameter_group_name":true,"dbi_resource_id":true,"endpoint":true,"engine_version":true,"id":true,"identifier_prefix":true,"kms_key_id":true,"monitoring_role_arn":true,"performance_insights_kms_key_id":true,"port":true,"preferred_backup_window":true,"preferred_maintenance_window":true,"storage_encrypted":true,"tags":{},"tags_all":{},"writer":true}}},{"address":"aws_rds_cluster_instance.covidshield_server_instances[2]","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_minor_version_upgrade":true,"cluster_identifier":"aws_rds_cluster.covidshield_server.id","copy_tags_to_snapshot":false,"db_subnet_group_name":"server","engine":"aurora","identifier":"server-instance-2","instance_class":"db.t3.small","monitoring_interval":0,"performance_insights_enabled":true,"promotion_tier":0,"publicly_accessible":false,"tags":{"CostCentre":"CovidShield","Name":"server-instance"},"tags_all":{"CostCentre":"CovidShield","Name":"server-instance"},"timeouts":null},"after_unknown":{"apply_immediately":true,"arn":true,"availability_zone":true,"ca_cert_identifier":true,"db_parameter_group_name":true,"dbi_resource_id":true,"endpoint":true,"engine_version":true,"id":true,"identifier_prefix":true,"kms_key_id":true,"monitoring_role_arn":true,"performance_insights_kms_key_id":true,"port":true,"preferred_backup_window":true,"preferred_maintenance_window":true,"storage_encrypted":true,"tags":{},"tags_all":{},"writer":true}}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"retrieval.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":null,"request_interval":30,"resource_path":"/services/ping","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"},"after_unknown":{"enable_sni":true,"id":true,"tags":{},"tags_all":{}}}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_ca_json","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck_ca_json","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"retrieval.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":["us-east-1","us-west-1","us-west-2"],"request_interval":30,"resource_path":"/exposure-configuration/CA.json","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"},"after_unknown":{"enable_sni":true,"id":true,"regions":[false,false,false],"tags":{},"tags_all":{}}}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_region_json","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck_region_json","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"retrieval.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":["us-east-1","us-west-1","us-west-2"],"request_interval":30,"resource_path":"/exposure-configuration/region.json","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"},"after_unknown":{"enable_sni":true,"id":true,"regions":[false,false,false],"tags":{},"tags_all":{}}}},{"address":"aws_route53_health_check.covidshield_key_submission_healthcheck","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_submission_healthcheck","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"child_health_threshold":null,"child_healthchecks":null,"cloudwatch_alarm_name":null,"cloudwatch_alarm_region":null,"disabled":false,"failure_threshold":3,"fqdn":"submission.test.com","insufficient_data_health_status":null,"invert_healthcheck":null,"ip_address":null,"measure_latency":false,"port":443,"reference_name":null,"regions":null,"request_interval":30,"resource_path":"/services/ping","search_string":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"type":"HTTPS"},"after_unknown":{"enable_sni":true,"id":true,"tags":{},"tags_all":{}}}},{"address":"aws_route53_record.covidshield_certificate_validation[\"*.test.com\"]","mode":"managed","type":"aws_route53_record","name":"covidshield_certificate_validation","index":"*.test.com","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"records":[],"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"},"after_unknown":{"alias":[],"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"name":true,"records":[true],"type":true,"weighted_routing_policy":[]}}},{"address":"aws_route53_record.covidshield_certificate_validation[\"test.com\"]","mode":"managed","type":"aws_route53_record","name":"covidshield_certificate_validation","index":"test.com","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"records":[],"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"},"after_unknown":{"alias":[],"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"name":true,"records":[true],"type":true,"weighted_routing_policy":[]}}},{"address":"aws_route53_record.covidshield_key_retrieval","mode":"managed","type":"aws_route53_record","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[{"evaluate_target_health":false,"name":"aws_cloudfront_distribution.key_retrieval_distribution.domain_name","zone_id":"aws_cloudfront_distribution.key_retrieval_distribution.hosted_zone_id"}],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"name":"retrieval.test.com","records":null,"set_identifier":null,"ttl":null,"type":"A","weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"},"after_unknown":{"alias":[{}],"allow_overwrite":true,"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"weighted_routing_policy":[]}}},{"address":"aws_route53_record.covidshield_key_submission","mode":"managed","type":"aws_route53_record","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[{"evaluate_target_health":false,"name":"aws_lb.covidshield_key_submission.dns_name","zone_id":"aws_lb.covidshield_key_submission.zone_id"}],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"name":"submission.test.com","records":null,"set_identifier":null,"ttl":null,"type":"A","weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"},"after_unknown":{"alias":[{}],"allow_overwrite":true,"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"weighted_routing_policy":[]}}},{"address":"aws_route53_record.retrieval_covidshield_certificate_validation[\"retrieval.test.com\"]","mode":"managed","type":"aws_route53_record","name":"retrieval_covidshield_certificate_validation","index":"retrieval.test.com","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alias":[],"failover_routing_policy":[],"geolocation_routing_policy":[],"health_check_id":null,"latency_routing_policy":[],"multivalue_answer_routing_policy":null,"records":[],"set_identifier":null,"ttl":60,"weighted_routing_policy":[],"zone_id":"aws_route53_zone.covidshield.zone_id"},"after_unknown":{"alias":[],"allow_overwrite":true,"failover_routing_policy":[],"fqdn":true,"geolocation_routing_policy":[],"id":true,"latency_routing_policy":[],"name":true,"records":[true],"type":true,"weighted_routing_policy":[]}}},{"address":"aws_route53_zone.covidshield","mode":"managed","type":"aws_route53_zone","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"comment":"Managed by Terraform","delegation_set_id":null,"force_destroy":false,"name":"test.com","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"vpc":[]},"after_unknown":{"id":true,"name_servers":true,"tags":{},"tags_all":{},"vpc":[],"zone_id":true}}},{"address":"aws_route_table.covidshield_public_subnet","mode":"managed","type":"aws_route_table","name":"covidshield_public_subnet","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"route":[{"carrier_gateway_id":null,"cidr_block":"0.0.0.0/0","destination_prefix_list_id":null,"egress_only_gateway_id":null,"gateway_id":"aws_internet_gateway.covidshield.id","instance_id":null,"ipv6_cidr_block":null,"local_gateway_id":null,"nat_gateway_id":null,"network_interface_id":null,"transit_gateway_id":null,"vpc_endpoint_id":null,"vpc_peering_connection_id":null}],"tags":{"CostCentre":"CovidShield","Name":"Public Subnet Route Table"},"tags_all":{"CostCentre":"CovidShield","Name":"Public Subnet Route Table"},"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"id":true,"owner_id":true,"propagating_vgws":true,"route":[{}],"tags":{},"tags_all":{}}}},{"address":"aws_route_table_association.covidshield[0]","mode":"managed","type":"aws_route_table_association","name":"covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"route_table_id":"aws_route_table.covidshield_public_subnet.id","subnet_id":"aws_subnet.covidshield_public[0].id"},"after_unknown":{"id":true}}},{"address":"aws_route_table_association.covidshield[1]","mode":"managed","type":"aws_route_table_association","name":"covidshield","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"route_table_id":"aws_route_table.covidshield_public_subnet.id","subnet_id":"aws_subnet.covidshield_public[1].id"},"after_unknown":{"id":true}}},{"address":"aws_route_table_association.covidshield[2]","mode":"managed","type":"aws_route_table_association","name":"covidshield","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"gateway_id":null,"route_table_id":"aws_route_table.covidshield_public_subnet.id","subnet_id":"aws_subnet.covidshield_public[2].id"},"after_unknown":{"id":true}}},{"address":"aws_s3_bucket.cloudfront_logs","mode":"managed","type":"aws_s3_bucket","name":"cloudfront_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","bucket":"covid-shield-test-cloudfront-logs","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[{"abort_incomplete_multipart_upload_days":null,"enabled":true,"expiration":[{"date":null,"days":90,"expired_object_delete_marker":null}],"id":null,"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"tags":null,"transition":[]}],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[{"expiration":[{}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}],"logging":[],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}],"tags_all":true,"versioning":[],"website":[],"website_domain":true,"website_endpoint":true}}},{"address":"aws_s3_bucket.exposure_config","mode":"managed","type":"aws_s3_bucket","name":"exposure_config","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","bucket":"covid-shield-exposure-config-test","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[],"logging":[{"target_bucket":"covid-shield-exposure-config-test-logs","target_prefix":null}],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[],"logging":[{}],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}],"tags_all":true,"versioning":[],"website":[],"website_domain":true,"website_endpoint":true}}},{"address":"aws_s3_bucket.exposure_config_logs","mode":"managed","type":"aws_s3_bucket","name":"exposure_config_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"log-delivery-write","bucket":"covid-shield-exposure-config-test-logs","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[{"abort_incomplete_multipart_upload_days":null,"enabled":true,"expiration":[{"date":null,"days":90,"expired_object_delete_marker":null}],"id":null,"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"tags":null,"transition":[]}],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[{"expiration":[{}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}],"logging":[],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}],"tags_all":true,"versioning":[],"website":[],"website_domain":true,"website_endpoint":true}}},{"address":"aws_s3_bucket.firehose_waf_logs","mode":"managed","type":"aws_s3_bucket","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"acl":"private","bucket":"covid-shield-test-waf-logs","bucket_prefix":null,"cors_rule":[],"force_destroy":false,"grant":[],"lifecycle_rule":[{"abort_incomplete_multipart_upload_days":null,"enabled":true,"expiration":[{"date":null,"days":90,"expired_object_delete_marker":null}],"id":null,"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"prefix":null,"tags":null,"transition":[]}],"logging":[],"object_lock_configuration":[],"policy":null,"replication_configuration":[],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"kms_master_key_id":null,"sse_algorithm":"AES256"}],"bucket_key_enabled":null}]}],"tags":null,"versioning":[],"website":[]},"after_unknown":{"acceleration_status":true,"arn":true,"bucket_domain_name":true,"bucket_regional_domain_name":true,"cors_rule":[],"grant":[],"hosted_zone_id":true,"id":true,"lifecycle_rule":[{"expiration":[{}],"noncurrent_version_expiration":[],"noncurrent_version_transition":[],"transition":[]}],"logging":[],"object_lock_configuration":[],"region":true,"replication_configuration":[],"request_payer":true,"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{}]}]}],"tags_all":true,"versioning":[],"website":[],"website_domain":true,"website_endpoint":true}}},{"address":"aws_s3_bucket_policy.exposure_config","mode":"managed","type":"aws_s3_bucket_policy","name":"exposure_config","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"bucket":"aws_s3_bucket.exposure_config.id","policy":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"OnlyCloudfrontReadAccess\",\n      \"Principal\": {\n        \"AWS\": \"aws_cloudfront_origin_access_identity.origin_access_identity.iam_arn\"\n      },\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"s3:GetObject\"\n      ],\n      \"Resource\": \"aws_s3_bucket.exposure_config.arn/*\"\n    }\n  ]\n}\n"},"after_unknown":{"id":true}}},{"address":"aws_s3_bucket_public_access_block.cloudfront_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"cloudfront_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"bucket":"aws_s3_bucket.cloudfront_logs.id","ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"id":true}}},{"address":"aws_s3_bucket_public_access_block.exposure_config_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"exposure_config_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"bucket":"aws_s3_bucket.exposure_config_logs.id","ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"id":true}}},{"address":"aws_s3_bucket_public_access_block.firehose_waf_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_public_acls":true,"block_public_policy":true,"bucket":"aws_s3_bucket.firehose_waf_logs.id","ignore_public_acls":true,"restrict_public_buckets":true},"after_unknown":{"id":true}}},{"address":"aws_secretsmanager_secret.key_retrieval_env_ecdsa_key","mode":"managed","type":"aws_secretsmanager_secret","name":"key_retrieval_env_ecdsa_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"kms_key_id":null,"name":"key-retrieval-env-ecdsa-key-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"rotation_enabled":true,"rotation_lambda_arn":true,"rotation_rules":[],"tags_all":true}}},{"address":"aws_secretsmanager_secret.key_retrieval_env_hmac_key","mode":"managed","type":"aws_secretsmanager_secret","name":"key_retrieval_env_hmac_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"kms_key_id":null,"name":"key-retrieval-env-hmac-key-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"rotation_enabled":true,"rotation_lambda_arn":true,"rotation_rules":[],"tags_all":true}}},{"address":"aws_secretsmanager_secret.key_submission_env_key_claim_token","mode":"managed","type":"aws_secretsmanager_secret","name":"key_submission_env_key_claim_token","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"kms_key_id":null,"name":"key-submission-env-key-claim-token-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"rotation_enabled":true,"rotation_lambda_arn":true,"rotation_rules":[],"tags_all":true}}},{"address":"aws_secretsmanager_secret.key_submission_metrics_password","mode":"managed","type":"aws_secretsmanager_secret","name":"key_submission_metrics_password","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"kms_key_id":null,"name":"key-metric-password-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"rotation_enabled":true,"rotation_lambda_arn":true,"rotation_rules":[],"tags_all":true}}},{"address":"aws_secretsmanager_secret.server_database_url","mode":"managed","type":"aws_secretsmanager_secret","name":"server_database_url","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":null,"kms_key_id":null,"name":"server-database-url-random_string.random.result","recovery_window_in_days":30,"rotation_rules":[],"tags":null},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"policy":true,"rotation_enabled":true,"rotation_lambda_arn":true,"rotation_rules":[],"tags_all":true}}},{"address":"aws_secretsmanager_secret_version.key_retrieval_env_ecdsa_key","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_retrieval_env_ecdsa_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_retrieval_env_ecdsa_key.id","secret_string":"test123"},"after_unknown":{"arn":true,"id":true,"version_id":true,"version_stages":true}}},{"address":"aws_secretsmanager_secret_version.key_retrieval_env_hmac_key","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_retrieval_env_hmac_key","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_retrieval_env_hmac_key.id","secret_string":"test123"},"after_unknown":{"arn":true,"id":true,"version_id":true,"version_stages":true}}},{"address":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_submission_env_key_claim_token","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_submission_env_key_claim_token.id","secret_string":"test123"},"after_unknown":{"arn":true,"id":true,"version_id":true,"version_stages":true}}},{"address":"aws_secretsmanager_secret_version.key_submission_metrics_password","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_submission_metrics_password","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.key_submission_metrics_password.id","secret_string":"test"},"after_unknown":{"arn":true,"id":true,"version_id":true,"version_stages":true}}},{"address":"aws_secretsmanager_secret_version.server_database_url","mode":"managed","type":"aws_secretsmanager_secret_version","name":"server_database_url","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"secret_binary":null,"secret_id":"aws_secretsmanager_secret.server_database_url.id","secret_string":"root:test@tcp(aws_rds_cluster.covidshield_server.endpoint)/server"},"after_unknown":{"arn":true,"id":true,"version_id":true,"version_stages":true}}},{"address":"aws_security_group.covidshield_database","mode":"managed","type":"aws_security_group","name":"covidshield_database","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Ingress - CovidShield Database","ingress":[{"cidr_blocks":null,"description":null,"from_port":3306,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":["aws_security_group.covidshield_key_retrieval.id","aws_security_group.covidshield_key_submission.id"],"self":null,"to_port":3306}],"name":"covidshield-database","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":[{"security_groups":[false,false]}],"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_security_group.covidshield_key_retrieval","mode":"managed","type":"aws_security_group","name":"covidshield_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Ingress - CovidShield Key Retrieval App","name":"covidshield-key-retrieval","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":true,"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_security_group.covidshield_key_submission","mode":"managed","type":"aws_security_group","name":"covidshield_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Ingress - CovidShield Key Submission App","name":"covidshield-key-submission","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":true,"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_security_group.covidshield_load_balancer","mode":"managed","type":"aws_security_group","name":"covidshield_load_balancer","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Ingress - CovidShield Load Balancer","egress":[{"cidr_blocks":["10.0.0.0/24"],"description":"retrieval target ca-central-1a","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.0.0/24"],"description":"submission target ca-central-1a","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.1.0/24"],"description":"retrieval target ca-central-1b","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.1.0/24"],"description":"submission target ca-central-1b","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.2.0/24"],"description":"retrieval target ca-central-1d","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.2.0/24"],"description":"submission target ca-central-1d","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000}],"ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443},{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":8443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8443}],"name":"covidshield-load-balancer","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"egress":[{"cidr_blocks":[false]},{"cidr_blocks":[false]},{"cidr_blocks":[false]},{"cidr_blocks":[false]},{"cidr_blocks":[false]},{"cidr_blocks":[false]}],"id":true,"ingress":[{"cidr_blocks":[false]},{"cidr_blocks":[false]}],"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_security_group.covidshield_redis[0]","mode":"managed","type":"aws_security_group","name":"covidshield_redis","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"Ingress - CovidShield Redis","ingress":[{"cidr_blocks":null,"description":null,"from_port":6379,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":["aws_security_group.covidshield_key_retrieval.id","aws_security_group.covidshield_key_submission.id"],"self":null,"to_port":6379}],"name":"covidshield-redis","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":[{"security_groups":[false,false]}],"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_security_group.privatelink","mode":"managed","type":"aws_security_group","name":"privatelink","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"description":"privatelink endpoints","name":"privatelink","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"egress":true,"id":true,"ingress":true,"name_prefix":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_database","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_database","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Retrieval DB egress through privatelink","from_port":3306,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.covidshield_database.id","to_port":3306,"type":"egress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Retrieval egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.privatelink.id","to_port":443,"type":"egress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_redis[0]","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_redis","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Retrieval Redis egress through privatelink","from_port":6379,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.covidshield_redis[0].id","to_port":6379,"type":"egress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_s3_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_s3_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Retrieval S3 egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":["aws_vpc_endpoint.s3.prefix_list_id"],"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"to_port":443,"type":"egress"},"after_unknown":{"id":true,"prefix_list_ids":[false],"source_security_group_id":true}}},{"address":"aws_security_group_rule.covidshield_key_retrieval_ingress_alb","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_ingress_alb","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Retrieval Ingress ALB","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_retrieval.id","self":false,"source_security_group_id":"aws_security_group.covidshield_load_balancer.id","to_port":8001,"type":"ingress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_database","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_database","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Submission DB egress through privatelink","from_port":3306,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.covidshield_database.id","to_port":3306,"type":"egress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Submission egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.privatelink.id","to_port":443,"type":"egress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_redis[0]","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_redis","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Submission Redis egress through privatelink","from_port":6379,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.covidshield_redis[0].id","to_port":6379,"type":"egress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_s3_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_s3_privatelink","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Submission S3 egress through privatelink","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":["aws_vpc_endpoint.s3.prefix_list_id"],"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"to_port":443,"type":"egress"},"after_unknown":{"id":true,"prefix_list_ids":[false],"source_security_group_id":true}}},{"address":"aws_security_group_rule.covidshield_key_submission_ingress_alb","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_ingress_alb","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Submission ingress","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.covidshield_key_submission.id","self":false,"source_security_group_id":"aws_security_group.covidshield_load_balancer.id","to_port":8000,"type":"ingress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.privatelink_retrieval_ingress","mode":"managed","type":"aws_security_group_rule","name":"privatelink_retrieval_ingress","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Retrieval ingress","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.privatelink.id","self":false,"source_security_group_id":"aws_security_group.covidshield_key_retrieval.id","to_port":443,"type":"ingress"},"after_unknown":{"id":true}}},{"address":"aws_security_group_rule.privatelink_submission_ingress","mode":"managed","type":"aws_security_group_rule","name":"privatelink_submission_ingress","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"cidr_blocks":null,"description":"Security group rule for Submission ingressk","from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_group_id":"aws_security_group.privatelink.id","self":false,"source_security_group_id":"aws_security_group.covidshield_key_submission.id","to_port":443,"type":"ingress"},"after_unknown":{"id":true}}},{"address":"aws_shield_protection.alb_covidshield_key_retrieval[0]","mode":"managed","type":"aws_shield_protection","name":"alb_covidshield_key_retrieval","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"alb_covidshield_key_retrieval","resource_arn":"aws_lb.covidshield_key_retrieval.arn","tags":null},"after_unknown":{"arn":true,"id":true,"tags_all":true}}},{"address":"aws_shield_protection.alb_covidshield_key_submission[0]","mode":"managed","type":"aws_shield_protection","name":"alb_covidshield_key_submission","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"alb_covidshield_key_submission","resource_arn":"aws_lb.covidshield_key_submission.arn","tags":null},"after_unknown":{"arn":true,"id":true,"tags_all":true}}},{"address":"aws_shield_protection.key_retrieval_distribution[0]","mode":"managed","type":"aws_shield_protection","name":"key_retrieval_distribution","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"key_retrieval_distribution","resource_arn":"aws_cloudfront_distribution.key_retrieval_distribution.arn","tags":null},"after_unknown":{"arn":true,"id":true,"tags_all":true}}},{"address":"aws_shield_protection.route53_covidshield[0]","mode":"managed","type":"aws_shield_protection","name":"route53_covidshield","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"name":"route53_covidshield","resource_arn":"arn:aws:route53:::hostedzone/aws_route53_zone.covidshield.zone_id","tags":null},"after_unknown":{"arn":true,"id":true,"tags_all":true}}},{"address":"aws_sns_topic.alert_critical","mode":"managed","type":"aws_sns_topic","name":"alert_critical","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-critical","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"owner":true,"policy":true,"tags":{},"tags_all":{}}}},{"address":"aws_sns_topic.alert_critical_us_east","mode":"managed","type":"aws_sns_topic","name":"alert_critical_us_east","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw_us_east.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-critical","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"owner":true,"policy":true,"tags":{},"tags_all":{}}}},{"address":"aws_sns_topic.alert_warning","mode":"managed","type":"aws_sns_topic","name":"alert_warning","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-warning","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"owner":true,"policy":true,"tags":{},"tags_all":{}}}},{"address":"aws_sns_topic.alert_warning_us_east","mode":"managed","type":"aws_sns_topic","name":"alert_warning_us_east","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"application_failure_feedback_role_arn":null,"application_success_feedback_role_arn":null,"application_success_feedback_sample_rate":null,"content_based_deduplication":false,"delivery_policy":null,"display_name":null,"fifo_topic":false,"firehose_failure_feedback_role_arn":null,"firehose_success_feedback_role_arn":null,"firehose_success_feedback_sample_rate":null,"http_failure_feedback_role_arn":null,"http_success_feedback_role_arn":null,"http_success_feedback_sample_rate":null,"kms_master_key_id":"aws_kms_key.cw_us_east.arn","lambda_failure_feedback_role_arn":null,"lambda_success_feedback_role_arn":null,"lambda_success_feedback_sample_rate":null,"name":"alert-warning","sqs_failure_feedback_role_arn":null,"sqs_success_feedback_role_arn":null,"sqs_success_feedback_sample_rate":null,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":{"arn":true,"id":true,"name_prefix":true,"owner":true,"policy":true,"tags":{},"tags_all":{}}}},{"address":"aws_subnet.covidshield_private[0]","mode":"managed","type":"aws_subnet","name":"covidshield_private","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1a","cidr_block":"10.0.0.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 01"},"tags_all":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 01"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_subnet.covidshield_private[1]","mode":"managed","type":"aws_subnet","name":"covidshield_private","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1b","cidr_block":"10.0.1.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 02"},"tags_all":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 02"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_subnet.covidshield_private[2]","mode":"managed","type":"aws_subnet","name":"covidshield_private","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1d","cidr_block":"10.0.2.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 03"},"tags_all":{"Access":"private","CostCentre":"CovidShield","Name":"Private Subnet 03"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_subnet.covidshield_public[0]","mode":"managed","type":"aws_subnet","name":"covidshield_public","index":0,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1a","cidr_block":"10.0.3.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 01"},"tags_all":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 01"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_subnet.covidshield_public[1]","mode":"managed","type":"aws_subnet","name":"covidshield_public","index":1,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1b","cidr_block":"10.0.4.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 02"},"tags_all":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 02"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_subnet.covidshield_public[2]","mode":"managed","type":"aws_subnet","name":"covidshield_public","index":2,"provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_ipv6_address_on_creation":false,"availability_zone":"ca-central-1d","cidr_block":"10.0.5.0/24","customer_owned_ipv4_pool":null,"ipv6_cidr_block":null,"map_customer_owned_ip_on_launch":null,"map_public_ip_on_launch":false,"outpost_arn":null,"tags":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 03"},"tags_all":{"Access":"public","CostCentre":"CovidShield","Name":"Public Subnet 03"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"availability_zone_id":true,"id":true,"ipv6_cidr_block_association_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_vpc.covidshield","mode":"managed","type":"aws_vpc","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"assign_generated_ipv6_cidr_block":false,"cidr_block":"10.0.0.0/16","enable_dns_hostnames":true,"enable_dns_support":true,"instance_tenancy":"default","tags":{"CostCentre":"CovidShield","Name":"CovidShield"},"tags_all":{"CostCentre":"CovidShield","Name":"CovidShield"}},"after_unknown":{"arn":true,"default_network_acl_id":true,"default_route_table_id":true,"default_security_group_id":true,"dhcp_options_id":true,"enable_classiclink":true,"enable_classiclink_dns_support":true,"id":true,"ipv6_association_id":true,"ipv6_cidr_block":true,"main_route_table_id":true,"owner_id":true,"tags":{},"tags_all":{}}}},{"address":"aws_vpc_endpoint.ecr-api","mode":"managed","type":"aws_vpc_endpoint","name":"ecr-api","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.ecr.api","tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":[false],"state":true,"subnet_ids":true,"tags_all":true}}},{"address":"aws_vpc_endpoint.ecr-dkr","mode":"managed","type":"aws_vpc_endpoint","name":"ecr-dkr","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.ecr.dkr","tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":[false],"state":true,"subnet_ids":true,"tags_all":true}}},{"address":"aws_vpc_endpoint.kms","mode":"managed","type":"aws_vpc_endpoint","name":"kms","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.kms","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":[false],"state":true,"subnet_ids":[false,false,false],"tags_all":true}}},{"address":"aws_vpc_endpoint.logs","mode":"managed","type":"aws_vpc_endpoint","name":"logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.logs","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":[false],"state":true,"subnet_ids":[false,false,false],"tags_all":true}}},{"address":"aws_vpc_endpoint.monitoring","mode":"managed","type":"aws_vpc_endpoint","name":"monitoring","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.monitoring","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":[false],"state":true,"subnet_ids":[false,false,false],"tags_all":true}}},{"address":"aws_vpc_endpoint.s3","mode":"managed","type":"aws_vpc_endpoint","name":"s3","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":false,"route_table_ids":["aws_vpc.covidshield.main_route_table_id"],"service_name":"com.amazonaws.ca-central-1.s3","tags":null,"timeouts":null,"vpc_endpoint_type":"Gateway","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":[false],"security_group_ids":true,"state":true,"subnet_ids":true,"tags_all":true}}},{"address":"aws_vpc_endpoint.secretsmanager","mode":"managed","type":"aws_vpc_endpoint","name":"secretsmanager","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"auto_accept":null,"private_dns_enabled":true,"security_group_ids":["aws_security_group.privatelink.id"],"service_name":"com.amazonaws.ca-central-1.secretsmanager","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":null,"timeouts":null,"vpc_endpoint_type":"Interface","vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"arn":true,"cidr_blocks":true,"dns_entry":true,"id":true,"network_interface_ids":true,"owner_id":true,"policy":true,"prefix_list_id":true,"requester_managed":true,"route_table_ids":true,"security_group_ids":[false],"state":true,"subnet_ids":[false,false,false],"tags_all":true}}},{"address":"aws_wafv2_ip_set.new_key_claim","mode":"managed","type":"aws_wafv2_ip_set","name":"new_key_claim","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"addresses":["0.0.0.0/1","128.0.0.0/1"],"description":"New Key Claim Allow IPs/CIDRs","ip_address_version":"IPV4","name":"new-key-claim","scope":"REGIONAL","tags":null},"after_unknown":{"addresses":[false,false],"arn":true,"id":true,"lock_token":true,"tags_all":true}}},{"address":"aws_wafv2_web_acl.key_retrieval","mode":"managed","type":"aws_wafv2_web_acl","name":"key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":null,"name":"key_retrieval","rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"CloudFrontCustomHeader","override_action":[],"priority":201,"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"covidshield"}],"single_query_argument":[],"uri_path":[]}],"positional_constraint":"EXACTLY","search_string":"test123","text_transformation":[{"priority":1,"type":"NONE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"CloudFrontCustomHeader","sampled_requests_enabled":false}]}],"scope":"REGIONAL","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"CloudFrontCustomHeader","sampled_requests_enabled":false}]},"after_unknown":{"arn":true,"capacity":true,"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"id":true,"lock_token":true,"rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_path":[]}],"text_transformation":[{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}},{"address":"aws_wafv2_web_acl.key_retrieval_cdn","mode":"managed","type":"aws_wafv2_web_acl","name":"key_retrieval_cdn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"description":null,"name":"key_retrieval_cdn","rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeyRetrievalRateLimit","override_action":[],"priority":101,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":10000,"scope_down_statement":[]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeyRetrievalRateLimit","sampled_requests_enabled":true}]}],"scope":"CLOUDFRONT","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"key_retrieval_cdn","sampled_requests_enabled":false}]},"after_unknown":{"arn":true,"capacity":true,"default_action":[{"allow":[{"custom_request_handling":[]}],"block":[]}],"id":true,"lock_token":true,"rule":[{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"forwarded_ip_config":[],"scope_down_statement":[]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}},{"address":"aws_wafv2_web_acl.key_submission","mode":"managed","type":"aws_wafv2_web_acl","name":"key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"description":null,"name":"key_submission","rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"ClearKeysURI","override_action":[],"priority":202,"statement":[{"and_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"STARTS_WITH","search_string":"/clear-diagnosis-keys","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"authorization"}],"single_query_argument":[],"uri_path":[]}],"positional_constraint":"STARTS_WITH","search_string":"Bearer","text_transformation":[{"priority":1,"type":"NONE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[{"arn":"aws_wafv2_ip_set.new_key_claim.arn","ip_set_forwarded_ip_config":[]}],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"ClearKeysURI","sampled_requests_enabled":false}]},{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"KeySubmissionURIs","override_action":[],"priority":200,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"STARTS_WITH","search_string":"/services/","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/upload","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionURIs","sampled_requests_enabled":false}]},{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"name":"NewKeyClaimURI","override_action":[],"priority":201,"statement":[{"and_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"STARTS_WITH","search_string":"/new-key-claim","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"authorization"}],"single_query_argument":[],"uri_path":[]}],"positional_constraint":"STARTS_WITH","search_string":"Bearer","text_transformation":[{"priority":1,"type":"NONE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[{"arn":"aws_wafv2_ip_set.new_key_claim.arn","ip_set_forwarded_ip_config":[]}],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"NewKeyClaimURI","sampled_requests_enabled":false}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit01","override_action":[],"priority":101,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit01","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit02","override_action":[],"priority":102,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit02","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit03","override_action":[],"priority":103,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit03","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit04","override_action":[],"priority":104,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit04","sampled_requests_enabled":true}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"name":"KeySubmissionClaimKeyURIRateLimit05","override_action":[],"priority":105,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"aggregate_key_type":"IP","forwarded_ip_config":[],"limit":100,"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"positional_constraint":"EXACTLY","search_string":"/claim-key","text_transformation":[{"priority":1,"type":"COMPRESS_WHITE_SPACE"},{"priority":2,"type":"LOWERCASE"}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"KeySubmissionClaimKeyURIRateLimit05","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesAmazonIpReputationList","override_action":[{"count":[],"none":[{}]}],"priority":1,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesAmazonIpReputationList","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesAmazonIpReputationList","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesCommonRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":2,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesCommonRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesCommonRuleSet","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":3,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesKnownBadInputsRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesKnownBadInputsRuleSet","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesLinuxRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":4,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesLinuxRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesLinuxRuleSet","sampled_requests_enabled":true}]},{"action":[],"name":"AWSManagedRulesSQLiRuleSet","override_action":[{"count":[],"none":[{}]}],"priority":5,"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[],"name":"AWSManagedRulesSQLiRuleSet","vendor_name":"AWS"}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"AWSManagedRulesSQLiRuleSet","sampled_requests_enabled":true}]}],"scope":"REGIONAL","tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"visibility_config":[{"cloudwatch_metrics_enabled":true,"metric_name":"key_submission","sampled_requests_enabled":false}]},"after_unknown":{"arn":true,"capacity":true,"default_action":[{"allow":[],"block":[{"custom_response":[]}]}],"id":true,"lock_token":true,"rule":[{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"override_action":[],"statement":[{"and_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_path":[]}],"text_transformation":[{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[{"ip_set_forwarded_ip_config":[]}],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[{"custom_request_handling":[]}],"block":[],"count":[]}],"override_action":[],"statement":[{"and_statement":[{"statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_path":[]}],"text_transformation":[{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]},{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[{"ip_set_forwarded_ip_config":[]}],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"forwarded_ip_config":[],"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"forwarded_ip_config":[],"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"forwarded_ip_config":[],"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"forwarded_ip_config":[],"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[{"allow":[],"block":[{"custom_response":[]}],"count":[]}],"override_action":[],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[],"not_statement":[],"or_statement":[],"rate_based_statement":[{"forwarded_ip_config":[],"scope_down_statement":[{"and_statement":[],"byte_match_statement":[{"field_to_match":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[],"single_query_argument":[],"uri_path":[{}]}],"text_transformation":[{},{}]}],"geo_match_statement":[],"ip_set_reference_statement":[],"not_statement":[],"or_statement":[],"regex_pattern_set_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}]}],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"override_action":[{"count":[],"none":[{}]}],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"override_action":[{"count":[],"none":[{}]}],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"override_action":[{"count":[],"none":[{}]}],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"override_action":[{"count":[],"none":[{}]}],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]},{"action":[],"override_action":[{"count":[],"none":[{}]}],"statement":[{"and_statement":[],"byte_match_statement":[],"geo_match_statement":[],"ip_set_reference_statement":[],"managed_rule_group_statement":[{"excluded_rule":[]}],"not_statement":[],"or_statement":[],"rate_based_statement":[],"regex_pattern_set_reference_statement":[],"rule_group_reference_statement":[],"size_constraint_statement":[],"sqli_match_statement":[],"xss_match_statement":[]}],"visibility_config":[{}]}],"tags":{},"tags_all":{},"visibility_config":[{}]}}},{"address":"aws_wafv2_web_acl_association.key_retrieval_assocation","mode":"managed","type":"aws_wafv2_web_acl_association","name":"key_retrieval_assocation","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"resource_arn":"aws_lb.covidshield_key_retrieval.arn","web_acl_arn":"aws_wafv2_web_acl.key_retrieval.arn"},"after_unknown":{"id":true}}},{"address":"aws_wafv2_web_acl_association.key_submission_assocation","mode":"managed","type":"aws_wafv2_web_acl_association","name":"key_submission_assocation","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"resource_arn":"aws_lb.covidshield_key_submission.arn","web_acl_arn":"aws_wafv2_web_acl.key_submission.arn"},"after_unknown":{"id":true}}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_destination_configs":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs.arn"],"logging_filter":[],"redacted_fields":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{"name":"authorization"}],"single_query_argument":[],"uri_path":[]}],"resource_arn":"aws_wafv2_web_acl.key_submission.arn"},"after_unknown":{"id":true,"log_destination_configs":[false],"logging_filter":[],"redacted_fields":[{"all_query_arguments":[],"body":[],"method":[],"query_string":[],"single_header":[{}],"single_query_argument":[],"uri_path":[]}]}}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs_retrieval","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_destination_configs":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs.arn"],"logging_filter":[],"redacted_fields":[],"resource_arn":"aws_wafv2_web_acl.key_retrieval.arn"},"after_unknown":{"id":true,"log_destination_configs":[false],"logging_filter":[],"redacted_fields":[]}}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs_retrieval_cdn","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs_retrieval_cdn","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"log_destination_configs":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs_us_east.arn"],"logging_filter":[],"redacted_fields":[],"resource_arn":"aws_wafv2_web_acl.key_retrieval_cdn.arn"},"after_unknown":{"id":true,"log_destination_configs":[false],"logging_filter":[],"redacted_fields":[]}}},{"address":"data.aws_iam_policy_document.covidshield_secrets_manager_key_retrieval","mode":"data","type":"aws_iam_policy_document","name":"covidshield_secrets_manager_key_retrieval","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["secretsmanager:GetSecretValue"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["aws_secretsmanager_secret.key_retrieval_env_ecdsa_key.arn","aws_secretsmanager_secret.key_retrieval_env_hmac_key.arn","aws_secretsmanager_secret.key_submission_env_key_claim_token.arn","aws_secretsmanager_secret.key_submission_metrics_password.arn","aws_secretsmanager_secret.server_database_url.arn"],"sid":null}],"version":null},"after_unknown":{"id":true,"json":true,"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[],"resources":[false,false,false,false,false]}]}}},{"address":"data.aws_iam_policy_document.covidshield_secrets_manager_key_submission","mode":"data","type":"aws_iam_policy_document","name":"covidshield_secrets_manager_key_submission","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["secretsmanager:GetSecretValue"],"condition":[],"effect":"Allow","not_actions":null,"not_principals":[],"not_resources":null,"principals":[],"resources":["aws_secretsmanager_secret.key_submission_env_key_claim_token.arn","aws_secretsmanager_secret.server_database_url.arn"],"sid":null}],"version":null},"after_unknown":{"id":true,"json":true,"statement":[{"actions":[false],"condition":[],"not_principals":[],"principals":[],"resources":[false,false]}]}}},{"address":"data.aws_subnet_ids.ecr_endpoint_available","mode":"data","type":"aws_subnet_ids","name":"ecr_endpoint_available","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["read"],"before":null,"after":{"filter":[{"name":"availability-zone","values":["ca-central-1a","ca-central-1b"]},{"name":"tag:Access","values":["private"]}],"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":{"filter":[{"values":[false,false]},{"values":[false]}],"id":true,"ids":true,"tags":true}}},{"address":"data.template_file.covidshield_key_retrieval_task","mode":"data","type":"template_file","name":"covidshield_key_retrieval_task","provider_name":"registry.terraform.io/hashicorp/template","change":{"actions":["read"],"before":null,"after":{"filename":null,"template":"[\n    {\n      \"name\": \"key-retrieval\",\n      \"image\": \"${image}\",\n      \"portMappings\": [\n        {\n          \"containerPort\": 8001\n        }\n      ],\n      \"linuxParameters\": {\n        \"capabilities\": {\n          \"drop\": [\"ALL\"]\n        }\n      },\n      \"logConfiguration\": {\n        \"logDriver\": \"awslogs\",\n        \"options\": {\n          \"awslogs-group\": \"${awslogs-group}\",\n          \"awslogs-region\": \"${awslogs-region}\",\n          \"awslogs-stream-prefix\": \"${awslogs-stream-prefix}\"\n        }\n      },\n      \"environment\": [\n        {\n          \"name\": \"METRIC_PROVIDER\",\n          \"value\": \"${metric_provider}\"\n        },\n        {\n          \"name\": \"TRACER_PROVIDER\",\n          \"value\": \"${tracer_provider}\"\n        },\n        {\n          \"name\": \"ENV\",\n          \"value\": \"${env}\"\n        },\n        {\n          \"name\": \"METRICS_USERNAME\",\n          \"value\": \"${metrics_username}\"\n        }\n      ],\n      \"secrets\": [\n        {\n          \"name\": \"KEY_CLAIM_TOKEN\",\n          \"valueFrom\": \"${key_claim_token}\"\n        },\n        {\n          \"name\": \"RETRIEVE_HMAC_KEY\",\n          \"valueFrom\": \"${retrieve_hmac_key}\"\n        },\n        {\n          \"name\": \"ECDSA_KEY\",\n          \"valueFrom\": \"${ecdsa_key}\"\n        },\n        {\n          \"name\": \"DATABASE_URL\",\n          \"valueFrom\": \"${database_url}\"\n        },\n        {\n          \"name\": \"METRICS_PASSWORD\",\n          \"valueFrom\": \"${metrics_password}\"\n        }\n      ]\n    }\n  ]\n","vars":{"awslogs-group":"CovidShield","awslogs-region":"ca-central-1","awslogs-stream-prefix":"ecs-KeyRetrieval","database_url":"aws_secretsmanager_secret_version.server_database_url.arn","ecdsa_key":"aws_secretsmanager_secret_version.key_retrieval_env_ecdsa_key.arn","env":"test","image":"aws_ecr_repository.repository[key-retrieval].repository_url","key_claim_token":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token.arn","metric_provider":"stdout","metrics_password":"aws_secretsmanager_secret_version.key_submission_metrics_password.arn","metrics_username":"test","retrieve_hmac_key":"aws_secretsmanager_secret_version.key_retrieval_env_hmac_key.arn","tracer_provider":"stdout"}},"after_unknown":{"id":true,"rendered":true,"vars":{}}}},{"address":"data.template_file.covidshield_key_submission_task","mode":"data","type":"template_file","name":"covidshield_key_submission_task","provider_name":"registry.terraform.io/hashicorp/template","change":{"actions":["read"],"before":null,"after":{"filename":null,"template":"[\n    {\n      \"name\": \"key-submission\",\n      \"image\": \"${image}\",\n      \"portMappings\": [\n        {\n          \"containerPort\": 8000\n        }\n      ],\n      \"ulimits\": [\n          {\n            \"name\": \"nofile\",\n            \"softLimit\": 1000000,\n            \"hardLimit\": 1000000\n          }\n      ],\n      \"linuxParameters\": {\n        \"capabilities\": {\n          \"drop\": [\"ALL\"]\n        }\n      },\n      \"logConfiguration\": {\n        \"logDriver\": \"awslogs\",\n        \"options\": {\n          \"awslogs-group\": \"${awslogs-group}\",\n          \"awslogs-region\": \"${awslogs-region}\",\n          \"awslogs-stream-prefix\": \"${awslogs-stream-prefix}\"\n        }\n      },\n      \"environment\": [\n        {\n            \"name\": \"METRIC_PROVIDER\",\n            \"value\": \"${metric_provider}\"\n        },\n        {\n          \"name\": \"TRACER_PROVIDER\",\n          \"value\": \"${tracer_provider}\"\n        },\n        {\n          \"name\": \"ENV\",\n          \"value\": \"${env}\"\n        },\n        {\n          \"name\": \"ENABLE_TEST_TOOLS\",\n          \"value\": \"${enable_test_tools}\"\n        }\n      ],\n      \"secrets\": [\n        {\n          \"name\": \"KEY_CLAIM_TOKEN\",\n          \"valueFrom\": \"${key_claim_token}\"\n        },\n        {\n          \"name\": \"DATABASE_URL\",\n          \"valueFrom\": \"${database_url}\"\n        }\n      ]\n    }\n  ]\n","vars":{"awslogs-group":"CovidShield","awslogs-region":"ca-central-1","awslogs-stream-prefix":"ecs-KeySubmission","database_url":"aws_secretsmanager_secret_version.server_database_url.arn","enable_test_tools":"true","env":"test","image":"aws_ecr_repository.repository[key-submission].repository_url","key_claim_token":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token.arn","metric_provider":"stdout","tracer_provider":"stdout"}},"after_unknown":{"id":true,"rendered":true,"vars":{}}}},{"address":"module.covid-shield-retrieval.aws_codedeploy_app.app","module_address":"module.covid-shield-retrieval","mode":"managed","type":"aws_codedeploy_app","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"compute_platform":"ECS","name":"AppECS-CovidShield-KeyRetrieval","tags":null},"after_unknown":{"application_id":true,"arn":true,"github_account_name":true,"id":true,"linked_to_github":true,"tags_all":true}}},{"address":"module.covid-shield-retrieval.aws_codedeploy_deployment_group.app","module_address":"module.covid-shield-retrieval","mode":"managed","type":"aws_codedeploy_deployment_group","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alarm_configuration":[],"app_name":"AppECS-CovidShield-KeyRetrieval","auto_rollback_configuration":[{"enabled":true,"events":["DEPLOYMENT_FAILURE"]}],"autoscaling_groups":null,"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":"CONTINUE_DEPLOYMENT","wait_time_in_minutes":null}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{"action":"TERMINATE","termination_wait_time_in_minutes":1}]}],"deployment_config_name":"CodeDeployDefault.ECSAllAtOnce","deployment_group_name":"DgpECS-CovidShield-KeyRetrieval","deployment_style":[{"deployment_option":"WITH_TRAFFIC_CONTROL","deployment_type":"BLUE_GREEN"}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{"cluster_name":"CovidShield","service_name":"KeyRetrieval"}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_retrieval.arn"]}],"target_group":[{"name":"covidshield-key-retrieval"},{"name":"covidshield-key-retrieval-2"}],"test_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_retrieval_test.arn"]}]}]}],"on_premises_instance_tag_filter":[],"service_role_arn":"aws_iam_role.codedeploy.arn","tags":null,"trigger_configuration":[]},"after_unknown":{"alarm_configuration":[],"arn":true,"auto_rollback_configuration":[{"events":[false]}],"blue_green_deployment_config":[{"deployment_ready_option":[{}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{}]}],"compute_platform":true,"deployment_group_id":true,"deployment_style":[{}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{}],"id":true,"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":[false]}],"target_group":[{},{}],"test_traffic_route":[{"listener_arns":[false]}]}]}],"on_premises_instance_tag_filter":[],"tags_all":true,"trigger_configuration":[]}}},{"address":"module.covid-shield-submission.aws_codedeploy_app.app","module_address":"module.covid-shield-submission","mode":"managed","type":"aws_codedeploy_app","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"compute_platform":"ECS","name":"AppECS-CovidShield-KeySubmission","tags":null},"after_unknown":{"application_id":true,"arn":true,"github_account_name":true,"id":true,"linked_to_github":true,"tags_all":true}}},{"address":"module.covid-shield-submission.aws_codedeploy_deployment_group.app","module_address":"module.covid-shield-submission","mode":"managed","type":"aws_codedeploy_deployment_group","name":"app","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alarm_configuration":[],"app_name":"AppECS-CovidShield-KeySubmission","auto_rollback_configuration":[{"enabled":true,"events":["DEPLOYMENT_FAILURE"]}],"autoscaling_groups":null,"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":"CONTINUE_DEPLOYMENT","wait_time_in_minutes":null}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{"action":"TERMINATE","termination_wait_time_in_minutes":1}]}],"deployment_config_name":"CodeDeployDefault.ECSAllAtOnce","deployment_group_name":"DgpECS-CovidShield-KeySubmission","deployment_style":[{"deployment_option":"WITH_TRAFFIC_CONTROL","deployment_type":"BLUE_GREEN"}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{"cluster_name":"CovidShield","service_name":"KeySubmission"}],"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_submission.arn"]}],"target_group":[{"name":"covidshield-key-submission"},{"name":"covidshield-key-submission-2"}],"test_traffic_route":[{"listener_arns":["aws_lb_listener.covidshield_key_submission_test.arn"]}]}]}],"on_premises_instance_tag_filter":[],"service_role_arn":"aws_iam_role.codedeploy.arn","tags":null,"trigger_configuration":[]},"after_unknown":{"alarm_configuration":[],"arn":true,"auto_rollback_configuration":[{"events":[false]}],"blue_green_deployment_config":[{"deployment_ready_option":[{}],"green_fleet_provisioning_option":[],"terminate_blue_instances_on_deployment_success":[{}]}],"compute_platform":true,"deployment_group_id":true,"deployment_style":[{}],"ec2_tag_filter":[],"ec2_tag_set":[],"ecs_service":[{}],"id":true,"load_balancer_info":[{"elb_info":[],"target_group_info":[],"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":[false]}],"target_group":[{},{}],"test_traffic_route":[{"listener_arns":[false]}]}]}],"on_premises_instance_tag_filter":[],"tags_all":true,"trigger_configuration":[]}}},{"address":"random_string.random","mode":"managed","type":"random_string","name":"random","provider_name":"registry.terraform.io/hashicorp/random","change":{"actions":["create"],"before":null,"after":{"keepers":null,"length":6,"lower":true,"min_lower":0,"min_numeric":0,"min_special":0,"min_upper":0,"number":true,"override_special":null,"special":false,"upper":false},"after_unknown":{"id":true,"result":true}}}],"output_changes":{"aws_db_subnet_group":{"actions":["create"],"before":null,"after":{"arn":"aws_db_subnet_group.covidshield.arn","description":"Managed by Terraform","id":"aws_db_subnet_group.covidshield.id","name":"server","name_prefix":"aws_db_subnet_group.covidshield.name_prefix","subnet_ids":["aws_subnet.covidshield_private[0].id","aws_subnet.covidshield_private[1].id","aws_subnet.covidshield_private[2].id"],"tags":{"CostCentre":"CovidShield","Name":"server"},"tags_all":{"CostCentre":"CovidShield","Name":"server"}},"after_unknown":false},"aws_private_subnets":{"actions":["create"],"before":null,"after_unknown":true},"aws_public_subnets":{"actions":["create"],"before":null,"after_unknown":true},"cloudwatch_log_group":{"actions":["create"],"before":null,"after":{"arn":"aws_cloudwatch_log_group.covidshield.arn","id":"aws_cloudwatch_log_group.covidshield.id","kms_key_id":"aws_kms_key.cw.arn","name":"CovidShield","name_prefix":"aws_cloudwatch_log_group.covidshield.name_prefix","retention_in_days":90,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":false},"ecr_repository_url":{"actions":["create"],"before":null,"after":{"covid-server/key-retrieval":"aws_ecr_repository.repository[key-retrieval].repository_url","covid-server/key-submission":"aws_ecr_repository.repository[key-submission].repository_url","covid-server/monolith":"aws_ecr_repository.repository[monolith].repository_url"},"after_unknown":false},"ecs_cluster":{"actions":["create"],"before":null,"after":{"arn":"aws_ecs_cluster.covidshield.arn","capacity_providers":null,"configuration":[],"default_capacity_provider_strategy":[],"id":"aws_ecs_cluster.covidshield.id","name":"CovidShield","setting":[{"name":"containerInsights","value":"enabled"}],"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"}},"after_unknown":false},"route53_submission_fqdn":{"actions":["create"],"before":null,"after_unknown":true},"route53_zone":{"actions":["create"],"before":null,"after_unknown":true},"security_group_load_balancer":{"actions":["create"],"before":null,"after":{"arn":"aws_security_group.covidshield_load_balancer.arn","description":"Ingress - CovidShield Load Balancer","egress":[{"cidr_blocks":["10.0.0.0/24"],"description":"retrieval target ca-central-1a","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.0.0/24"],"description":"submission target ca-central-1a","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.1.0/24"],"description":"retrieval target ca-central-1b","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.1.0/24"],"description":"submission target ca-central-1b","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000},{"cidr_blocks":["10.0.2.0/24"],"description":"retrieval target ca-central-1d","from_port":8001,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8001},{"cidr_blocks":["10.0.2.0/24"],"description":"submission target ca-central-1d","from_port":8000,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8000}],"id":"aws_security_group.covidshield_load_balancer.id","ingress":[{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":443},{"cidr_blocks":["0.0.0.0/0"],"description":null,"from_port":8443,"ipv6_cidr_blocks":null,"prefix_list_ids":null,"protocol":"tcp","security_groups":null,"self":null,"to_port":8443}],"name":"covidshield-load-balancer","name_prefix":"aws_security_group.covidshield_load_balancer.name_prefix","owner_id":"aws_security_group.covidshield_load_balancer.owner_id","revoke_rules_on_delete":false,"tags":{"CostCentre":"CovidShield"},"tags_all":{"CostCentre":"CovidShield"},"timeouts":null,"vpc_id":"aws_vpc.covidshield.id"},"after_unknown":false},"vpc":{"actions":["create"],"before":null,"after_unknown":true}},"prior_state":{"format_version":"0.1","terraform_version":"0.13.4","values":{"root_module":{"resources":[{"address":"data.archive_file.lambda_validate_deploy","mode":"data","type":"archive_file","name":"lambda_validate_deploy","provider_name":"registry.terraform.io/hashicorp/archive","schema_version":0,"values":{"excludes":null,"id":"96020bdc89e754e980b353c725eda2b72396d5d8","output_base64sha256":"jarV4/mad4XdTehS86tGTX/xBKNvpkUHSWcfWLkX06w=","output_file_mode":null,"output_md5":"e582d38d334da92b76ac2a2a0294f7a2","output_path":"/tmp/lambda_validate_deploy.rb.zip","output_sha":"96020bdc89e754e980b353c725eda2b72396d5d8","output_size":761,"source":[],"source_content":null,"source_content_filename":null,"source_dir":null,"source_file":"lambda/lambda_validate_deploy.rb","type":"zip"}},{"address":"data.aws_availability_zones.available","mode":"data","type":"aws_availability_zones","name":"available","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"all_availability_zones":null,"exclude_names":null,"exclude_zone_ids":null,"filter":null,"group_names":["ca-central-1"],"id":"ca-central-1","names":["ca-central-1a","ca-central-1b","ca-central-1d"],"state":"available","zone_ids":["cac1-az1","cac1-az2","cac1-az4"]}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"account_id":"115553109071","arn":"arn:aws:sts::115553109071:assumed-role/AWSReservedSSO_admin_in_develop_fb314e4593b59bf2/imanuel.m@indeni.com","id":"115553109071","user_id":"AROARVZ4AQRHRH7ZLU5BZ:imanuel.m@indeni.com"}},{"address":"data.aws_iam_policy_document.assume_role_policy_codedeploy","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy_codedeploy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"1717932134","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"codedeploy.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["codedeploy.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}},{"address":"data.aws_iam_policy_document.covidshield","mode":"data","type":"aws_iam_policy_document","name":"covidshield","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"id":"320642683","json":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"ecs-tasks.amazonaws.com\"\n      }\n    }\n  ]\n}","override_json":null,"override_policy_documents":null,"policy_id":null,"source_json":null,"source_policy_documents":null,"statement":[{"actions":["sts:AssumeRole"],"condition":[],"effect":"Allow","not_actions":[],"not_principals":[],"not_resources":[],"principals":[{"identifiers":["ecs-tasks.amazonaws.com"],"type":"Service"}],"resources":[],"sid":""}],"version":"2012-10-17"}}]}}},"configuration":{"provider_config":{"aws":{"name":"aws","version_constraint":"~\u003e 3.11","expressions":{"region":{"references":["var.region"]}}},"aws.us-east-1":{"name":"aws","alias":"us-east-1","version_constraint":"~\u003e 3.11","expressions":{"region":{"constant_value":"us-east-1"}}}},"root_module":{"outputs":{"aws_db_subnet_group":{"expression":{"references":["aws_db_subnet_group.covidshield"]}},"aws_private_subnets":{"expression":{"references":["aws_subnet.covidshield_private"]}},"aws_public_subnets":{"expression":{"references":["aws_subnet.covidshield_public"]}},"cloudwatch_log_group":{"expression":{"references":["aws_cloudwatch_log_group.covidshield"]}},"ecr_repository_url":{"expression":{"references":["aws_ecr_repository.repository"]}},"ecs_cluster":{"expression":{"references":["aws_ecs_cluster.covidshield"]}},"route53_submission_fqdn":{"expression":{"references":["aws_route53_record.covidshield_key_submission"]}},"route53_zone":{"expression":{"references":["aws_route53_zone.covidshield"]}},"security_group_load_balancer":{"expression":{"references":["aws_security_group.covidshield_load_balancer"]}},"vpc":{"expression":{"references":["aws_vpc.covidshield"]}}},"resources":[{"address":"aws_acm_certificate.covidshield","mode":"managed","type":"aws_acm_certificate","name":"covidshield","provider_config_key":"aws","expressions":{"domain_name":{"references":["var.route53_zone_name"]},"subject_alternative_names":{"references":["var.route53_zone_name"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"validation_method":{"constant_value":"DNS"}},"schema_version":0,"raw_data":{"FileName":"certificates.tf","StartLine":1,"EndLine":13}},{"address":"aws_acm_certificate.retrieval_covidshield","mode":"managed","type":"aws_acm_certificate","name":"retrieval_covidshield","provider_config_key":"aws.us-east-1","expressions":{"domain_name":{"references":["var.route53_zone_name"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"validation_method":{"constant_value":"DNS"}},"schema_version":0,"raw_data":{"FileName":"certificates.tf","StartLine":18,"EndLine":30}},{"address":"aws_acm_certificate_validation.covidshield","mode":"managed","type":"aws_acm_certificate_validation","name":"covidshield","provider_config_key":"aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.covidshield"]},"validation_record_fqdns":{"references":["aws_route53_record.covidshield_certificate_validation"]}},"schema_version":0,"raw_data":{"FileName":"certificates.tf","StartLine":70,"EndLine":73}},{"address":"aws_acm_certificate_validation.retrieval_covidshield","mode":"managed","type":"aws_acm_certificate_validation","name":"retrieval_covidshield","provider_config_key":"aws.us-east-1","expressions":{"certificate_arn":{"references":["aws_acm_certificate.retrieval_covidshield"]},"validation_record_fqdns":{"references":["aws_route53_record.retrieval_covidshield_certificate_validation"]}},"schema_version":0,"raw_data":{"FileName":"certificates.tf","StartLine":75,"EndLine":79}},{"address":"aws_appautoscaling_policy.retrieval_cpu","mode":"managed","type":"aws_appautoscaling_policy","name":"retrieval_cpu","provider_config_key":"aws","expressions":{"name":{"constant_value":"retrieval_cpu"},"policy_type":{"constant_value":"TargetTrackingScaling"},"resource_id":{"references":["aws_ecs_service.covidshield_key_retrieval","aws_ecs_service.covidshield_key_retrieval"]},"scalable_dimension":{"constant_value":"ecs:service:DesiredCount"},"service_namespace":{"constant_value":"ecs"},"target_tracking_scaling_policy_configuration":[{"predefined_metric_specification":[{"predefined_metric_type":{"constant_value":"ECSServiceAverageCPUUtilization"}}],"scale_in_cooldown":{"references":["var.scale_in_cooldown"]},"scale_out_cooldown":{"references":["var.scale_out_cooldown"]},"target_value":{"references":["var.cpu_scale_metric"]}}]},"schema_version":0,"count_expression":{"references":["var.retrieval_autoscale_enabled"]},"raw_data":{"FileName":"ecs.tf","StartLine":124,"EndLine":140}},{"address":"aws_appautoscaling_policy.retrieval_memory","mode":"managed","type":"aws_appautoscaling_policy","name":"retrieval_memory","provider_config_key":"aws","expressions":{"name":{"constant_value":"retrieval_memory"},"policy_type":{"constant_value":"TargetTrackingScaling"},"resource_id":{"references":["aws_ecs_service.covidshield_key_retrieval","aws_ecs_service.covidshield_key_retrieval"]},"scalable_dimension":{"constant_value":"ecs:service:DesiredCount"},"service_namespace":{"constant_value":"ecs"},"target_tracking_scaling_policy_configuration":[{"predefined_metric_specification":[{"predefined_metric_type":{"constant_value":"ECSServiceAverageMemoryUtilization"}}],"scale_in_cooldown":{"references":["var.scale_in_cooldown"]},"scale_out_cooldown":{"references":["var.scale_out_cooldown"]},"target_value":{"references":["var.memory_scale_metric"]}}]},"schema_version":0,"count_expression":{"references":["var.retrieval_autoscale_enabled"]},"raw_data":{"FileName":"ecs.tf","StartLine":142,"EndLine":158}},{"address":"aws_appautoscaling_policy.submission_cpu","mode":"managed","type":"aws_appautoscaling_policy","name":"submission_cpu","provider_config_key":"aws","expressions":{"name":{"constant_value":"submission_cpu"},"policy_type":{"constant_value":"TargetTrackingScaling"},"resource_id":{"references":["aws_ecs_service.covidshield_key_submission","aws_ecs_service.covidshield_key_submission"]},"scalable_dimension":{"constant_value":"ecs:service:DesiredCount"},"service_namespace":{"constant_value":"ecs"},"target_tracking_scaling_policy_configuration":[{"predefined_metric_specification":[{"predefined_metric_type":{"constant_value":"ECSServiceAverageCPUUtilization"}}],"scale_in_cooldown":{"references":["var.scale_in_cooldown"]},"scale_out_cooldown":{"references":["var.scale_out_cooldown"]},"target_value":{"references":["var.cpu_scale_metric"]}}]},"schema_version":0,"count_expression":{"references":["var.submission_autoscale_enabled"]},"raw_data":{"FileName":"ecs.tf","StartLine":256,"EndLine":272}},{"address":"aws_appautoscaling_policy.submission_memory","mode":"managed","type":"aws_appautoscaling_policy","name":"submission_memory","provider_config_key":"aws","expressions":{"name":{"constant_value":"submission_memory"},"policy_type":{"constant_value":"TargetTrackingScaling"},"resource_id":{"references":["aws_ecs_service.covidshield_key_submission","aws_ecs_service.covidshield_key_submission"]},"scalable_dimension":{"constant_value":"ecs:service:DesiredCount"},"service_namespace":{"constant_value":"ecs"},"target_tracking_scaling_policy_configuration":[{"predefined_metric_specification":[{"predefined_metric_type":{"constant_value":"ECSServiceAverageMemoryUtilization"}}],"scale_in_cooldown":{"references":["var.scale_in_cooldown"]},"scale_out_cooldown":{"references":["var.scale_out_cooldown"]},"target_value":{"references":["var.memory_scale_metric"]}}]},"schema_version":0,"count_expression":{"references":["var.submission_autoscale_enabled"]},"raw_data":{"FileName":"ecs.tf","StartLine":274,"EndLine":290}},{"address":"aws_appautoscaling_target.retrieval","mode":"managed","type":"aws_appautoscaling_target","name":"retrieval","provider_config_key":"aws","expressions":{"max_capacity":{"references":["var.max_capacity"]},"min_capacity":{"references":["var.min_capacity"]},"resource_id":{"references":["aws_ecs_service.covidshield_key_retrieval","aws_ecs_service.covidshield_key_retrieval"]},"scalable_dimension":{"constant_value":"ecs:service:DesiredCount"},"service_namespace":{"constant_value":"ecs"}},"schema_version":0,"count_expression":{"references":["var.retrieval_autoscale_enabled"]},"raw_data":{"FileName":"ecs.tf","StartLine":116,"EndLine":123}},{"address":"aws_appautoscaling_target.submission","mode":"managed","type":"aws_appautoscaling_target","name":"submission","provider_config_key":"aws","expressions":{"max_capacity":{"references":["var.max_capacity"]},"min_capacity":{"references":["var.min_capacity"]},"resource_id":{"references":["aws_ecs_service.covidshield_key_submission","aws_ecs_service.covidshield_key_submission"]},"scalable_dimension":{"constant_value":"ecs:service:DesiredCount"},"service_namespace":{"constant_value":"ecs"}},"schema_version":0,"count_expression":{"references":["var.submission_autoscale_enabled"]},"raw_data":{"FileName":"ecs.tf","StartLine":248,"EndLine":255}},{"address":"aws_cloudfront_distribution.key_retrieval_distribution","mode":"managed","type":"aws_cloudfront_distribution","name":"key_retrieval_distribution","provider_config_key":"aws","expressions":{"aliases":{"references":["var.route53_zone_name"]},"default_cache_behavior":[{"allowed_methods":{"constant_value":["GET","HEAD"]},"cached_methods":{"constant_value":["GET","HEAD"]},"compress":{"constant_value":true},"default_ttl":{"constant_value":3600},"forwarded_values":[{"cookies":[{"forward":{"constant_value":"all"}}],"headers":{"constant_value":["Host"]},"query_string":{"constant_value":true}}],"max_ttl":{"constant_value":7200},"min_ttl":{"constant_value":0},"target_origin_id":{"references":["aws_lb.covidshield_key_retrieval"]},"viewer_protocol_policy":{"constant_value":"https-only"}}],"enabled":{"constant_value":true},"is_ipv6_enabled":{"constant_value":true},"logging_config":[{"bucket":{"references":["aws_s3_bucket.cloudfront_logs"]},"include_cookies":{"constant_value":false},"prefix":{"constant_value":"cloudfront"}}],"ordered_cache_behavior":[{"allowed_methods":{"constant_value":["GET","HEAD"]},"cached_methods":{"constant_value":["GET","HEAD"]},"compress":{"constant_value":true},"default_ttl":{"constant_value":86400},"forwarded_values":[{"cookies":[{"forward":{"constant_value":"none"}}],"headers":{"constant_value":["Origin"]},"query_string":{"constant_value":false}}],"max_ttl":{"constant_value":31536000},"min_ttl":{"constant_value":0},"path_pattern":{"constant_value":"/exposure-configuration/*"},"target_origin_id":{"references":["var.environment"]},"viewer_protocol_policy":{"constant_value":"https-only"}},{"allowed_methods":{"constant_value":["GET","HEAD"]},"cached_methods":{"constant_value":["GET","HEAD"]},"compress":{"constant_value":true},"default_ttl":{"constant_value":0},"forwarded_values":[{"cookies":[{"forward":{"constant_value":"all"}}],"headers":{"constant_value":["Host","Authorization"]},"query_string":{"constant_value":true}}],"max_ttl":{"constant_value":0},"min_ttl":{"constant_value":0},"path_pattern":{"constant_value":"/events/*"},"target_origin_id":{"references":["aws_lb.covidshield_key_retrieval"]},"viewer_protocol_policy":{"constant_value":"https-only"}}],"origin":[{"custom_header":[{"name":{"constant_value":"covidshield"},"value":{"references":["var.cloudfront_custom_header"]}}],"custom_origin_config":[{"http_port":{"constant_value":80},"https_port":{"constant_value":443},"origin_protocol_policy":{"constant_value":"https-only"},"origin_ssl_protocols":{"constant_value":["TLSv1.2"]}}],"domain_name":{"references":["aws_lb.covidshield_key_retrieval"]},"origin_id":{"references":["aws_lb.covidshield_key_retrieval"]}},{"domain_name":{"references":["aws_s3_bucket.exposure_config"]},"origin_id":{"references":["var.environment"]},"s3_origin_config":[{"origin_access_identity":{"references":["aws_cloudfront_origin_access_identity.origin_access_identity"]}}]}],"price_class":{"constant_value":"PriceClass_100"},"restrictions":[{"geo_restriction":[{"restriction_type":{"constant_value":"none"}}]}],"viewer_certificate":[{"acm_certificate_arn":{"references":["aws_acm_certificate_validation.retrieval_covidshield"]},"minimum_protocol_version":{"constant_value":"TLSv1.2_2018"},"ssl_support_method":{"constant_value":"sni-only"}}],"web_acl_id":{"references":["aws_wafv2_web_acl.key_retrieval_cdn"]}},"schema_version":1,"depends_on":["aws_s3_bucket.cloudfront_logs"],"raw_data":{"FileName":"cloudfront.tf","StartLine":9,"EndLine":132}},{"address":"aws_cloudfront_origin_access_identity.origin_access_identity","mode":"managed","type":"aws_cloudfront_origin_access_identity","name":"origin_access_identity","provider_config_key":"aws","expressions":{"comment":{"constant_value":"cloudfront origin access identity"}},"schema_version":0,"raw_data":{"FileName":"cloudfront.tf","StartLine":5,"EndLine":7}},{"address":"aws_cloudwatch_log_group.covidshield","mode":"managed","type":"aws_cloudwatch_log_group","name":"covidshield","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["aws_kms_key.cw"]},"name":{"references":["var.cloudwatch_log_group_name"]},"retention_in_days":{"constant_value":90},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":1,"EndLine":9}},{"address":"aws_cloudwatch_log_group.vpc_flow_logs","mode":"managed","type":"aws_cloudwatch_log_group","name":"vpc_flow_logs","provider_config_key":"aws","expressions":{"kms_key_id":{"references":["aws_kms_key.cw"]},"name":{"constant_value":"vpc_flow_logs"},"retention_in_days":{"constant_value":30}},"schema_version":0,"raw_data":{"FileName":"vpc_flow_log.tf","StartLine":8,"EndLine":12}},{"address":"aws_cloudwatch_log_metric_filter.ClaimedOneTimeCodeTotal","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"ClaimedOneTimeCodeTotal","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"ClaimedOneTimeCodeTotal"},"namespace":{"constant_value":"CovidShield"},"value":{"references":["count.index"]}}],"name":{"references":["count.index"]},"pattern":{"references":["count.index"]}},"schema_version":0,"count_expression":{"constant_value":8},"raw_data":{"FileName":"metrics.tf","StartLine":80,"EndLine":92}},{"address":"aws_cloudwatch_log_metric_filter.DiagnosisKeyTotal","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"DiagnosisKeyTotal","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"DiagnosisKeyTotal"},"namespace":{"constant_value":"CovidShield"},"value":{"references":["count.index"]}}],"name":{"references":["count.index"]},"pattern":{"references":["count.index"]}},"schema_version":0,"count_expression":{"constant_value":8},"raw_data":{"FileName":"metrics.tf","StartLine":122,"EndLine":134}},{"address":"aws_cloudwatch_log_metric_filter.UnclaimedOneTimeCodeTotal","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"UnclaimedOneTimeCodeTotal","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"UnclaimedOneTimeCodeTotal"},"namespace":{"constant_value":"CovidShield"},"value":{"references":["count.index"]}}],"name":{"references":["count.index"]},"pattern":{"references":["count.index"]}},"schema_version":0,"count_expression":{"constant_value":8},"raw_data":{"FileName":"metrics.tf","StartLine":38,"EndLine":50}},{"address":"aws_cloudwatch_log_metric_filter.error_logged","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"error_logged","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"ErrorLogged"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"ErrorLogged"},"pattern":{"constant_value":"level=error"}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":258,"EndLine":268}},{"address":"aws_cloudwatch_log_metric_filter.fatal_logged","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"fatal_logged","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"FatalLogged"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"FatalLogged"},"pattern":{"constant_value":"level=fatal"}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":298,"EndLine":308}},{"address":"aws_cloudwatch_log_metric_filter.five_hundred_response","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"five_hundred_response","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"500Response"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"500Response"},"pattern":{"constant_value":"statusClass=5xx msg=\"http response\""}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":218,"EndLine":228}},{"address":"aws_cloudwatch_log_metric_filter.key_clear_called","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"key_clear_called","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"KeyClearCalled"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"KeyClearCalled"},"pattern":{"constant_value":"diagnosis_keys was truncated"}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":328,"EndLine":338}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_new_one_time_code_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_new_one_time_code_requests","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"UnauthorizedNewOneTimeCodeRequests"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"UnauthorizedNewOneTimeCodeRequests"},"pattern":{"constant_value":"statusCode=401 msg=\"http response\" \"path=/new-key-claim\""}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":94,"EndLine":104}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_one_time_code_claim_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_one_time_code_claim_requests","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"UnauthorizedOneTimeCodeClaimRequests"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"UnauthorizedOneTimeCodeClaimRequests"},"pattern":{"constant_value":"statusCode=401 msg=\"http response\" \"path=/claim-key\""}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":134,"EndLine":144}},{"address":"aws_cloudwatch_log_metric_filter.unauthorized_upload_requests","mode":"managed","type":"aws_cloudwatch_log_metric_filter","name":"unauthorized_upload_requests","provider_config_key":"aws","expressions":{"log_group_name":{"references":["aws_cloudwatch_log_group.covidshield"]},"metric_transformation":[{"name":{"constant_value":"UnauthorizedUploadRequests"},"namespace":{"constant_value":"CovidShield"},"value":{"constant_value":"1"}}],"name":{"constant_value":"UnauthorizedUploadRequests"},"pattern":{"constant_value":"statusClass=4xx msg=\"http response\" \"path=/upload\""}},"schema_version":0,"raw_data":{"FileName":"cloudwatch.tf","StartLine":174,"EndLine":184}},{"address":"aws_cloudwatch_metric_alarm.ClaimedOneTimeCodeTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ClaimedOneTimeCodeTotalCritical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for total claimed codes"},"alarm_name":{"constant_value":"ClaimedOneTimeCodeTotalCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"ClaimedOneTimeCodeTotal"},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Maximum"},"threshold":{"references":["var.claimed_one_time_code_total_critical"]}},"schema_version":1,"raw_data":{"FileName":"metrics.tf","StartLine":108,"EndLine":120}},{"address":"aws_cloudwatch_metric_alarm.ClaimedOneTimeCodeTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ClaimedOneTimeCodeTotalWarn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors for total claimed codes"},"alarm_name":{"constant_value":"ClaimedOneTimeCodeTotalWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"ClaimedOneTimeCodeTotal"},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Maximum"},"threshold":{"references":["var.claimed_one_time_code_total_warn"]}},"schema_version":1,"raw_data":{"FileName":"metrics.tf","StartLine":94,"EndLine":106}},{"address":"aws_cloudwatch_metric_alarm.DiagnosisKeyTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"DiagnosisKeyTotalCritical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for total diagnosis keys"},"alarm_name":{"constant_value":"DiagnosisKeyTotalCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"DiagnosisKeyTotal"},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Maximum"},"threshold":{"references":["var.diagnosis_key_total_critical"]}},"schema_version":1,"raw_data":{"FileName":"metrics.tf","StartLine":150,"EndLine":162}},{"address":"aws_cloudwatch_metric_alarm.DiagnosisKeyTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"DiagnosisKeyTotalWarn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors for total diagnosis keys"},"alarm_name":{"constant_value":"DiagnosisKeyTotalWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"DiagnosisKeyTotal"},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Maximum"},"threshold":{"references":["var.diagnosis_key_total_warn"]}},"schema_version":1,"raw_data":{"FileName":"metrics.tf","StartLine":136,"EndLine":148}},{"address":"aws_cloudwatch_metric_alarm.UnclaimedOneTimeCodeTotalCritical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"UnclaimedOneTimeCodeTotalCritical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for total unclaimed codes"},"alarm_name":{"constant_value":"UnclaimedOneTimeCodeTotalCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"UnclaimedOneTimeCodeTotal"},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Maximum"},"threshold":{"references":["var.unclaimed_one_time_code_total_critical"]}},"schema_version":1,"raw_data":{"FileName":"metrics.tf","StartLine":66,"EndLine":78}},{"address":"aws_cloudwatch_metric_alarm.UnclaimedOneTimeCodeTotalWarn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"UnclaimedOneTimeCodeTotalWarn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors for total unclaimed codes"},"alarm_name":{"constant_value":"UnclaimedOneTimeCodeTotalWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"UnclaimedOneTimeCodeTotal"},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Maximum"},"threshold":{"references":["var.unclaimed_one_time_code_total_warn"]}},"schema_version":1,"raw_data":{"FileName":"metrics.tf","StartLine":52,"EndLine":64}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_cdn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_cdn","provider_config_key":"aws.us-east-1","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning_us_east","aws_sns_topic.alert_critical_us_east"]},"alarm_description":{"constant_value":"This metric monitors for DDoS detected on retrieval CDN"},"alarm_name":{"constant_value":"DDoSDetectedCDN"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_cloudfront_distribution.key_retrieval_distribution"]},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"DDoSDetected"},"namespace":{"constant_value":"AWS/DDoSProtection"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"0"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":394,"EndLine":412}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_retrieval","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_retrieval","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning","aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for DDoS detected on retrieval ALB"},"alarm_name":{"constant_value":"DDoSDetectedRetrievalALB"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_lb.covidshield_key_retrieval"]},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"DDoSDetected"},"namespace":{"constant_value":"AWS/DDoSProtection"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"0"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":376,"EndLine":392}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_route53","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_route53","provider_config_key":"aws.us-east-1","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning_us_east","aws_sns_topic.alert_critical_us_east"]},"alarm_description":{"constant_value":"This metric monitors for DDoS detected on route 53"},"alarm_name":{"constant_value":"DDoSDetectedRoute53"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_route53_zone.covidshield"]},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"DDoSDetected"},"namespace":{"constant_value":"AWS/DDoSProtection"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"0"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":414,"EndLine":432}},{"address":"aws_cloudwatch_metric_alarm.ddos_detected_submission","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"ddos_detected_submission","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning","aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for DDoS detected on submission ALB"},"alarm_name":{"constant_value":"DDoSDetectedSubmissionALB"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_lb.covidshield_key_submission"]},"evaluation_periods":{"constant_value":"1"},"metric_name":{"constant_value":"DDoSDetected"},"namespace":{"constant_value":"AWS/DDoSProtection"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"0"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":358,"EndLine":374}},{"address":"aws_cloudwatch_metric_alarm.error_logged_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"error_logged_critical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for an error level logs"},"alarm_name":{"constant_value":"ErrorLoggedCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.error_logged"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"10"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":284,"EndLine":296}},{"address":"aws_cloudwatch_metric_alarm.error_logged_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"error_logged_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors for an error level logs"},"alarm_name":{"constant_value":"ErrorLoggedWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.error_logged"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"1"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":270,"EndLine":282}},{"address":"aws_cloudwatch_metric_alarm.fatal_logged_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"fatal_logged_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning","aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for a fatal level logs"},"alarm_name":{"constant_value":"FatalLoggedWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.fatal_logged"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"1"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":310,"EndLine":322}},{"address":"aws_cloudwatch_metric_alarm.five_hundred_response_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"five_hundred_response_critical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for an 5xx level response"},"alarm_name":{"constant_value":"500ResponseCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.five_hundred_response"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"10"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":244,"EndLine":256}},{"address":"aws_cloudwatch_metric_alarm.five_hundred_response_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"five_hundred_response_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors for an 5xx level response"},"alarm_name":{"constant_value":"500ResponseWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.five_hundred_response"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"1"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":230,"EndLine":242}},{"address":"aws_cloudwatch_metric_alarm.key_clear_called_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"key_clear_called_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning","aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors for a key clear calls (only be called in staging)"},"alarm_name":{"constant_value":"KeyClearCalledWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.key_clear_called"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"0"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":340,"EndLine":352}},{"address":"aws_cloudwatch_metric_alarm.retrieval_cpu_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"retrieval_cpu_utilization_high","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors ecs cpu utilization"},"alarm_name":{"constant_value":"retrieval-cpu-utilization-high"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_ecs_cluster.covidshield","aws_ecs_service.covidshield_key_retrieval"]},"evaluation_periods":{"constant_value":"2"},"metric_name":{"constant_value":"CPUUtilization"},"namespace":{"constant_value":"AWS/ECS"},"period":{"constant_value":"120"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"50"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":15,"EndLine":31}},{"address":"aws_cloudwatch_metric_alarm.retrieval_memory_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"retrieval_memory_utilization_high","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors ecs memory utilization"},"alarm_name":{"constant_value":"retrieval-memory-utilization-high"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_ecs_cluster.covidshield","aws_ecs_service.covidshield_key_retrieval"]},"evaluation_periods":{"constant_value":2},"metric_name":{"constant_value":"MemoryUtilization"},"namespace":{"constant_value":"AWS/ECS"},"period":{"constant_value":"120"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"50"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":52,"EndLine":69}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check","provider_config_key":"aws.us-east-1","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning_us_east","aws_sns_topic.alert_critical_us_east"]},"alarm_description":{"constant_value":"Check that the Retrieval server is in alarm"},"alarm_name":{"constant_value":"Route53RetrievalHealthCheck"},"comparison_operator":{"constant_value":"LessThanThreshold"},"dimensions":{"references":["aws_route53_health_check.covidshield_key_retrieval_healthcheck"]},"evaluation_periods":{"constant_value":"2"},"metric_name":{"constant_value":"HealthCheckStatus"},"namespace":{"constant_value":"AWS/Route53"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"1"},"treat_missing_data":{"constant_value":"breaching"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":438,"EndLine":457}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check_ca_json","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check_ca_json","provider_config_key":"aws.us-east-1","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning_us_east","aws_sns_topic.alert_critical_us_east"]},"alarm_description":{"constant_value":"Check that the Retrieval server is correctly serving CA.json"},"alarm_name":{"constant_value":"Route53RetrievalHealthCheckCAJson"},"comparison_operator":{"constant_value":"LessThanThreshold"},"dimensions":{"references":["aws_route53_health_check.covidshield_key_retrieval_healthcheck_ca_json"]},"evaluation_periods":{"constant_value":"2"},"metric_name":{"constant_value":"HealthCheckStatus"},"namespace":{"constant_value":"AWS/Route53"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"1"},"treat_missing_data":{"constant_value":"breaching"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":459,"EndLine":478}},{"address":"aws_cloudwatch_metric_alarm.route53_retrieval_health_check_region_json","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_retrieval_health_check_region_json","provider_config_key":"aws.us-east-1","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning_us_east","aws_sns_topic.alert_critical_us_east"]},"alarm_description":{"constant_value":"Check that the Retrieval server is correctly serving region.json"},"alarm_name":{"constant_value":"Route53RetrievalHealthCheckRegionJson"},"comparison_operator":{"constant_value":"LessThanThreshold"},"dimensions":{"references":["aws_route53_health_check.covidshield_key_retrieval_healthcheck_region_json"]},"evaluation_periods":{"constant_value":"2"},"metric_name":{"constant_value":"HealthCheckStatus"},"namespace":{"constant_value":"AWS/Route53"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"1"},"treat_missing_data":{"constant_value":"breaching"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":480,"EndLine":499}},{"address":"aws_cloudwatch_metric_alarm.route53_submission_health_check","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"route53_submission_health_check","provider_config_key":"aws.us-east-1","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning_us_east","aws_sns_topic.alert_critical_us_east"]},"alarm_description":{"constant_value":"Check that the Submission server is in alarm"},"alarm_name":{"constant_value":"Route53SubmissionHealthCheck"},"comparison_operator":{"constant_value":"LessThanThreshold"},"dimensions":{"references":["aws_route53_health_check.covidshield_key_submission_healthcheck"]},"evaluation_periods":{"constant_value":"2"},"metric_name":{"constant_value":"HealthCheckStatus"},"namespace":{"constant_value":"AWS/Route53"},"period":{"constant_value":"60"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"1"},"treat_missing_data":{"constant_value":"breaching"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":501,"EndLine":520}},{"address":"aws_cloudwatch_metric_alarm.submission_cpu_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"submission_cpu_utilization_high","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors ecs cpu utilization"},"alarm_name":{"constant_value":"submission-cpu-utilization-high"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_ecs_cluster.covidshield","aws_ecs_service.covidshield_key_submission"]},"evaluation_periods":{"constant_value":"2"},"metric_name":{"constant_value":"CPUUtilization"},"namespace":{"constant_value":"AWS/ECS"},"period":{"constant_value":"120"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"50"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":33,"EndLine":50}},{"address":"aws_cloudwatch_metric_alarm.submission_memory_utilization_high","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"submission_memory_utilization_high","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors ecs memory utilization"},"alarm_name":{"constant_value":"submission-memory-utilization-high"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_ecs_cluster.covidshield","aws_ecs_service.covidshield_key_submission"]},"evaluation_periods":{"constant_value":2},"metric_name":{"constant_value":"MemoryUtilization"},"namespace":{"constant_value":"AWS/ECS"},"period":{"constant_value":"120"},"statistic":{"constant_value":"Average"},"threshold":{"constant_value":"50"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":71,"EndLine":88}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_new_one_time_code_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_new_one_time_code_requests_critical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors the 401 response rate for /new-key-claim"},"alarm_name":{"constant_value":"UnauthorizedNewOneTimeCodeRequestsCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.unauthorized_new_one_time_code_requests"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"100"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":120,"EndLine":132}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_new_one_time_code_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_new_one_time_code_requests_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors the 401 response rate for /new-key-claim"},"alarm_name":{"constant_value":"UnauthorizedNewOneTimeCodeRequestsWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.unauthorized_new_one_time_code_requests"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"60"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":106,"EndLine":118}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_one_time_code_claim_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_one_time_code_claim_requests_critical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors the 401 response rate for /claim-key"},"alarm_name":{"constant_value":"UnauthorizedOneTimeCodeClaimRequestsCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.unauthorized_one_time_code_claim_requests"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"100"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":160,"EndLine":172}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_one_time_code_claim_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_one_time_code_claim_requests_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors the 401 response rate for /claim-key"},"alarm_name":{"constant_value":"UnauthorizedOneTimeCodeClaimRequestsWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.unauthorized_one_time_code_claim_requests"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"60"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":146,"EndLine":158}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_upload_requests_critical","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_upload_requests_critical","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_critical"]},"alarm_description":{"constant_value":"This metric monitors the 4xx response rate for /upload"},"alarm_name":{"constant_value":"UnauthorizedUploadRequestsCritical"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.unauthorized_upload_requests"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"100"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":200,"EndLine":212}},{"address":"aws_cloudwatch_metric_alarm.unauthorized_upload_requests_warn","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"unauthorized_upload_requests_warn","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_sns_topic.alert_warning"]},"alarm_description":{"constant_value":"This metric monitors the 4xx response rate for /upload"},"alarm_name":{"constant_value":"UnauthorizedUploadRequestsWarn"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"evaluation_periods":{"constant_value":"1"},"metric_name":{"references":["aws_cloudwatch_log_metric_filter.unauthorized_upload_requests"]},"namespace":{"constant_value":"CovidShield"},"period":{"constant_value":"300"},"statistic":{"constant_value":"Sum"},"threshold":{"constant_value":"60"}},"schema_version":1,"raw_data":{"FileName":"cloudwatch.tf","StartLine":186,"EndLine":198}},{"address":"aws_db_subnet_group.covidshield","mode":"managed","type":"aws_db_subnet_group","name":"covidshield","provider_config_key":"aws","expressions":{"name":{"references":["var.rds_db_subnet_group_name"]},"subnet_ids":{"references":["aws_subnet.covidshield_private"]},"tags":{"references":["var.rds_db_subnet_group_name","var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"rds.tf","StartLine":7,"EndLine":15}},{"address":"aws_default_network_acl.covidshield","mode":"managed","type":"aws_default_network_acl","name":"covidshield","provider_config_key":"aws","expressions":{"default_network_acl_id":{"references":["aws_vpc.covidshield"]},"egress":[{"action":{"constant_value":"allow"},"cidr_block":{"constant_value":"0.0.0.0/0"},"from_port":{"constant_value":0},"protocol":{"constant_value":-1},"rule_no":{"constant_value":100},"to_port":{"constant_value":0}}],"ingress":[{"action":{"constant_value":"deny"},"cidr_block":{"constant_value":"0.0.0.0/0"},"from_port":{"constant_value":22},"protocol":{"constant_value":"tcp"},"rule_no":{"constant_value":100},"to_port":{"constant_value":22}},{"action":{"constant_value":"deny"},"cidr_block":{"constant_value":"0.0.0.0/0"},"from_port":{"constant_value":3389},"protocol":{"constant_value":"tcp"},"rule_no":{"constant_value":200},"to_port":{"constant_value":3389}},{"action":{"constant_value":"allow"},"cidr_block":{"constant_value":"0.0.0.0/0"},"from_port":{"constant_value":0},"protocol":{"constant_value":-1},"rule_no":{"constant_value":300},"to_port":{"constant_value":0}}],"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":439,"EndLine":486}},{"address":"aws_ecr_lifecycle_policy.policy","mode":"managed","type":"aws_ecr_lifecycle_policy","name":"policy","provider_config_key":"aws","expressions":{"policy":{"constant_value":"{\n    \"rules\": [\n        {\n            \"rulePriority\": 1,\n            \"description\": \"Keep last 30 images\",\n            \"selection\": {\n                \"tagStatus\": \"tagged\",\n                \"tagPrefixList\": [\"v\"],\n                \"countType\": \"imageCountMoreThan\",\n                \"countNumber\": 30\n            },\n            \"action\": {\n                \"type\": \"expire\"\n            }\n        }\n    ]\n}\n"},"repository":{"references":["aws_ecr_repository.repository","each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.image_names"]},"raw_data":{"FileName":"ecr.tf","StartLine":15,"EndLine":38}},{"address":"aws_ecr_repository.repository","mode":"managed","type":"aws_ecr_repository","name":"repository","provider_config_key":"aws","expressions":{"image_scanning_configuration":[{"scan_on_push":{"constant_value":true}}],"image_tag_mutability":{"constant_value":"MUTABLE"},"name":{"references":["each.value"]}},"schema_version":0,"for_each_expression":{"references":["local.image_names"]},"raw_data":{"FileName":"ecr.tf","StartLine":5,"EndLine":13}},{"address":"aws_ecs_cluster.covidshield","mode":"managed","type":"aws_ecs_cluster","name":"covidshield","provider_config_key":"aws","expressions":{"name":{"references":["var.ecs_name"]},"setting":[{"name":{"constant_value":"containerInsights"},"value":{"constant_value":"enabled"}}],"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"ecs.tf","StartLine":5,"EndLine":16}},{"address":"aws_ecs_service.covidshield_key_retrieval","mode":"managed","type":"aws_ecs_service","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"cluster":{"references":["aws_ecs_cluster.covidshield"]},"deployment_controller":[{"type":{"constant_value":"CODE_DEPLOY"}}],"deployment_maximum_percent":{"constant_value":200},"deployment_minimum_healthy_percent":{"constant_value":50},"desired_count":{"references":["var.min_capacity"]},"health_check_grace_period_seconds":{"constant_value":60},"launch_type":{"constant_value":"FARGATE"},"load_balancer":[{"container_name":{"constant_value":"key-retrieval"},"container_port":{"constant_value":8001},"target_group_arn":{"references":["aws_lb_target_group.covidshield_key_retrieval"]}}],"name":{"references":["var.ecs_key_retrieval_name"]},"network_configuration":[{"assign_public_ip":{"constant_value":false},"security_groups":{"references":["aws_security_group.covidshield_key_retrieval"]},"subnets":{"references":["aws_subnet.covidshield_private"]}}],"platform_version":{"constant_value":"1.4.0"},"propagate_tags":{"constant_value":"SERVICE"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"task_definition":{"references":["aws_ecs_task_definition.covidshield_key_retrieval"]}},"schema_version":0,"depends_on":["aws_lb_listener.covidshield_key_retrieval"],"raw_data":{"FileName":"ecs.tf","StartLine":67,"EndLine":114}},{"address":"aws_ecs_service.covidshield_key_submission","mode":"managed","type":"aws_ecs_service","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"cluster":{"references":["aws_ecs_cluster.covidshield"]},"deployment_controller":[{"type":{"constant_value":"CODE_DEPLOY"}}],"deployment_maximum_percent":{"constant_value":200},"deployment_minimum_healthy_percent":{"constant_value":50},"desired_count":{"references":["var.min_capacity"]},"health_check_grace_period_seconds":{"constant_value":60},"launch_type":{"constant_value":"FARGATE"},"load_balancer":[{"container_name":{"constant_value":"key-submission"},"container_port":{"constant_value":8000},"target_group_arn":{"references":["aws_lb_target_group.covidshield_key_submission"]}}],"name":{"references":["var.ecs_key_submission_name"]},"network_configuration":[{"assign_public_ip":{"constant_value":false},"security_groups":{"references":["aws_security_group.covidshield_key_submission"]},"subnets":{"references":["aws_subnet.covidshield_private"]}}],"platform_version":{"constant_value":"1.4.0"},"propagate_tags":{"constant_value":"SERVICE"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"task_definition":{"references":["aws_ecs_task_definition.covidshield_key_submission"]}},"schema_version":0,"depends_on":["aws_lb_listener.covidshield_key_submission"],"raw_data":{"FileName":"ecs.tf","StartLine":201,"EndLine":247}},{"address":"aws_ecs_task_definition.covidshield_key_retrieval","mode":"managed","type":"aws_ecs_task_definition","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"container_definitions":{"references":["data.template_file.covidshield_key_retrieval_task"]},"cpu":{"references":["var.cpu_units"]},"execution_role_arn":{"references":["aws_iam_role.covidshield_key_retrieval"]},"family":{"references":["var.ecs_key_retrieval_name"]},"memory":{"references":["var.memory"]},"network_mode":{"constant_value":"awsvpc"},"requires_compatibilities":{"constant_value":["FARGATE"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"task_role_arn":{"references":["aws_iam_role.covidshield_key_retrieval"]}},"schema_version":1,"raw_data":{"FileName":"ecs.tf","StartLine":49,"EndLine":63}},{"address":"aws_ecs_task_definition.covidshield_key_submission","mode":"managed","type":"aws_ecs_task_definition","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"container_definitions":{"references":["data.template_file.covidshield_key_submission_task"]},"cpu":{"references":["var.cpu_units"]},"execution_role_arn":{"references":["aws_iam_role.covidshield_key_submission"]},"family":{"references":["var.ecs_key_submission_name"]},"memory":{"references":["var.memory"]},"network_mode":{"constant_value":"awsvpc"},"requires_compatibilities":{"constant_value":["FARGATE"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"task_role_arn":{"references":["aws_iam_role.covidshield_key_submission"]}},"schema_version":1,"raw_data":{"FileName":"ecs.tf","StartLine":183,"EndLine":197}},{"address":"aws_elasticache_replication_group.covidshield","mode":"managed","type":"aws_elasticache_replication_group","name":"covidshield","provider_config_key":"aws","expressions":{"apply_immediately":{"constant_value":true},"at_rest_encryption_enabled":{"constant_value":true},"automatic_failover_enabled":{"constant_value":true},"availability_zones":{"references":["data.aws_availability_zones.available","data.aws_availability_zones.available","data.aws_availability_zones.available"]},"node_type":{"constant_value":"cache.t3.small"},"number_cache_clusters":{"constant_value":3},"parameter_group_name":{"constant_value":"default.redis5.0"},"port":{"constant_value":6379},"replication_group_description":{"constant_value":"covidshield"},"replication_group_id":{"constant_value":"covidshield"},"security_group_ids":{"references":["aws_security_group.covidshield_redis[0]"]},"subnet_group_name":{"references":["aws_elasticache_subnet_group.covidshield[0]"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"transit_encryption_enabled":{"constant_value":true}},"schema_version":1,"count_expression":{"references":["var.feature_redis"]},"raw_data":{"FileName":"elasticache.tf","StartLine":7,"EndLine":26}},{"address":"aws_elasticache_subnet_group.covidshield","mode":"managed","type":"aws_elasticache_subnet_group","name":"covidshield","provider_config_key":"aws","expressions":{"name":{"constant_value":"covidshield"},"subnet_ids":{"references":["aws_subnet.covidshield_private"]}},"schema_version":0,"count_expression":{"references":["var.feature_redis"]},"raw_data":{"FileName":"elasticache.tf","StartLine":1,"EndLine":5}},{"address":"aws_flow_log.vpc_flow_logs","mode":"managed","type":"aws_flow_log","name":"vpc_flow_logs","provider_config_key":"aws","expressions":{"iam_role_arn":{"references":["aws_iam_role.vpc_flow_logs"]},"log_destination":{"references":["aws_cloudwatch_log_group.vpc_flow_logs"]},"traffic_type":{"constant_value":"ALL"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"vpc_flow_log.tf","StartLine":1,"EndLine":6}},{"address":"aws_iam_policy.covidshield_secrets_manager_key_retrieval","mode":"managed","type":"aws_iam_policy","name":"covidshield_secrets_manager_key_retrieval","provider_config_key":"aws","expressions":{"name":{"constant_value":"CovidShieldSecretsManagerKeyRetrieval"},"path":{"constant_value":"/"},"policy":{"references":["data.aws_iam_policy_document.covidshield_secrets_manager_key_retrieval"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":34,"EndLine":38}},{"address":"aws_iam_policy.covidshield_secrets_manager_key_submission","mode":"managed","type":"aws_iam_policy","name":"covidshield_secrets_manager_key_submission","provider_config_key":"aws","expressions":{"name":{"constant_value":"CovidShieldSecretsManagerKeySubmission"},"path":{"constant_value":"/"},"policy":{"references":["data.aws_iam_policy_document.covidshield_secrets_manager_key_submission"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":80,"EndLine":84}},{"address":"aws_iam_role.codedeploy","mode":"managed","type":"aws_iam_role","name":"codedeploy","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.assume_role_policy_codedeploy"]},"name":{"constant_value":"codedeploy"},"path":{"constant_value":"/"}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":110,"EndLine":114}},{"address":"aws_iam_role.covidshield_key_retrieval","mode":"managed","type":"aws_iam_role","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.covidshield"]},"name":{"references":["var.ecs_key_retrieval_name"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":40,"EndLine":48}},{"address":"aws_iam_role.covidshield_key_submission","mode":"managed","type":"aws_iam_role","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"assume_role_policy":{"references":["data.aws_iam_policy_document.covidshield"]},"name":{"references":["var.ecs_key_submission_name"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":86,"EndLine":94}},{"address":"aws_iam_role.firehose_waf_logs","mode":"managed","type":"aws_iam_role","name":"firehose_waf_logs","provider_config_key":"aws","expressions":{"assume_role_policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"firehose.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n"},"name":{"constant_value":"firehose_waf_logs"}},"schema_version":0,"raw_data":{"FileName":"kinesis.tf","StartLine":4,"EndLine":22}},{"address":"aws_iam_role.lambda_validate_deploy","mode":"managed","type":"aws_iam_role","name":"lambda_validate_deploy","provider_config_key":"aws","expressions":{"assume_role_policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"lambda.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n"},"name":{"constant_value":"lambda-validate-deploy"}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":135,"EndLine":153}},{"address":"aws_iam_role.vpc_flow_logs","mode":"managed","type":"aws_iam_role","name":"vpc_flow_logs","provider_config_key":"aws","expressions":{"assume_role_policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Sid\": \"\",\n      \"Effect\": \"Allow\",\n      \"Principal\": {\n        \"Service\": \"vpc-flow-logs.amazonaws.com\"\n      },\n      \"Action\": \"sts:AssumeRole\"\n    }\n  ]\n}\n"},"name":{"constant_value":"vpc_flow_logs"}},"schema_version":0,"raw_data":{"FileName":"vpc_flow_log.tf","StartLine":14,"EndLine":32}},{"address":"aws_iam_role_policy.firehose_waf_logs","mode":"managed","type":"aws_iam_role_policy","name":"firehose_waf_logs","provider_config_key":"aws","expressions":{"name":{"constant_value":"firehose-waf-logs-policy"},"policy":{"references":["aws_s3_bucket.firehose_waf_logs","aws_s3_bucket.firehose_waf_logs"]},"role":{"references":["aws_iam_role.firehose_waf_logs"]}},"schema_version":0,"raw_data":{"FileName":"kinesis.tf","StartLine":27,"EndLine":58}},{"address":"aws_iam_role_policy.lambda_validate_codedeploy","mode":"managed","type":"aws_iam_role_policy","name":"lambda_validate_codedeploy","provider_config_key":"aws","expressions":{"name":{"constant_value":"LambdaValidateCodeDeploy"},"policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"codedeploy:PutLifecycleEventHookExecutionStatus\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"},"role":{"references":["aws_iam_role.lambda_validate_deploy"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":155,"EndLine":173}},{"address":"aws_iam_role_policy.vpc_flow_logs","mode":"managed","type":"aws_iam_role_policy","name":"vpc_flow_logs","provider_config_key":"aws","expressions":{"name":{"constant_value":"vpc_flow_logs"},"policy":{"constant_value":"{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": [\n        \"logs:CreateLogGroup\",\n        \"logs:CreateLogStream\",\n        \"logs:PutLogEvents\",\n        \"logs:DescribeLogGroups\",\n        \"logs:DescribeLogStreams\"\n      ],\n      \"Effect\": \"Allow\",\n      \"Resource\": \"*\"\n    }\n  ]\n}\n"},"role":{"references":["aws_iam_role.vpc_flow_logs"]}},"schema_version":0,"raw_data":{"FileName":"vpc_flow_log.tf","StartLine":34,"EndLine":56}},{"address":"aws_iam_role_policy_attachment.codedeploy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"codedeploy","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/AWSCodeDeployRoleForECS"},"role":{"references":["aws_iam_role.codedeploy"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":127,"EndLine":130}},{"address":"aws_iam_role_policy_attachment.ecs_task_execution_key_retrieval","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_task_execution_key_retrieval","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"},"role":{"references":["aws_iam_role.covidshield_key_retrieval"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":50,"EndLine":53}},{"address":"aws_iam_role_policy_attachment.ecs_task_execution_key_submission","mode":"managed","type":"aws_iam_role_policy_attachment","name":"ecs_task_execution_key_submission","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"},"role":{"references":["aws_iam_role.covidshield_key_submission"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":96,"EndLine":99}},{"address":"aws_iam_role_policy_attachment.lambda_validate_deploy","mode":"managed","type":"aws_iam_role_policy_attachment","name":"lambda_validate_deploy","provider_config_key":"aws","expressions":{"policy_arn":{"constant_value":"arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"},"role":{"references":["aws_iam_role.lambda_validate_deploy"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":175,"EndLine":178}},{"address":"aws_iam_role_policy_attachment.secrets_manager_key_retrieval","mode":"managed","type":"aws_iam_role_policy_attachment","name":"secrets_manager_key_retrieval","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.covidshield_secrets_manager_key_retrieval"]},"role":{"references":["aws_iam_role.covidshield_key_retrieval"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":55,"EndLine":58}},{"address":"aws_iam_role_policy_attachment.secrets_manager_key_submission","mode":"managed","type":"aws_iam_role_policy_attachment","name":"secrets_manager_key_submission","provider_config_key":"aws","expressions":{"policy_arn":{"references":["aws_iam_policy.covidshield_secrets_manager_key_submission"]},"role":{"references":["aws_iam_role.covidshield_key_submission"]}},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":101,"EndLine":104}},{"address":"aws_internet_gateway.covidshield","mode":"managed","type":"aws_internet_gateway","name":"covidshield","provider_config_key":"aws","expressions":{"tags":{"references":["var.vpc_name","var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":100,"EndLine":107}},{"address":"aws_kinesis_firehose_delivery_stream.firehose_waf_logs","mode":"managed","type":"aws_kinesis_firehose_delivery_stream","name":"firehose_waf_logs","provider_config_key":"aws","expressions":{"destination":{"constant_value":"s3"},"name":{"constant_value":"aws-waf-logs-covid-shield"},"s3_configuration":[{"bucket_arn":{"references":["aws_s3_bucket.firehose_waf_logs"]},"role_arn":{"references":["aws_iam_role.firehose_waf_logs"]}}],"server_side_encryption":[{"enabled":{"constant_value":true}}]},"schema_version":1,"raw_data":{"FileName":"kinesis.tf","StartLine":63,"EndLine":74}},{"address":"aws_kinesis_firehose_delivery_stream.firehose_waf_logs_us_east","mode":"managed","type":"aws_kinesis_firehose_delivery_stream","name":"firehose_waf_logs_us_east","provider_config_key":"aws.us-east-1","expressions":{"destination":{"constant_value":"s3"},"name":{"constant_value":"aws-waf-logs-covid-shield-us-east"},"s3_configuration":[{"bucket_arn":{"references":["aws_s3_bucket.firehose_waf_logs"]},"role_arn":{"references":["aws_iam_role.firehose_waf_logs"]}}],"server_side_encryption":[{"enabled":{"constant_value":true}}]},"schema_version":1,"raw_data":{"FileName":"kinesis.tf","StartLine":76,"EndLine":89}},{"address":"aws_kms_key.cw","mode":"managed","type":"aws_kms_key","name":"cw","provider_config_key":"aws","expressions":{"description":{"constant_value":"CloudWatch Log Group Key"},"enable_key_rotation":{"constant_value":true},"policy":{"references":["data.aws_caller_identity.current"]}},"schema_version":0,"raw_data":{"FileName":"kms.tf","StartLine":3,"EndLine":48}},{"address":"aws_kms_key.cw_us_east","mode":"managed","type":"aws_kms_key","name":"cw_us_east","provider_config_key":"aws.us-east-1","expressions":{"description":{"constant_value":"CloudWatch Log Group Key"},"enable_key_rotation":{"constant_value":true},"policy":{"references":["data.aws_caller_identity.current"]}},"schema_version":0,"raw_data":{"FileName":"kms.tf","StartLine":50,"EndLine":97}},{"address":"aws_lambda_function.retrieval_lambda_validate_deploy","mode":"managed","type":"aws_lambda_function","name":"retrieval_lambda_validate_deploy","provider_config_key":"aws","expressions":{"environment":[{"variables":{"references":["aws_lb.covidshield_key_retrieval","var.cloudfront_custom_header"]}}],"filename":{"constant_value":"/tmp/lambda_validate_deploy.rb.zip"},"function_name":{"constant_value":"RetrievalValidateBeforeTraffic"},"handler":{"constant_value":"lambda_validate_deploy.handler"},"role":{"references":["aws_iam_role.lambda_validate_deploy"]},"runtime":{"constant_value":"ruby2.7"},"source_code_hash":{"references":["data.archive_file.lambda_validate_deploy"]}},"schema_version":0,"raw_data":{"FileName":"codedeploy.tf","StartLine":36,"EndLine":53}},{"address":"aws_lambda_function.submission_lambda_validate_deploy","mode":"managed","type":"aws_lambda_function","name":"submission_lambda_validate_deploy","provider_config_key":"aws","expressions":{"environment":[{"variables":{"references":["aws_lb.covidshield_key_submission"]}}],"filename":{"constant_value":"/tmp/lambda_validate_deploy.rb.zip"},"function_name":{"constant_value":"SubmissionValidateBeforeTraffic"},"handler":{"constant_value":"lambda_validate_deploy.handler"},"role":{"references":["aws_iam_role.lambda_validate_deploy"]},"runtime":{"constant_value":"ruby2.7"},"source_code_hash":{"references":["data.archive_file.lambda_validate_deploy"]}},"schema_version":0,"raw_data":{"FileName":"codedeploy.tf","StartLine":55,"EndLine":71}},{"address":"aws_lb.covidshield_key_retrieval","mode":"managed","type":"aws_lb","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"internal":{"constant_value":false},"load_balancer_type":{"constant_value":"application"},"name":{"constant_value":"covidshield-key-retrieval"},"security_groups":{"references":["aws_security_group.covidshield_load_balancer"]},"subnets":{"references":["aws_subnet.covidshield_public"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"lb.tf","StartLine":51,"EndLine":64}},{"address":"aws_lb.covidshield_key_submission","mode":"managed","type":"aws_lb","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"internal":{"constant_value":false},"load_balancer_type":{"constant_value":"application"},"name":{"constant_value":"covidshield-key-submission"},"security_groups":{"references":["aws_security_group.covidshield_load_balancer"]},"subnets":{"references":["aws_subnet.covidshield_public"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"lb.tf","StartLine":169,"EndLine":182}},{"address":"aws_lb_listener.covidshield_key_retrieval","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.covidshield"]},"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.covidshield_key_retrieval"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.covidshield_key_retrieval"]},"port":{"constant_value":"443"},"protocol":{"constant_value":"HTTPS"},"ssl_policy":{"constant_value":"ELBSecurityPolicy-FS-1-2-Res-2019-08"}},"schema_version":0,"depends_on":["aws_acm_certificate.covidshield","aws_route53_record.covidshield_certificate_validation","aws_acm_certificate_validation.covidshield"],"raw_data":{"FileName":"lb.tf","StartLine":66,"EndLine":90}},{"address":"aws_lb_listener.covidshield_key_retrieval_test","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_retrieval_test","provider_config_key":"aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.covidshield"]},"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.covidshield_key_retrieval"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.covidshield_key_retrieval"]},"port":{"constant_value":"8443"},"protocol":{"constant_value":"HTTPS"},"ssl_policy":{"constant_value":"ELBSecurityPolicy-FS-1-2-Res-2019-08"}},"schema_version":0,"depends_on":["aws_acm_certificate.covidshield","aws_route53_record.covidshield_certificate_validation","aws_acm_certificate_validation.covidshield"],"raw_data":{"FileName":"lb.tf","StartLine":92,"EndLine":116}},{"address":"aws_lb_listener.covidshield_key_submission","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.covidshield"]},"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.covidshield_key_submission"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.covidshield_key_submission"]},"port":{"constant_value":"443"},"protocol":{"constant_value":"HTTPS"},"ssl_policy":{"constant_value":"ELBSecurityPolicy-FS-1-2-Res-2019-08"}},"schema_version":0,"depends_on":["aws_acm_certificate.covidshield","aws_route53_record.covidshield_certificate_validation","aws_acm_certificate_validation.covidshield"],"raw_data":{"FileName":"lb.tf","StartLine":184,"EndLine":208}},{"address":"aws_lb_listener.covidshield_key_submission_test","mode":"managed","type":"aws_lb_listener","name":"covidshield_key_submission_test","provider_config_key":"aws","expressions":{"certificate_arn":{"references":["aws_acm_certificate.covidshield"]},"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.covidshield_key_submission"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.covidshield_key_submission"]},"port":{"constant_value":"8443"},"protocol":{"constant_value":"HTTPS"},"ssl_policy":{"constant_value":"ELBSecurityPolicy-FS-1-2-Res-2019-08"}},"schema_version":0,"depends_on":["aws_acm_certificate.covidshield","aws_route53_record.covidshield_certificate_validation","aws_acm_certificate_validation.covidshield"],"raw_data":{"FileName":"lb.tf","StartLine":210,"EndLine":234}},{"address":"aws_lb_target_group.covidshield_key_retrieval","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"deregistration_delay":{"constant_value":30},"health_check":[{"enabled":{"constant_value":true},"healthy_threshold":{"constant_value":2},"interval":{"constant_value":10},"path":{"constant_value":"/services/ping"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":2}}],"name":{"constant_value":"covidshield-key-retrieval"},"port":{"constant_value":8001},"protocol":{"constant_value":"HTTP"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"target_type":{"constant_value":"ip"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"lb.tf","StartLine":5,"EndLine":26}},{"address":"aws_lb_target_group.covidshield_key_retrieval_2","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_retrieval_2","provider_config_key":"aws","expressions":{"deregistration_delay":{"constant_value":30},"health_check":[{"enabled":{"constant_value":true},"healthy_threshold":{"constant_value":2},"interval":{"constant_value":10},"path":{"constant_value":"/services/ping"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":2}}],"name":{"constant_value":"covidshield-key-retrieval-2"},"port":{"constant_value":8001},"protocol":{"constant_value":"HTTP"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"target_type":{"constant_value":"ip"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"lb.tf","StartLine":28,"EndLine":49}},{"address":"aws_lb_target_group.covidshield_key_submission","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"deregistration_delay":{"constant_value":30},"health_check":[{"enabled":{"constant_value":true},"healthy_threshold":{"constant_value":2},"interval":{"constant_value":10},"path":{"constant_value":"/services/ping"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":2}}],"name":{"constant_value":"covidshield-key-submission"},"port":{"constant_value":8000},"protocol":{"constant_value":"HTTP"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"target_type":{"constant_value":"ip"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"lb.tf","StartLine":122,"EndLine":144}},{"address":"aws_lb_target_group.covidshield_key_submission_2","mode":"managed","type":"aws_lb_target_group","name":"covidshield_key_submission_2","provider_config_key":"aws","expressions":{"deregistration_delay":{"constant_value":30},"health_check":[{"enabled":{"constant_value":true},"healthy_threshold":{"constant_value":2},"interval":{"constant_value":10},"path":{"constant_value":"/services/ping"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":2}}],"name":{"constant_value":"covidshield-key-submission-2"},"port":{"constant_value":8000},"protocol":{"constant_value":"HTTP"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"target_type":{"constant_value":"ip"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"lb.tf","StartLine":146,"EndLine":167}},{"address":"aws_rds_cluster.covidshield_server","mode":"managed","type":"aws_rds_cluster","name":"covidshield_server","provider_config_key":"aws","expressions":{"backup_retention_period":{"constant_value":1},"cluster_identifier":{"references":["var.rds_server_db_name"]},"database_name":{"references":["var.rds_server_db_name"]},"db_subnet_group_name":{"references":["aws_db_subnet_group.covidshield"]},"engine":{"constant_value":"aurora"},"final_snapshot_identifier":{"references":["random_string.random"]},"master_password":{"references":["var.rds_server_db_password"]},"master_username":{"references":["var.rds_server_db_user"]},"preferred_backup_window":{"constant_value":"07:00-09:00"},"storage_encrypted":{"constant_value":true},"tags":{"references":["var.rds_server_db_name","var.billing_tag_key","var.billing_tag_value"]},"vpc_security_group_ids":{"references":["aws_security_group.covidshield_database"]}},"schema_version":0,"raw_data":{"FileName":"rds.tf","StartLine":31,"EndLine":52}},{"address":"aws_rds_cluster_instance.covidshield_server_instances","mode":"managed","type":"aws_rds_cluster_instance","name":"covidshield_server_instances","provider_config_key":"aws","expressions":{"cluster_identifier":{"references":["aws_rds_cluster.covidshield_server"]},"db_subnet_group_name":{"references":["aws_db_subnet_group.covidshield"]},"identifier":{"references":["var.rds_server_db_name","count.index"]},"instance_class":{"references":["var.rds_server_instance_class"]},"performance_insights_enabled":{"constant_value":true},"tags":{"references":["var.rds_server_db_name","var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"count_expression":{"constant_value":3},"raw_data":{"FileName":"rds.tf","StartLine":17,"EndLine":29}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck","provider_config_key":"aws","expressions":{"failure_threshold":{"constant_value":"3"},"fqdn":{"references":["var.route53_zone_name"]},"port":{"constant_value":443},"request_interval":{"constant_value":"30"},"resource_path":{"constant_value":"/services/ping"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"type":{"constant_value":"HTTPS"}},"schema_version":0,"raw_data":{"FileName":"route53.tf","StartLine":29,"EndLine":40}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_ca_json","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck_ca_json","provider_config_key":"aws","expressions":{"failure_threshold":{"constant_value":"3"},"fqdn":{"references":["var.route53_zone_name"]},"port":{"constant_value":443},"regions":{"constant_value":["us-west-2","us-east-1","us-west-1"]},"request_interval":{"constant_value":"30"},"resource_path":{"constant_value":"/exposure-configuration/CA.json"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"type":{"constant_value":"HTTPS"}},"schema_version":0,"raw_data":{"FileName":"route53.tf","StartLine":42,"EndLine":54}},{"address":"aws_route53_health_check.covidshield_key_retrieval_healthcheck_region_json","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_retrieval_healthcheck_region_json","provider_config_key":"aws","expressions":{"failure_threshold":{"constant_value":"3"},"fqdn":{"references":["var.route53_zone_name"]},"port":{"constant_value":443},"regions":{"constant_value":["us-west-2","us-east-1","us-west-1"]},"request_interval":{"constant_value":"30"},"resource_path":{"constant_value":"/exposure-configuration/region.json"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"type":{"constant_value":"HTTPS"}},"schema_version":0,"raw_data":{"FileName":"route53.tf","StartLine":56,"EndLine":68}},{"address":"aws_route53_health_check.covidshield_key_submission_healthcheck","mode":"managed","type":"aws_route53_health_check","name":"covidshield_key_submission_healthcheck","provider_config_key":"aws","expressions":{"failure_threshold":{"constant_value":"3"},"fqdn":{"references":["var.route53_zone_name"]},"port":{"constant_value":443},"request_interval":{"constant_value":"30"},"resource_path":{"constant_value":"/services/ping"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"type":{"constant_value":"HTTPS"}},"schema_version":0,"raw_data":{"FileName":"route53.tf","StartLine":86,"EndLine":97}},{"address":"aws_route53_record.covidshield_certificate_validation","mode":"managed","type":"aws_route53_record","name":"covidshield_certificate_validation","provider_config_key":"aws","expressions":{"allow_overwrite":{"constant_value":true},"name":{"references":["each.value"]},"records":{"references":["each.value"]},"ttl":{"constant_value":60},"type":{"references":["each.value"]},"zone_id":{"references":["aws_route53_zone.covidshield"]}},"schema_version":2,"for_each_expression":{"references":["aws_acm_certificate.covidshield"]},"raw_data":{"FileName":"certificates.tf","StartLine":32,"EndLine":49}},{"address":"aws_route53_record.covidshield_key_retrieval","mode":"managed","type":"aws_route53_record","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"alias":[{"evaluate_target_health":{"constant_value":false},"name":{"references":["aws_cloudfront_distribution.key_retrieval_distribution"]},"zone_id":{"references":["aws_cloudfront_distribution.key_retrieval_distribution"]}}],"name":{"references":["aws_route53_zone.covidshield"]},"type":{"constant_value":"A"},"zone_id":{"references":["aws_route53_zone.covidshield"]}},"schema_version":2,"raw_data":{"FileName":"route53.tf","StartLine":17,"EndLine":27}},{"address":"aws_route53_record.covidshield_key_submission","mode":"managed","type":"aws_route53_record","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"alias":[{"evaluate_target_health":{"constant_value":false},"name":{"references":["aws_lb.covidshield_key_submission"]},"zone_id":{"references":["aws_lb.covidshield_key_submission"]}}],"name":{"references":["aws_route53_zone.covidshield"]},"type":{"constant_value":"A"},"zone_id":{"references":["aws_route53_zone.covidshield"]}},"schema_version":2,"raw_data":{"FileName":"route53.tf","StartLine":74,"EndLine":84}},{"address":"aws_route53_record.retrieval_covidshield_certificate_validation","mode":"managed","type":"aws_route53_record","name":"retrieval_covidshield_certificate_validation","provider_config_key":"aws","expressions":{"name":{"references":["each.value"]},"records":{"references":["each.value"]},"ttl":{"constant_value":60},"type":{"references":["each.value"]},"zone_id":{"references":["aws_route53_zone.covidshield"]}},"schema_version":2,"for_each_expression":{"references":["aws_acm_certificate.retrieval_covidshield"]},"raw_data":{"FileName":"certificates.tf","StartLine":51,"EndLine":68}},{"address":"aws_route53_zone.covidshield","mode":"managed","type":"aws_route53_zone","name":"covidshield","provider_config_key":"aws","expressions":{"name":{"references":["var.route53_zone_name"]},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"route53.tf","StartLine":5,"EndLine":11}},{"address":"aws_route_table.covidshield_public_subnet","mode":"managed","type":"aws_route_table","name":"covidshield_public_subnet","provider_config_key":"aws","expressions":{"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":158,"EndLine":170}},{"address":"aws_route_table_association.covidshield","mode":"managed","type":"aws_route_table_association","name":"covidshield","provider_config_key":"aws","expressions":{"route_table_id":{"references":["aws_route_table.covidshield_public_subnet"]},"subnet_id":{"references":["aws_subnet.covidshield_public","count.index"]}},"schema_version":0,"count_expression":{"constant_value":3},"raw_data":{"FileName":"networking.tf","StartLine":172,"EndLine":177}},{"address":"aws_s3_bucket.cloudfront_logs","mode":"managed","type":"aws_s3_bucket","name":"cloudfront_logs","provider_config_key":"aws","expressions":{"acl":{"constant_value":"private"},"bucket":{"references":["var.environment"]},"lifecycle_rule":[{"enabled":{"constant_value":true},"expiration":[{"days":{"constant_value":90}}]}],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]}]},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":66,"EndLine":84}},{"address":"aws_s3_bucket.exposure_config","mode":"managed","type":"aws_s3_bucket","name":"exposure_config","provider_config_key":"aws","expressions":{"bucket":{"references":["var.environment"]},"logging":[{"target_bucket":{"references":["aws_s3_bucket.exposure_config_logs"]}}],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]}]},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":5,"EndLine":18}},{"address":"aws_s3_bucket.exposure_config_logs","mode":"managed","type":"aws_s3_bucket","name":"exposure_config_logs","provider_config_key":"aws","expressions":{"acl":{"constant_value":"log-delivery-write"},"bucket":{"references":["var.environment"]},"lifecycle_rule":[{"enabled":{"constant_value":true},"expiration":[{"days":{"constant_value":90}}]}],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]}]},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":86,"EndLine":105}},{"address":"aws_s3_bucket.firehose_waf_logs","mode":"managed","type":"aws_s3_bucket","name":"firehose_waf_logs","provider_config_key":"aws","expressions":{"acl":{"constant_value":"private"},"bucket":{"references":["var.environment"]},"lifecycle_rule":[{"enabled":{"constant_value":true},"expiration":[{"days":{"constant_value":90}}]}],"server_side_encryption_configuration":[{"rule":[{"apply_server_side_encryption_by_default":[{"sse_algorithm":{"constant_value":"AES256"}}]}]}]},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":43,"EndLine":61}},{"address":"aws_s3_bucket_policy.exposure_config","mode":"managed","type":"aws_s3_bucket_policy","name":"exposure_config","provider_config_key":"aws","expressions":{"bucket":{"references":["aws_s3_bucket.exposure_config"]},"policy":{"references":["aws_cloudfront_origin_access_identity.origin_access_identity","aws_s3_bucket.exposure_config"]}},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":20,"EndLine":41}},{"address":"aws_s3_bucket_public_access_block.cloudfront_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"cloudfront_logs","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.cloudfront_logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":116,"EndLine":123}},{"address":"aws_s3_bucket_public_access_block.exposure_config_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"exposure_config_logs","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.exposure_config_logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":125,"EndLine":132}},{"address":"aws_s3_bucket_public_access_block.firehose_waf_logs","mode":"managed","type":"aws_s3_bucket_public_access_block","name":"firehose_waf_logs","provider_config_key":"aws","expressions":{"block_public_acls":{"constant_value":true},"block_public_policy":{"constant_value":true},"bucket":{"references":["aws_s3_bucket.firehose_waf_logs"]},"ignore_public_acls":{"constant_value":true},"restrict_public_buckets":{"constant_value":true}},"schema_version":0,"raw_data":{"FileName":"s3.tf","StartLine":107,"EndLine":114}},{"address":"aws_secretsmanager_secret.key_retrieval_env_ecdsa_key","mode":"managed","type":"aws_secretsmanager_secret","name":"key_retrieval_env_ecdsa_key","provider_config_key":"aws","expressions":{"name":{"references":["random_string.random"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":23,"EndLine":25}},{"address":"aws_secretsmanager_secret.key_retrieval_env_hmac_key","mode":"managed","type":"aws_secretsmanager_secret","name":"key_retrieval_env_hmac_key","provider_config_key":"aws","expressions":{"name":{"references":["random_string.random"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":14,"EndLine":16}},{"address":"aws_secretsmanager_secret.key_submission_env_key_claim_token","mode":"managed","type":"aws_secretsmanager_secret","name":"key_submission_env_key_claim_token","provider_config_key":"aws","expressions":{"name":{"references":["random_string.random"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":36,"EndLine":38}},{"address":"aws_secretsmanager_secret.key_submission_metrics_password","mode":"managed","type":"aws_secretsmanager_secret","name":"key_submission_metrics_password","provider_config_key":"aws","expressions":{"name":{"references":["random_string.random"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":46,"EndLine":48}},{"address":"aws_secretsmanager_secret.server_database_url","mode":"managed","type":"aws_secretsmanager_secret","name":"server_database_url","provider_config_key":"aws","expressions":{"name":{"references":["random_string.random"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":1,"EndLine":3}},{"address":"aws_secretsmanager_secret_version.key_retrieval_env_ecdsa_key","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_retrieval_env_ecdsa_key","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.key_retrieval_env_ecdsa_key"]},"secret_string":{"references":["var.ecs_task_key_retrieval_env_ecdsa_key"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":27,"EndLine":30}},{"address":"aws_secretsmanager_secret_version.key_retrieval_env_hmac_key","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_retrieval_env_hmac_key","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.key_retrieval_env_hmac_key"]},"secret_string":{"references":["var.ecs_task_key_retrieval_env_hmac_key"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":18,"EndLine":21}},{"address":"aws_secretsmanager_secret_version.key_submission_env_key_claim_token","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_submission_env_key_claim_token","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.key_submission_env_key_claim_token"]},"secret_string":{"references":["var.ecs_task_key_submission_env_key_claim_token"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":40,"EndLine":43}},{"address":"aws_secretsmanager_secret_version.key_submission_metrics_password","mode":"managed","type":"aws_secretsmanager_secret_version","name":"key_submission_metrics_password","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.key_submission_metrics_password"]},"secret_string":{"references":["var.metrics_password"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":50,"EndLine":53}},{"address":"aws_secretsmanager_secret_version.server_database_url","mode":"managed","type":"aws_secretsmanager_secret_version","name":"server_database_url","provider_config_key":"aws","expressions":{"secret_id":{"references":["aws_secretsmanager_secret.server_database_url"]},"secret_string":{"references":["var.rds_server_db_user","var.rds_server_db_password","aws_rds_cluster.covidshield_server","var.rds_server_db_name"]}},"schema_version":0,"raw_data":{"FileName":"secrets.tf","StartLine":5,"EndLine":8}},{"address":"aws_security_group.covidshield_database","mode":"managed","type":"aws_security_group","name":"covidshield_database","provider_config_key":"aws","expressions":{"description":{"constant_value":"Ingress - CovidShield Database"},"name":{"constant_value":"covidshield-database"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"raw_data":{"FileName":"networking.tf","StartLine":364,"EndLine":382}},{"address":"aws_security_group.covidshield_key_retrieval","mode":"managed","type":"aws_security_group","name":"covidshield_key_retrieval","provider_config_key":"aws","expressions":{"description":{"constant_value":"Ingress - CovidShield Key Retrieval App"},"name":{"constant_value":"covidshield-key-retrieval"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"raw_data":{"FileName":"networking.tf","StartLine":183,"EndLine":191}},{"address":"aws_security_group.covidshield_key_submission","mode":"managed","type":"aws_security_group","name":"covidshield_key_submission","provider_config_key":"aws","expressions":{"description":{"constant_value":"Ingress - CovidShield Key Submission App"},"name":{"constant_value":"covidshield-key-submission"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"raw_data":{"FileName":"networking.tf","StartLine":246,"EndLine":254}},{"address":"aws_security_group.covidshield_load_balancer","mode":"managed","type":"aws_security_group","name":"covidshield_load_balancer","provider_config_key":"aws","expressions":{"description":{"constant_value":"Ingress - CovidShield Load Balancer"},"name":{"constant_value":"covidshield-load-balancer"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"raw_data":{"FileName":"networking.tf","StartLine":309,"EndLine":362}},{"address":"aws_security_group.covidshield_redis","mode":"managed","type":"aws_security_group","name":"covidshield_redis","provider_config_key":"aws","expressions":{"description":{"constant_value":"Ingress - CovidShield Redis"},"name":{"constant_value":"covidshield-redis"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"count_expression":{"references":["var.feature_redis"]},"raw_data":{"FileName":"networking.tf","StartLine":384,"EndLine":403}},{"address":"aws_security_group.privatelink","mode":"managed","type":"aws_security_group","name":"privatelink","provider_config_key":"aws","expressions":{"description":{"constant_value":"privatelink endpoints"},"name":{"constant_value":"privatelink"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"raw_data":{"FileName":"networking.tf","StartLine":405,"EndLine":413}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_database","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_database","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Retrieval DB egress through privatelink"},"from_port":{"constant_value":3306},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_retrieval"]},"source_security_group_id":{"references":["aws_security_group.covidshield_database"]},"to_port":{"constant_value":3306},"type":{"constant_value":"egress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":225,"EndLine":233}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_privatelink","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Retrieval egress through privatelink"},"from_port":{"constant_value":443},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_retrieval"]},"source_security_group_id":{"references":["aws_security_group.privatelink"]},"to_port":{"constant_value":443},"type":{"constant_value":"egress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":203,"EndLine":211}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_redis","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_redis","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Retrieval Redis egress through privatelink"},"from_port":{"constant_value":6379},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_retrieval"]},"source_security_group_id":{"references":["aws_security_group.covidshield_redis[0]"]},"to_port":{"constant_value":6379},"type":{"constant_value":"egress"}},"schema_version":2,"count_expression":{"references":["var.feature_redis"]},"raw_data":{"FileName":"networking.tf","StartLine":235,"EndLine":244}},{"address":"aws_security_group_rule.covidshield_key_retrieval_egress_s3_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_egress_s3_privatelink","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Retrieval S3 egress through privatelink"},"from_port":{"constant_value":443},"prefix_list_ids":{"references":["aws_vpc_endpoint.s3"]},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_retrieval"]},"to_port":{"constant_value":443},"type":{"constant_value":"egress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":213,"EndLine":223}},{"address":"aws_security_group_rule.covidshield_key_retrieval_ingress_alb","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_retrieval_ingress_alb","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Retrieval Ingress ALB"},"from_port":{"constant_value":8001},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_retrieval"]},"source_security_group_id":{"references":["aws_security_group.covidshield_load_balancer"]},"to_port":{"constant_value":8001},"type":{"constant_value":"ingress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":193,"EndLine":201}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_database","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_database","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Submission DB egress through privatelink"},"from_port":{"constant_value":3306},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_submission"]},"source_security_group_id":{"references":["aws_security_group.covidshield_database"]},"to_port":{"constant_value":3306},"type":{"constant_value":"egress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":288,"EndLine":296}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_privatelink","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Submission egress through privatelink"},"from_port":{"constant_value":443},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_submission"]},"source_security_group_id":{"references":["aws_security_group.privatelink"]},"to_port":{"constant_value":443},"type":{"constant_value":"egress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":266,"EndLine":274}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_redis","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_redis","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Submission Redis egress through privatelink"},"from_port":{"constant_value":6379},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_submission"]},"source_security_group_id":{"references":["aws_security_group.covidshield_redis[0]"]},"to_port":{"constant_value":6379},"type":{"constant_value":"egress"}},"schema_version":2,"count_expression":{"references":["var.feature_redis"]},"raw_data":{"FileName":"networking.tf","StartLine":298,"EndLine":307}},{"address":"aws_security_group_rule.covidshield_key_submission_egress_s3_privatelink","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_egress_s3_privatelink","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Submission S3 egress through privatelink"},"from_port":{"constant_value":443},"prefix_list_ids":{"references":["aws_vpc_endpoint.s3"]},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_submission"]},"to_port":{"constant_value":443},"type":{"constant_value":"egress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":276,"EndLine":286}},{"address":"aws_security_group_rule.covidshield_key_submission_ingress_alb","mode":"managed","type":"aws_security_group_rule","name":"covidshield_key_submission_ingress_alb","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Submission ingress"},"from_port":{"constant_value":8000},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.covidshield_key_submission"]},"source_security_group_id":{"references":["aws_security_group.covidshield_load_balancer"]},"to_port":{"constant_value":8000},"type":{"constant_value":"ingress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":256,"EndLine":264}},{"address":"aws_security_group_rule.privatelink_retrieval_ingress","mode":"managed","type":"aws_security_group_rule","name":"privatelink_retrieval_ingress","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Retrieval ingress"},"from_port":{"constant_value":443},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.privatelink"]},"source_security_group_id":{"references":["aws_security_group.covidshield_key_retrieval"]},"to_port":{"constant_value":443},"type":{"constant_value":"ingress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":415,"EndLine":423}},{"address":"aws_security_group_rule.privatelink_submission_ingress","mode":"managed","type":"aws_security_group_rule","name":"privatelink_submission_ingress","provider_config_key":"aws","expressions":{"description":{"constant_value":"Security group rule for Submission ingressk"},"from_port":{"constant_value":443},"protocol":{"constant_value":"tcp"},"security_group_id":{"references":["aws_security_group.privatelink"]},"source_security_group_id":{"references":["aws_security_group.covidshield_key_submission"]},"to_port":{"constant_value":443},"type":{"constant_value":"ingress"}},"schema_version":2,"raw_data":{"FileName":"networking.tf","StartLine":425,"EndLine":433}},{"address":"aws_shield_protection.alb_covidshield_key_retrieval","mode":"managed","type":"aws_shield_protection","name":"alb_covidshield_key_retrieval","provider_config_key":"aws","expressions":{"name":{"constant_value":"alb_covidshield_key_retrieval"},"resource_arn":{"references":["aws_lb.covidshield_key_retrieval"]}},"schema_version":0,"count_expression":{"references":["var.feature_shield"]},"raw_data":{"FileName":"shield.tf","StartLine":16,"EndLine":20}},{"address":"aws_shield_protection.alb_covidshield_key_submission","mode":"managed","type":"aws_shield_protection","name":"alb_covidshield_key_submission","provider_config_key":"aws","expressions":{"name":{"constant_value":"alb_covidshield_key_submission"},"resource_arn":{"references":["aws_lb.covidshield_key_submission"]}},"schema_version":0,"count_expression":{"references":["var.feature_shield"]},"raw_data":{"FileName":"shield.tf","StartLine":22,"EndLine":26}},{"address":"aws_shield_protection.key_retrieval_distribution","mode":"managed","type":"aws_shield_protection","name":"key_retrieval_distribution","provider_config_key":"aws","expressions":{"name":{"constant_value":"key_retrieval_distribution"},"resource_arn":{"references":["aws_cloudfront_distribution.key_retrieval_distribution"]}},"schema_version":0,"count_expression":{"references":["var.feature_shield"]},"raw_data":{"FileName":"shield.tf","StartLine":2,"EndLine":6}},{"address":"aws_shield_protection.route53_covidshield","mode":"managed","type":"aws_shield_protection","name":"route53_covidshield","provider_config_key":"aws","expressions":{"name":{"constant_value":"route53_covidshield"},"resource_arn":{"references":["aws_route53_zone.covidshield"]}},"schema_version":0,"count_expression":{"references":["var.feature_shield"]},"raw_data":{"FileName":"shield.tf","StartLine":9,"EndLine":13}},{"address":"aws_sns_topic.alert_critical","mode":"managed","type":"aws_sns_topic","name":"alert_critical","provider_config_key":"aws","expressions":{"kms_master_key_id":{"references":["aws_kms_key.cw"]},"name":{"constant_value":"alert-critical"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"sns.tf","StartLine":10,"EndLine":17}},{"address":"aws_sns_topic.alert_critical_us_east","mode":"managed","type":"aws_sns_topic","name":"alert_critical_us_east","provider_config_key":"aws.us-east-1","expressions":{"kms_master_key_id":{"references":["aws_kms_key.cw_us_east"]},"name":{"constant_value":"alert-critical"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"sns.tf","StartLine":30,"EndLine":39}},{"address":"aws_sns_topic.alert_warning","mode":"managed","type":"aws_sns_topic","name":"alert_warning","provider_config_key":"aws","expressions":{"kms_master_key_id":{"references":["aws_kms_key.cw"]},"name":{"constant_value":"alert-warning"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"sns.tf","StartLine":1,"EndLine":8}},{"address":"aws_sns_topic.alert_warning_us_east","mode":"managed","type":"aws_sns_topic","name":"alert_warning_us_east","provider_config_key":"aws.us-east-1","expressions":{"kms_master_key_id":{"references":["aws_kms_key.cw_us_east"]},"name":{"constant_value":"alert-warning"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]}},"schema_version":0,"raw_data":{"FileName":"sns.tf","StartLine":19,"EndLine":28}},{"address":"aws_subnet.covidshield_private","mode":"managed","type":"aws_subnet","name":"covidshield_private","provider_config_key":"aws","expressions":{"availability_zone":{"references":["data.aws_availability_zones.available","count.index"]},"cidr_block":{"references":["var.vpc_cidr_block","count.index"]},"tags":{"references":["count.index","var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"count_expression":{"constant_value":3},"raw_data":{"FileName":"networking.tf","StartLine":113,"EndLine":125}},{"address":"aws_subnet.covidshield_public","mode":"managed","type":"aws_subnet","name":"covidshield_public","provider_config_key":"aws","expressions":{"availability_zone":{"references":["data.aws_availability_zones.available","count.index"]},"cidr_block":{"references":["var.vpc_cidr_block","count.index"]},"tags":{"references":["count.index","var.billing_tag_key","var.billing_tag_value"]},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":1,"count_expression":{"constant_value":3},"raw_data":{"FileName":"networking.tf","StartLine":127,"EndLine":139}},{"address":"aws_vpc.covidshield","mode":"managed","type":"aws_vpc","name":"covidshield","provider_config_key":"aws","expressions":{"cidr_block":{"references":["var.vpc_cidr_block"]},"enable_dns_hostnames":{"constant_value":true},"tags":{"references":["var.vpc_name","var.billing_tag_key","var.billing_tag_value"]}},"schema_version":1,"raw_data":{"FileName":"networking.tf","StartLine":9,"EndLine":17}},{"address":"aws_vpc_endpoint.ecr-api","mode":"managed","type":"aws_vpc_endpoint","name":"ecr-api","provider_config_key":"aws","expressions":{"private_dns_enabled":{"constant_value":true},"security_group_ids":{"references":["aws_security_group.privatelink"]},"service_name":{"references":["var.region"]},"subnet_ids":{"references":["data.aws_subnet_ids.ecr_endpoint_available"]},"vpc_endpoint_type":{"constant_value":"Interface"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":34,"EndLine":43}},{"address":"aws_vpc_endpoint.ecr-dkr","mode":"managed","type":"aws_vpc_endpoint","name":"ecr-dkr","provider_config_key":"aws","expressions":{"private_dns_enabled":{"constant_value":true},"security_group_ids":{"references":["aws_security_group.privatelink"]},"service_name":{"references":["var.region"]},"subnet_ids":{"references":["data.aws_subnet_ids.ecr_endpoint_available"]},"vpc_endpoint_type":{"constant_value":"Interface"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":23,"EndLine":32}},{"address":"aws_vpc_endpoint.kms","mode":"managed","type":"aws_vpc_endpoint","name":"kms","provider_config_key":"aws","expressions":{"private_dns_enabled":{"constant_value":true},"security_group_ids":{"references":["aws_security_group.privatelink"]},"service_name":{"references":["var.region"]},"subnet_ids":{"references":["aws_subnet.covidshield_private"]},"vpc_endpoint_type":{"constant_value":"Interface"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":45,"EndLine":54}},{"address":"aws_vpc_endpoint.logs","mode":"managed","type":"aws_vpc_endpoint","name":"logs","provider_config_key":"aws","expressions":{"private_dns_enabled":{"constant_value":true},"security_group_ids":{"references":["aws_security_group.privatelink"]},"service_name":{"references":["var.region"]},"subnet_ids":{"references":["aws_subnet.covidshield_private"]},"vpc_endpoint_type":{"constant_value":"Interface"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":74,"EndLine":83}},{"address":"aws_vpc_endpoint.monitoring","mode":"managed","type":"aws_vpc_endpoint","name":"monitoring","provider_config_key":"aws","expressions":{"private_dns_enabled":{"constant_value":true},"security_group_ids":{"references":["aws_security_group.privatelink"]},"service_name":{"references":["var.region"]},"subnet_ids":{"references":["aws_subnet.covidshield_private"]},"vpc_endpoint_type":{"constant_value":"Interface"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":85,"EndLine":94}},{"address":"aws_vpc_endpoint.s3","mode":"managed","type":"aws_vpc_endpoint","name":"s3","provider_config_key":"aws","expressions":{"route_table_ids":{"references":["aws_vpc.covidshield"]},"service_name":{"references":["var.region"]},"vpc_endpoint_type":{"constant_value":"Gateway"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":67,"EndLine":72}},{"address":"aws_vpc_endpoint.secretsmanager","mode":"managed","type":"aws_vpc_endpoint","name":"secretsmanager","provider_config_key":"aws","expressions":{"private_dns_enabled":{"constant_value":true},"security_group_ids":{"references":["aws_security_group.privatelink"]},"service_name":{"references":["var.region"]},"subnet_ids":{"references":["aws_subnet.covidshield_private"]},"vpc_endpoint_type":{"constant_value":"Interface"},"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":56,"EndLine":65}},{"address":"aws_wafv2_ip_set.new_key_claim","mode":"managed","type":"aws_wafv2_ip_set","name":"new_key_claim","provider_config_key":"aws","expressions":{"addresses":{"references":["var.new_key_claim_allow_list"]},"description":{"constant_value":"New Key Claim Allow IPs/CIDRs"},"ip_address_version":{"constant_value":"IPV4"},"name":{"constant_value":"new-key-claim"},"scope":{"constant_value":"REGIONAL"}},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":4,"EndLine":10}},{"address":"aws_wafv2_web_acl.key_retrieval","mode":"managed","type":"aws_wafv2_web_acl","name":"key_retrieval","provider_config_key":"aws","expressions":{"default_action":[{"block":[{}]}],"name":{"constant_value":"key_retrieval"},"rule":[{"action":[{"allow":[{}]}],"name":{"constant_value":"CloudFrontCustomHeader"},"priority":{"constant_value":201},"statement":[{"byte_match_statement":[{"field_to_match":[{"single_header":[{"name":{"constant_value":"covidshield"}}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"references":["var.cloudfront_custom_header"]},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"NONE"}}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"CloudFrontCustomHeader"},"sampled_requests_enabled":{"constant_value":false}}]}],"scope":{"constant_value":"REGIONAL"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"CloudFrontCustomHeader"},"sampled_requests_enabled":{"constant_value":false}}]},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":528,"EndLine":576}},{"address":"aws_wafv2_web_acl.key_retrieval_cdn","mode":"managed","type":"aws_wafv2_web_acl","name":"key_retrieval_cdn","provider_config_key":"aws.us-east-1","expressions":{"default_action":[{"allow":[{}]}],"name":{"constant_value":"key_retrieval_cdn"},"rule":[{"action":[{"block":[{}]}],"name":{"constant_value":"KeyRetrievalRateLimit"},"priority":{"constant_value":101},"statement":[{"rate_based_statement":[{"aggregate_key_type":{"constant_value":"IP"},"limit":{"constant_value":10000}}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeyRetrievalRateLimit"},"sampled_requests_enabled":{"constant_value":true}}]}],"scope":{"constant_value":"CLOUDFRONT"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"key_retrieval_cdn"},"sampled_requests_enabled":{"constant_value":false}}]},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":581,"EndLine":622}},{"address":"aws_wafv2_web_acl.key_submission","mode":"managed","type":"aws_wafv2_web_acl","name":"key_submission","provider_config_key":"aws","expressions":{"default_action":[{"block":[{}]}],"name":{"constant_value":"key_submission"},"rule":[{"name":{"constant_value":"AWSManagedRulesAmazonIpReputationList"},"override_action":[{"none":[{}]}],"priority":{"constant_value":1},"statement":[{"managed_rule_group_statement":[{"name":{"constant_value":"AWSManagedRulesAmazonIpReputationList"},"vendor_name":{"constant_value":"AWS"}}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"AWSManagedRulesAmazonIpReputationList"},"sampled_requests_enabled":{"constant_value":true}}]},{"name":{"constant_value":"AWSManagedRulesCommonRuleSet"},"override_action":[{"none":[{}]}],"priority":{"constant_value":2},"statement":[{"managed_rule_group_statement":[{"name":{"constant_value":"AWSManagedRulesCommonRuleSet"},"vendor_name":{"constant_value":"AWS"}}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"AWSManagedRulesCommonRuleSet"},"sampled_requests_enabled":{"constant_value":true}}]},{"name":{"constant_value":"AWSManagedRulesKnownBadInputsRuleSet"},"override_action":[{"none":[{}]}],"priority":{"constant_value":3},"statement":[{"managed_rule_group_statement":[{"name":{"constant_value":"AWSManagedRulesKnownBadInputsRuleSet"},"vendor_name":{"constant_value":"AWS"}}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"AWSManagedRulesKnownBadInputsRuleSet"},"sampled_requests_enabled":{"constant_value":true}}]},{"name":{"constant_value":"AWSManagedRulesLinuxRuleSet"},"override_action":[{"none":[{}]}],"priority":{"constant_value":4},"statement":[{"managed_rule_group_statement":[{"name":{"constant_value":"AWSManagedRulesLinuxRuleSet"},"vendor_name":{"constant_value":"AWS"}}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"AWSManagedRulesLinuxRuleSet"},"sampled_requests_enabled":{"constant_value":true}}]},{"name":{"constant_value":"AWSManagedRulesSQLiRuleSet"},"override_action":[{"none":[{}]}],"priority":{"constant_value":5},"statement":[{"managed_rule_group_statement":[{"name":{"constant_value":"AWSManagedRulesSQLiRuleSet"},"vendor_name":{"constant_value":"AWS"}}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"AWSManagedRulesSQLiRuleSet"},"sampled_requests_enabled":{"constant_value":true}}]},{"action":[{"block":[{}]}],"name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit01"},"priority":{"constant_value":101},"statement":[{"rate_based_statement":[{"aggregate_key_type":{"constant_value":"IP"},"limit":{"constant_value":100},"scope_down_statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/claim-key"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit01"},"sampled_requests_enabled":{"constant_value":true}}]},{"action":[{"block":[{}]}],"name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit02"},"priority":{"constant_value":102},"statement":[{"rate_based_statement":[{"aggregate_key_type":{"constant_value":"IP"},"limit":{"constant_value":100},"scope_down_statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/claim-key"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit02"},"sampled_requests_enabled":{"constant_value":true}}]},{"action":[{"block":[{}]}],"name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit03"},"priority":{"constant_value":103},"statement":[{"rate_based_statement":[{"aggregate_key_type":{"constant_value":"IP"},"limit":{"constant_value":100},"scope_down_statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/claim-key"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit03"},"sampled_requests_enabled":{"constant_value":true}}]},{"action":[{"block":[{}]}],"name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit04"},"priority":{"constant_value":104},"statement":[{"rate_based_statement":[{"aggregate_key_type":{"constant_value":"IP"},"limit":{"constant_value":100},"scope_down_statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/claim-key"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit04"},"sampled_requests_enabled":{"constant_value":true}}]},{"action":[{"block":[{}]}],"name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit05"},"priority":{"constant_value":105},"statement":[{"rate_based_statement":[{"aggregate_key_type":{"constant_value":"IP"},"limit":{"constant_value":100},"scope_down_statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/claim-key"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeySubmissionClaimKeyURIRateLimit05"},"sampled_requests_enabled":{"constant_value":true}}]},{"action":[{"allow":[{}]}],"name":{"constant_value":"KeySubmissionURIs"},"priority":{"constant_value":200},"statement":[{"or_statement":[{"statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"STARTS_WITH"},"search_string":{"constant_value":"/services/"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]},{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/upload"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]},{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"EXACTLY"},"search_string":{"constant_value":"/claim-key"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"KeySubmissionURIs"},"sampled_requests_enabled":{"constant_value":false}}]},{"action":[{"allow":[{}]}],"name":{"constant_value":"NewKeyClaimURI"},"priority":{"constant_value":201},"statement":[{"and_statement":[{"statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"STARTS_WITH"},"search_string":{"constant_value":"/new-key-claim"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]},{"byte_match_statement":[{"field_to_match":[{"single_header":[{"name":{"constant_value":"authorization"}}]}],"positional_constraint":{"constant_value":"STARTS_WITH"},"search_string":{"constant_value":"Bearer"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"NONE"}}]}]},{"ip_set_reference_statement":[{"arn":{"references":["aws_wafv2_ip_set.new_key_claim"]}}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"NewKeyClaimURI"},"sampled_requests_enabled":{"constant_value":false}}]},{"action":[{"allow":[{}]}],"name":{"constant_value":"ClearKeysURI"},"priority":{"constant_value":202},"statement":[{"and_statement":[{"statement":[{"byte_match_statement":[{"field_to_match":[{"uri_path":[{}]}],"positional_constraint":{"constant_value":"STARTS_WITH"},"search_string":{"constant_value":"/clear-diagnosis-keys"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"COMPRESS_WHITE_SPACE"}},{"priority":{"constant_value":2},"type":{"constant_value":"LOWERCASE"}}]}]},{"byte_match_statement":[{"field_to_match":[{"single_header":[{"name":{"constant_value":"authorization"}}]}],"positional_constraint":{"constant_value":"STARTS_WITH"},"search_string":{"constant_value":"Bearer"},"text_transformation":[{"priority":{"constant_value":1},"type":{"constant_value":"NONE"}}]}]},{"ip_set_reference_statement":[{"arn":{"references":["aws_wafv2_ip_set.new_key_claim"]}}]}]}]}],"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"ClearKeysURI"},"sampled_requests_enabled":{"constant_value":false}}]}],"scope":{"constant_value":"REGIONAL"},"tags":{"references":["var.billing_tag_key","var.billing_tag_value"]},"visibility_config":[{"cloudwatch_metrics_enabled":{"constant_value":true},"metric_name":{"constant_value":"key_submission"},"sampled_requests_enabled":{"constant_value":false}}]},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":15,"EndLine":523}},{"address":"aws_wafv2_web_acl_association.key_retrieval_assocation","mode":"managed","type":"aws_wafv2_web_acl_association","name":"key_retrieval_assocation","provider_config_key":"aws","expressions":{"resource_arn":{"references":["aws_lb.covidshield_key_retrieval"]},"web_acl_arn":{"references":["aws_wafv2_web_acl.key_retrieval"]}},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":632,"EndLine":635}},{"address":"aws_wafv2_web_acl_association.key_submission_assocation","mode":"managed","type":"aws_wafv2_web_acl_association","name":"key_submission_assocation","provider_config_key":"aws","expressions":{"resource_arn":{"references":["aws_lb.covidshield_key_submission"]},"web_acl_arn":{"references":["aws_wafv2_web_acl.key_submission"]}},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":627,"EndLine":630}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs","provider_config_key":"aws","expressions":{"log_destination_configs":{"references":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs"]},"redacted_fields":[{"single_header":[{"name":{"constant_value":"authorization"}}]}],"resource_arn":{"references":["aws_wafv2_web_acl.key_submission"]}},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":640,"EndLine":648}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs_retrieval","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs_retrieval","provider_config_key":"aws","expressions":{"log_destination_configs":{"references":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs"]},"resource_arn":{"references":["aws_wafv2_web_acl.key_retrieval"]}},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":650,"EndLine":653}},{"address":"aws_wafv2_web_acl_logging_configuration.firehose_waf_logs_retrieval_cdn","mode":"managed","type":"aws_wafv2_web_acl_logging_configuration","name":"firehose_waf_logs_retrieval_cdn","provider_config_key":"aws.us-east-1","expressions":{"log_destination_configs":{"references":["aws_kinesis_firehose_delivery_stream.firehose_waf_logs_us_east"]},"resource_arn":{"references":["aws_wafv2_web_acl.key_retrieval_cdn"]}},"schema_version":0,"raw_data":{"FileName":"waf.tf","StartLine":655,"EndLine":660}},{"address":"random_string.random","mode":"managed","type":"random_string","name":"random","provider_config_key":"random","expressions":{"length":{"constant_value":6},"special":{"constant_value":false},"upper":{"constant_value":false}},"schema_version":1,"raw_data":{"FileName":"rds.tf","StartLine":1,"EndLine":5}},{"address":"data.archive_file.lambda_validate_deploy","mode":"data","type":"archive_file","name":"lambda_validate_deploy","provider_config_key":"archive","expressions":{"output_path":{"constant_value":"/tmp/lambda_validate_deploy.rb.zip"},"source_file":{"constant_value":"lambda/lambda_validate_deploy.rb"},"type":{"constant_value":"zip"}},"schema_version":0,"raw_data":{"FileName":"codedeploy.tf","StartLine":30,"EndLine":34}},{"address":"data.aws_availability_zones.available","mode":"data","type":"aws_availability_zones","name":"available","provider_config_key":"aws","expressions":{"state":{"constant_value":"available"}},"schema_version":0,"raw_data":{"FileName":"networking.tf","StartLine":5,"EndLine":7}},{"address":"data.aws_caller_identity.current","mode":"data","type":"aws_caller_identity","name":"current","provider_config_key":"aws","schema_version":0,"raw_data":{"FileName":"kms.tf","StartLine":1,"EndLine":1}},{"address":"data.aws_iam_policy_document.assume_role_policy_codedeploy","mode":"data","type":"aws_iam_policy_document","name":"assume_role_policy_codedeploy","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"principals":[{"identifiers":{"constant_value":["codedeploy.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":116,"EndLine":125}},{"address":"data.aws_iam_policy_document.covidshield","mode":"data","type":"aws_iam_policy_document","name":"covidshield","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["sts:AssumeRole"]},"principals":[{"identifiers":{"constant_value":["ecs-tasks.amazonaws.com"]},"type":{"constant_value":"Service"}}]}]},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":1,"EndLine":10}},{"address":"data.aws_iam_policy_document.covidshield_secrets_manager_key_retrieval","mode":"data","type":"aws_iam_policy_document","name":"covidshield_secrets_manager_key_retrieval","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["secretsmanager:GetSecretValue"]},"effect":{"constant_value":"Allow"},"resources":{"references":["aws_secretsmanager_secret.key_submission_env_key_claim_token","aws_secretsmanager_secret.key_retrieval_env_hmac_key","aws_secretsmanager_secret.key_retrieval_env_ecdsa_key","aws_secretsmanager_secret.server_database_url","aws_secretsmanager_secret.key_submission_metrics_password"]}}]},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":16,"EndLine":32}},{"address":"data.aws_iam_policy_document.covidshield_secrets_manager_key_submission","mode":"data","type":"aws_iam_policy_document","name":"covidshield_secrets_manager_key_submission","provider_config_key":"aws","expressions":{"statement":[{"actions":{"constant_value":["secretsmanager:GetSecretValue"]},"effect":{"constant_value":"Allow"},"resources":{"references":["aws_secretsmanager_secret.key_submission_env_key_claim_token","aws_secretsmanager_secret.server_database_url"]}}]},"schema_version":0,"raw_data":{"FileName":"iam.tf","StartLine":65,"EndLine":78}},{"address":"data.aws_subnet_ids.ecr_endpoint_available","mode":"data","type":"aws_subnet_ids","name":"ecr_endpoint_available","provider_config_key":"aws","expressions":{"filter":[{"name":{"constant_value":"tag:Access"},"values":{"constant_value":["private"]}},{"name":{"constant_value":"availability-zone"},"values":{"constant_value":["ca-central-1a","ca-central-1b"]}}],"vpc_id":{"references":["aws_vpc.covidshield"]}},"schema_version":0,"depends_on":["aws_subnet.covidshield_private"],"raw_data":{"FileName":"networking.tf","StartLine":141,"EndLine":152}},{"address":"data.template_file.covidshield_key_retrieval_task","mode":"data","type":"template_file","name":"covidshield_key_retrieval_task","provider_config_key":"template","expressions":{"template":{},"vars":{"references":["local.retrieval_repo","aws_cloudwatch_log_group.covidshield","var.region","var.ecs_key_retrieval_name","aws_secretsmanager_secret_version.key_retrieval_env_hmac_key","aws_secretsmanager_secret_version.key_submission_env_key_claim_token","aws_secretsmanager_secret_version.key_retrieval_env_ecdsa_key","aws_secretsmanager_secret_version.server_database_url","var.metric_provider","var.tracer_provider","var.environment","var.metrics_username","aws_secretsmanager_secret_version.key_submission_metrics_password"]}},"schema_version":0,"raw_data":{"FileName":"ecs.tf","StartLine":29,"EndLine":47}},{"address":"data.template_file.covidshield_key_submission_task","mode":"data","type":"template_file","name":"covidshield_key_submission_task","provider_config_key":"template","expressions":{"template":{},"vars":{"references":["local.submission_repo","aws_cloudwatch_log_group.covidshield","var.region","var.ecs_key_submission_name","aws_secretsmanager_secret_version.key_submission_env_key_claim_token","aws_secretsmanager_secret_version.server_database_url","var.metric_provider","var.tracer_provider","var.environment","var.enable_test_tools"]}},"schema_version":0,"raw_data":{"FileName":"ecs.tf","StartLine":166,"EndLine":181}}],"module_calls":{"covid-shield-retrieval":{"source":"./modules/codedeploy","expressions":{"action_on_timeout":{"references":["var.manual_deploy_enabled"]},"aws_lb_target_group_blue_name":{"references":["aws_lb_target_group.covidshield_key_retrieval"]},"aws_lb_target_group_green_name":{"references":["aws_lb_target_group.covidshield_key_retrieval_2"]},"cluster_name":{"references":["aws_ecs_cluster.covidshield"]},"codedeploy_service_role_arn":{"references":["aws_iam_role.codedeploy"]},"ecs_service_name":{"references":["aws_ecs_service.covidshield_key_retrieval"]},"lb_listener_arns":{"references":["aws_lb_listener.covidshield_key_retrieval"]},"termination_wait_time_in_minutes":{"references":["var.termination_wait_time_in_minutes"]},"test_lb_listener_arns":{"references":["aws_lb_listener.covidshield_key_retrieval_test"]}},"module":{"resources":[{"address":"aws_codedeploy_app.app","mode":"managed","type":"aws_codedeploy_app","name":"app","provider_config_key":"covid-shield-retrieval:aws","expressions":{"compute_platform":{"constant_value":"ECS"},"name":{"references":["var.cluster_name","var.ecs_service_name"]}},"schema_version":0,"raw_data":{"FileName":"modules/codedeploy/main.tf","StartLine":1,"EndLine":4}},{"address":"aws_codedeploy_deployment_group.app","mode":"managed","type":"aws_codedeploy_deployment_group","name":"app","provider_config_key":"covid-shield-retrieval:aws","expressions":{"app_name":{"references":["aws_codedeploy_app.app"]},"auto_rollback_configuration":[{"enabled":{"constant_value":true},"events":{"constant_value":["DEPLOYMENT_FAILURE"]}}],"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":{"references":["var.action_on_timeout"]}}],"terminate_blue_instances_on_deployment_success":[{"action":{"constant_value":"TERMINATE"},"termination_wait_time_in_minutes":{"references":["var.termination_wait_time_in_minutes"]}}]}],"deployment_config_name":{"constant_value":"CodeDeployDefault.ECSAllAtOnce"},"deployment_group_name":{"references":["var.cluster_name","var.ecs_service_name"]},"deployment_style":[{"deployment_option":{"constant_value":"WITH_TRAFFIC_CONTROL"},"deployment_type":{"constant_value":"BLUE_GREEN"}}],"ecs_service":[{"cluster_name":{"references":["var.cluster_name"]},"service_name":{"references":["var.ecs_service_name"]}}],"load_balancer_info":[{"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":{"references":["var.lb_listener_arns"]}}],"target_group":[{"name":{"references":["var.aws_lb_target_group_blue_name"]}},{"name":{"references":["var.aws_lb_target_group_green_name"]}}],"test_traffic_route":[{"listener_arns":{"references":["var.test_lb_listener_arns"]}}]}]}],"service_role_arn":{"references":["var.codedeploy_service_role_arn"]}},"schema_version":0,"raw_data":{"FileName":"modules/codedeploy/main.tf","StartLine":6,"EndLine":59}}],"variables":{"action_on_timeout":{"description":"Action to take on deployment timeout"},"aws_lb_target_group_blue_name":{"description":"Name of the blue target group."},"aws_lb_target_group_green_name":{"description":"Name of the green target group."},"cluster_name":{"description":"The ECS cluster name"},"codedeploy_service_role_arn":{"description":"The codedeploy service role arn"},"ecs_service_name":{"description":"The ECS Service name."},"lb_listener_arns":{"description":"List of Amazon Resource Names (ARNs) of the load balancer listeners."},"termination_wait_time_in_minutes":{"description":"minutes to wait to terminate old deploy"},"test_lb_listener_arns":{"description":"List of Amazon Resource Names (ARNs) of the test load balancer listeners."}}},"raw_data":{"FileName":"codedeploy.tf","StartLine":1,"EndLine":12}},"covid-shield-submission":{"source":"./modules/codedeploy","expressions":{"action_on_timeout":{"references":["var.manual_deploy_enabled"]},"aws_lb_target_group_blue_name":{"references":["aws_lb_target_group.covidshield_key_submission"]},"aws_lb_target_group_green_name":{"references":["aws_lb_target_group.covidshield_key_submission_2"]},"cluster_name":{"references":["aws_ecs_cluster.covidshield"]},"codedeploy_service_role_arn":{"references":["aws_iam_role.codedeploy"]},"ecs_service_name":{"references":["aws_ecs_service.covidshield_key_submission"]},"lb_listener_arns":{"references":["aws_lb_listener.covidshield_key_submission"]},"termination_wait_time_in_minutes":{"references":["var.termination_wait_time_in_minutes"]},"test_lb_listener_arns":{"references":["aws_lb_listener.covidshield_key_submission_test"]}},"module":{"resources":[{"address":"aws_codedeploy_app.app","mode":"managed","type":"aws_codedeploy_app","name":"app","provider_config_key":"covid-shield-submission:aws","expressions":{"compute_platform":{"constant_value":"ECS"},"name":{"references":["var.cluster_name","var.ecs_service_name"]}},"schema_version":0,"raw_data":{"FileName":"modules/codedeploy/main.tf","StartLine":1,"EndLine":4}},{"address":"aws_codedeploy_deployment_group.app","mode":"managed","type":"aws_codedeploy_deployment_group","name":"app","provider_config_key":"covid-shield-submission:aws","expressions":{"app_name":{"references":["aws_codedeploy_app.app"]},"auto_rollback_configuration":[{"enabled":{"constant_value":true},"events":{"constant_value":["DEPLOYMENT_FAILURE"]}}],"blue_green_deployment_config":[{"deployment_ready_option":[{"action_on_timeout":{"references":["var.action_on_timeout"]}}],"terminate_blue_instances_on_deployment_success":[{"action":{"constant_value":"TERMINATE"},"termination_wait_time_in_minutes":{"references":["var.termination_wait_time_in_minutes"]}}]}],"deployment_config_name":{"constant_value":"CodeDeployDefault.ECSAllAtOnce"},"deployment_group_name":{"references":["var.cluster_name","var.ecs_service_name"]},"deployment_style":[{"deployment_option":{"constant_value":"WITH_TRAFFIC_CONTROL"},"deployment_type":{"constant_value":"BLUE_GREEN"}}],"ecs_service":[{"cluster_name":{"references":["var.cluster_name"]},"service_name":{"references":["var.ecs_service_name"]}}],"load_balancer_info":[{"target_group_pair_info":[{"prod_traffic_route":[{"listener_arns":{"references":["var.lb_listener_arns"]}}],"target_group":[{"name":{"references":["var.aws_lb_target_group_blue_name"]}},{"name":{"references":["var.aws_lb_target_group_green_name"]}}],"test_traffic_route":[{"listener_arns":{"references":["var.test_lb_listener_arns"]}}]}]}],"service_role_arn":{"references":["var.codedeploy_service_role_arn"]}},"schema_version":0,"raw_data":{"FileName":"modules/codedeploy/main.tf","StartLine":6,"EndLine":59}}],"variables":{"action_on_timeout":{"description":"Action to take on deployment timeout"},"aws_lb_target_group_blue_name":{"description":"Name of the blue target group."},"aws_lb_target_group_green_name":{"description":"Name of the green target group."},"cluster_name":{"description":"The ECS cluster name"},"codedeploy_service_role_arn":{"description":"The codedeploy service role arn"},"ecs_service_name":{"description":"The ECS Service name."},"lb_listener_arns":{"description":"List of Amazon Resource Names (ARNs) of the load balancer listeners."},"termination_wait_time_in_minutes":{"description":"minutes to wait to terminate old deploy"},"test_lb_listener_arns":{"description":"List of Amazon Resource Names (ARNs) of the test load balancer listeners."}}},"raw_data":{"FileName":"codedeploy.tf","StartLine":14,"EndLine":25}}},"variables":{"billing_tag_key":{},"billing_tag_value":{},"claimed_one_time_code_total_critical":{},"claimed_one_time_code_total_warn":{},"cloudfront_custom_header":{"description":"header to authenticate cloudfront to retrieval ALB"},"cloudwatch_log_group_name":{},"cpu_scale_metric":{"default":60},"cpu_units":{"default":2048},"diagnosis_key_total_critical":{},"diagnosis_key_total_warn":{},"ecs_key_retrieval_name":{},"ecs_key_submission_name":{},"ecs_name":{},"ecs_task_key_retrieval_env_ecdsa_key":{},"ecs_task_key_retrieval_env_hmac_key":{},"ecs_task_key_submission_env_key_claim_token":{},"enable_test_tools":{"default":false},"environment":{},"feature_redis":{},"feature_shield":{},"github_sha":{"default":""},"manual_deploy_enabled":{"default":false},"max_capacity":{"default":10},"memory":{"default":4096},"memory_scale_metric":{"default":60},"metric_provider":{},"metrics_password":{},"metrics_username":{},"min_capacity":{"default":3},"new_key_claim_allow_list":{"default":["0.0.0.0/1","128.0.0.0/1"]},"rds_db_subnet_group_name":{},"rds_server_allocated_storage":{},"rds_server_db_name":{},"rds_server_db_password":{},"rds_server_db_user":{},"rds_server_instance_class":{},"region":{},"retrieval_autoscale_enabled":{},"route53_zone_name":{},"scale_in_cooldown":{"default":60},"scale_out_cooldown":{"default":60},"submission_autoscale_enabled":{},"termination_wait_time_in_minutes":{"default":1,"description":"minutes to wait to terminate old deploy"},"tracer_provider":{},"unclaimed_one_time_code_total_critical":{},"unclaimed_one_time_code_total_warn":{},"vpc_cidr_block":{},"vpc_name":{}}}}}
