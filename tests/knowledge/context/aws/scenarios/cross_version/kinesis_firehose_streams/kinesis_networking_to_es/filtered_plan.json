{
    "terraform_version": "0.13.4",
    "format_version": "0.1",
    "configuration": {
        "provider_config": {
            "aws": {
                "name": "aws",
                "expressions": {
                    "region": {
                        "constant_value": "us-east-1"
                    }
                }
            }
        },
        "root_module": {
            "resources": [
                {
                    "address": "aws_elasticsearch_domain.test_cluster",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 68,
                        "EndLine": 86
                    }
                },
                {
                    "address": "aws_iam_role.firehose_role",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 89,
                        "EndLine": 107
                    }
                },
                {
                    "address": "aws_iam_role_policy.firehose-elasticsearch",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 109,
                        "EndLine": 145
                    }
                },
                {
                    "address": "aws_internet_gateway.gw",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 37,
                        "EndLine": 43
                    }
                },
                {
                    "address": "aws_kinesis_firehose_delivery_stream.test",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 152,
                        "EndLine": 173
                    }
                },
                {
                    "address": "aws_route_table.public-rtb",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 45,
                        "EndLine": 56
                    }
                },
                {
                    "address": "aws_route_table_association.public-rtb-assoc_1",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 58,
                        "EndLine": 61
                    }
                },
                {
                    "address": "aws_route_table_association.public-rtb-assoc_2",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 63,
                        "EndLine": 66
                    }
                },
                {
                    "address": "aws_s3_bucket.bucket",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 147,
                        "EndLine": 150
                    }
                },
                {
                    "address": "aws_security_group.nondefault",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 6,
                        "EndLine": 23
                    }
                },
                {
                    "address": "aws_subnet.nondefault_1",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 25,
                        "EndLine": 29
                    }
                },
                {
                    "address": "aws_subnet.nondefault_2",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 31,
                        "EndLine": 35
                    }
                },
                {
                    "address": "aws_vpc.nondefault",
                    "provider_config_key": "aws",
                    "raw_data": {
                        "FileName": "main.tf",
                        "StartLine": 2,
                        "EndLine": 4
                    }
                }
            ],
            "module_calls": {}
        }
    },
    "resource_changes": [
        {
            "address": "aws_elasticsearch_domain.test_cluster",
            "type": "aws_elasticsearch_domain",
            "name": "test_cluster",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "cluster_config": [
                        {
                            "dedicated_master_count": null,
                            "dedicated_master_enabled": null,
                            "dedicated_master_type": null,
                            "instance_count": 2,
                            "instance_type": "t2.small.elasticsearch",
                            "warm_count": null,
                            "warm_enabled": null,
                            "warm_type": null,
                            "zone_awareness_config": [],
                            "zone_awareness_enabled": true
                        }
                    ],
                    "domain_endpoint_options": [],
                    "domain_name": "es-test",
                    "elasticsearch_version": "1.5",
                    "encrypt_at_rest": [],
                    "log_publishing_options": [],
                    "node_to_node_encryption": [],
                    "tags": null,
                    "vpc_options": [
                        {
                            "availability_zones": null,
                            "security_group_ids": [
                                "aws_security_group.nondefault.id"
                            ],
                            "subnet_ids": [
                                "aws_subnet.nondefault_1.id",
                                "aws_subnet.nondefault_2.id"
                            ],
                            "vpc_id": null
                        }
                    ]
                },
                "after_unknown": {
                    "access_policies": true,
                    "arn": true,
                    "cluster_config": [
                        {
                            "zone_awareness_config": []
                        }
                    ],
                    "domain_endpoint_options": [],
                    "domain_id": true,
                    "encrypt_at_rest": [],
                    "id": true,
                    "log_publishing_options": [],
                    "node_to_node_encryption": [],
                    "tags_all": true,
                    "vpc_options": [
                        {
                            "security_group_ids": [
                                false
                            ],
                            "subnet_ids": [
                                false,
                                false
                            ]
                        }
                    ]
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_iam_role.firehose_role",
            "type": "aws_iam_role",
            "name": "firehose_role",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "assume_role_policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Action\": \"sts:AssumeRole\",\n      \"Principal\": {\n        \"Service\": \"firehose.amazonaws.com\"\n      },\n      \"Effect\": \"Allow\",\n      \"Sid\": \"\"\n    }\n  ]\n}\n",
                    "inline_policy": [],
                    "name": "firehose_test_role",
                    "path": "/",
                    "permissions_boundary": null,
                    "tags": null
                },
                "after_unknown": {
                    "arn": true,
                    "create_date": true,
                    "id": true,
                    "inline_policy": [],
                    "tags_all": true,
                    "unique_id": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_iam_role_policy.firehose-elasticsearch",
            "type": "aws_iam_role_policy",
            "name": "firehose-elasticsearch",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "name": "elasticsearch",
                    "policy": "{\n  \"Version\": \"2012-10-17\",\n  \"Statement\": [\n    {\n      \"Effect\": \"Allow\",\n      \"Action\": [\n        \"es:*\"\n      ],\n      \"Resource\": [\n        \"aws_elasticsearch_domain.test_cluster.arn\",\n        \"aws_elasticsearch_domain.test_cluster.arn/*\"\n      ]\n        },\n        {\n          \"Effect\": \"Allow\",\n          \"Action\": [\n            \"ec2:DescribeVpcs\",\n            \"ec2:DescribeVpcAttribute\",\n            \"ec2:DescribeSubnets\",\n            \"ec2:DescribeSecurityGroups\",\n            \"ec2:DescribeNetworkInterfaces\",\n            \"ec2:CreateNetworkInterface\",\n            \"ec2:CreateNetworkInterfacePermission\",\n            \"ec2:DeleteNetworkInterface\"\n          ],\n          \"Resource\": [\n            \"*\"\n          ]\n        }\n  ]\n}\n",
                    "role": "aws_iam_role.firehose_role.id"
                },
                "after_unknown": {
                    "id": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_internet_gateway.gw",
            "type": "aws_internet_gateway",
            "name": "gw",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "tags": {
                        "Name": "main"
                    },
                    "tags_all": {
                        "Name": "main"
                    },
                    "vpc_id": "aws_vpc.nondefault.id"
                },
                "after_unknown": {
                    "id": true,
                    "tags": {},
                    "tags_all": {}
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_kinesis_firehose_delivery_stream.test",
            "type": "aws_kinesis_firehose_delivery_stream",
            "name": "test",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "elasticsearch_configuration": [
                        {
                            "domain_arn": "aws_elasticsearch_domain.test_cluster.arn",
                            "vpc_config": [
                                {
                                    "security_group_ids": [
                                        "aws_security_group.nondefault.id"
                                    ],
                                    "subnet_ids": [
                                        "aws_subnet.nondefault_1.id",
                                        "aws_subnet.nondefault_2.id"
                                    ]
                                }
                            ]
                        }
                    ],
                    "name": "terraform-kinesis-firehose-es",
                    "server_side_encryption": [],
                    "tags": null
                },
                "after_unknown": {
                    "arn": true,
                    "elasticsearch_configuration": [
                        {
                            "vpc_config": [
                                {
                                    "security_group_ids": [
                                        false
                                    ],
                                    "subnet_ids": [
                                        false,
                                        false
                                    ]
                                }
                            ]
                        }
                    ],
                    "id": true,
                    "server_side_encryption": [],
                    "tags_all": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_route_table.public-rtb",
            "type": "aws_route_table",
            "name": "public-rtb",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "route": [
                        {
                            "carrier_gateway_id": null,
                            "cidr_block": "0.0.0.0/0",
                            "destination_prefix_list_id": null,
                            "egress_only_gateway_id": null,
                            "gateway_id": "aws_internet_gateway.gw.id",
                            "instance_id": null,
                            "ipv6_cidr_block": null,
                            "local_gateway_id": null,
                            "nat_gateway_id": null,
                            "network_interface_id": null,
                            "transit_gateway_id": null,
                            "vpc_endpoint_id": null,
                            "vpc_peering_connection_id": null
                        }
                    ],
                    "tags": {
                        "Name": "public-rtb"
                    },
                    "tags_all": {
                        "Name": "public-rtb"
                    },
                    "vpc_id": "aws_vpc.nondefault.id"
                },
                "after_unknown": {
                    "id": true,
                    "route": [
                        {}
                    ],
                    "tags": {},
                    "tags_all": {}
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_route_table_association.public-rtb-assoc_1",
            "type": "aws_route_table_association",
            "name": "public-rtb-assoc_1",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "route_table_id": "aws_route_table.public-rtb.id",
                    "subnet_id": "aws_subnet.nondefault_1.id"
                },
                "after_unknown": {
                    "id": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_route_table_association.public-rtb-assoc_2",
            "type": "aws_route_table_association",
            "name": "public-rtb-assoc_2",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "route_table_id": "aws_route_table.public-rtb.id",
                    "subnet_id": "aws_subnet.nondefault_2.id"
                },
                "after_unknown": {
                    "id": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_s3_bucket.bucket",
            "type": "aws_s3_bucket",
            "name": "bucket",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "acl": "private",
                    "bucket": "cloudrail-firehose-testing-kinesis",
                    "grant": [],
                    "logging": [],
                    "policy": null,
                    "server_side_encryption_configuration": [],
                    "tags": null,
                    "versioning": []
                },
                "after_unknown": {
                    "bucket_regional_domain_name": true,
                    "grant": [],
                    "id": true,
                    "logging": [],
                    "region": true,
                    "server_side_encryption_configuration": [],
                    "tags_all": true,
                    "versioning": []
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_security_group.nondefault",
            "type": "aws_security_group",
            "name": "nondefault",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "description_hashcode": "94908bee6fc312d3863709f30c61473f5d1fa70d5beaca239d7f8bd7d66d0b6c2097a04a76449d6e3f38553fc074d3cda8cf674ffac97348a9fa6340fe158552",
                    "egress": [
                        {
                            "cidr_blocks": [
                                "0.0.0.0/0"
                            ],
                            "description_hashcode": null,
                            "from_port": 0,
                            "protocol": "-1",
                            "security_groups": null,
                            "to_port": 0
                        }
                    ],
                    "ingress": [
                        {
                            "cidr_blocks": [
                                "0.0.0.0/0"
                            ],
                            "description_hashcode": null,
                            "from_port": 0,
                            "protocol": "-1",
                            "security_groups": null,
                            "to_port": 0
                        }
                    ],
                    "tags": null,
                    "vpc_id": "aws_vpc.nondefault.id"
                },
                "after_unknown": {
                    "egress": [
                        {
                            "cidr_blocks": [
                                false
                            ]
                        }
                    ],
                    "id": true,
                    "ingress": [
                        {
                            "cidr_blocks": [
                                false
                            ]
                        }
                    ],
                    "name": true,
                    "tags_all": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_subnet.nondefault_1",
            "type": "aws_subnet",
            "name": "nondefault_1",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "availability_zone": "us-east-1a",
                    "cidr_block": "10.1.1.128/25",
                    "map_public_ip_on_launch": false,
                    "tags": null,
                    "vpc_id": "aws_vpc.nondefault.id"
                },
                "after_unknown": {
                    "id": true,
                    "tags_all": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_subnet.nondefault_2",
            "type": "aws_subnet",
            "name": "nondefault_2",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "availability_zone": "us-east-1b",
                    "cidr_block": "10.1.1.0/25",
                    "map_public_ip_on_launch": false,
                    "tags": null,
                    "vpc_id": "aws_vpc.nondefault.id"
                },
                "after_unknown": {
                    "id": true,
                    "tags_all": true
                },
                "actions": [
                    "create"
                ]
            }
        },
        {
            "address": "aws_vpc.nondefault",
            "type": "aws_vpc",
            "name": "nondefault",
            "mode": "managed",
            "provider_name": "registry.terraform.io/hashicorp/aws",
            "change": {
                "before": null,
                "after": {
                    "assign_generated_ipv6_cidr_block": false,
                    "cidr_block": "10.1.1.0/24",
                    "enable_dns_support": true,
                    "tags": null
                },
                "after_unknown": {
                    "default_route_table_id": true,
                    "default_security_group_id": true,
                    "enable_dns_hostnames": true,
                    "id": true,
                    "ipv6_cidr_block": true,
                    "main_route_table_id": true,
                    "tags_all": true
                },
                "actions": [
                    "create"
                ]
            }
        }
    ],
    "checkov_results": {},
    "cloud_provider": "amazon_web_services",
    "handshake_version": "59",
    "managed_resources_summary": {
        "total": 13,
        "created": 13,
        "deleted": 0,
        "updated": 0
    },
    "variables": {}
}