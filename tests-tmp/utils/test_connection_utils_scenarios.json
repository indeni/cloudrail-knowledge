{
  "test_no_public_connection_exists": {
    "py/object": "cloudrail.knowledge.context.aws.redshift.redshift.RedshiftCluster",
    "name": "redshift-defaults-only",
    "region": "eu-central-1",
    "network_resource": {
      "py/object": "cloudrail.knowledge.context.aws.networking_config.network_resource.NetworkResource",
      "network_interfaces": [
        {
          "py/object": "cloudrail.knowledge.context.aws.ec2.network_interface.NetworkInterface",
          "eni_id": "eni-fk-3e55eee5-e7c7-491f-ab27-9bc4ade7a1a7",
          "subnet_id": "aws_subnet.nondefault_1.id",
          "primary_ip_address": "10.1.1.170",
          "secondary_ip_addresses": [],
          "public_ip_address": null,
          "ipv6_ip_addresses": [],
          "security_groups_ids": [],
          "description": "",
          "is_primary": true,
          "availability_zone": "eu-central-1a",
          "subnet": {
            "py/object": "cloudrail.knowledge.context.aws.ec2.subnet.Subnet",
            "subnet_id": "aws_subnet.nondefault_1.id",
            "map_public_ip_on_launch": false,
            "vpc_id": "aws_vpc.nondefault.id",
            "cidr_block": "10.1.1.128/25",
            "name": "aws_subnet.nondefault_1.id",
            "state": null,
            "availability_zone": "eu-central-1a",
            "route_table": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.route_table.RouteTable",
              "route_table_id": "rt-fk-fafe86c5-5215-4c6c-aa9a-6be0a89d62ca",
              "vpc_id": "aws_vpc.nondefault.id",
              "routes": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.route.Route",
                  "route_table_id": "rt-fk-fafe86c5-5215-4c6c-aa9a-6be0a89d62ca",
                  "target": "local",
                  "target_type": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.route.RouteTargetType"
                      },
                      {
                        "py/tuple": [
                          "GatewayId"
                        ]
                      }
                    ]
                  },
                  "destination": "10.1.1.0/24",
                  "peering_connection": null
                }
              ],
              "name": "rt-fk-fafe86c5-5215-4c6c-aa9a-6be0a89d62ca",
              "_aliases": [
                "rt-fk-fafe86c5-5215-4c6c-aa9a-6be0a89d62ca",
                "aws_vpc.nondefault.default_route_table_id",
                "aws_vpc.nondefault.main_route_table_id"
              ]
            },
            "network_acl": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl.NetworkAcl",
              "network_acl_id": "nacl-fk-630d68dc-48a3-48f8-8204-b85960a6201b",
              "vpc_id": "aws_vpc.nondefault.id",
              "is_default": true,
              "name": "nacl-fk-630d68dc-48a3-48f8-8204-b85960a6201b",
              "subnets": [],
              "inbound_rules": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.NetworkAclRule",
                  "network_acl_id": "nacl-fk-630d68dc-48a3-48f8-8204-b85960a6201b",
                  "cidr_block": "0.0.0.0/0",
                  "from_port": 0,
                  "to_port": 65535,
                  "rule_action": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.RuleAction"
                      },
                      {
                        "py/tuple": [
                          "allow"
                        ]
                      }
                    ]
                  },
                  "rule_number": 100,
                  "rule_type": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.RuleType"
                      },
                      {
                        "py/tuple": [
                          "inbound"
                        ]
                      }
                    ]
                  }
                }
              ],
              "outbound_rules": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.NetworkAclRule",
                  "network_acl_id": "nacl-fk-630d68dc-48a3-48f8-8204-b85960a6201b",
                  "cidr_block": "0.0.0.0/0",
                  "from_port": 0,
                  "to_port": 65535,
                  "rule_action": {
                    "py/id": 17
                  },
                  "rule_number": 100,
                  "rule_type": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.RuleType"
                      },
                      {
                        "py/tuple": [
                          "outbound"
                        ]
                      }
                    ]
                  }
                }
              ]
            },
            "vpc": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.vpc.Vpc",
              "vpc_id": "aws_vpc.nondefault.id",
              "cidr_block": [
                "10.1.1.0/24"
              ],
              "name": "aws_vpc.nondefault.id",
              "region": "us-east-1",
              "account": "111111111111",
              "friendly_name": "aws_vpc.nondefault.id",
              "main_route_table_id": "aws_vpc.nondefault.main_route_table_id",
              "default_route_table_id": "rt-fk-fafe86c5-5215-4c6c-aa9a-6be0a89d62ca",
              "is_default": false,
              "default_route_table": {
                "py/id": 8
              },
              "main_route_table": {
                "py/id": 8
              },
              "endpoints": [],
              "default_security_group": {
                "py/object": "cloudrail.knowledge.context.aws.ec2.security_group.SecurityGroup",
                "security_group_id": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9",
                "name": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9",
                "description": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9",
                "vpc_id": "aws_vpc.nondefault.id",
                "inbound_permissions": [
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                    "from_port": 0,
                    "to_port": 65535,
                    "ip_protocol": "-1",
                    "property_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRulePropertyType"
                        },
                        {
                          "py/tuple": [
                            {
                              "py/tuple": [
                                "UserIdGroupPairs",
                                "GroupId"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    "property_value": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9",
                    "connection_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.ConnectionType"
                        },
                        {
                          "py/tuple": [
                            "inbound"
                          ]
                        }
                      ]
                    },
                    "security_group_id": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9"
                  }
                ],
                "outbound_permissions": [
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                    "from_port": 0,
                    "to_port": 65535,
                    "ip_protocol": "-1",
                    "property_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRulePropertyType"
                        },
                        {
                          "py/tuple": [
                            {
                              "py/tuple": [
                                "IpRanges",
                                "CidrIp"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    "property_value": "0.0.0.0/0",
                    "connection_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.ConnectionType"
                        },
                        {
                          "py/tuple": [
                            "outbound"
                          ]
                        }
                      ]
                    },
                    "security_group_id": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9"
                  },
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                    "from_port": 0,
                    "to_port": 65535,
                    "ip_protocol": "-1",
                    "property_type": {
                      "py/id": 32
                    },
                    "property_value": "::/0",
                    "connection_type": {
                      "py/id": 33
                    },
                    "security_group_id": "sg-fk-6b3b1b4f-0468-4d91-8d84-a7321925e4a9"
                  }
                ],
                "is_default": true,
                "vpc": {
                  "py/id": 22
                }
              }
            }
          },
          "security_groups": [
            {
              "py/id": 25
            }
          ],
          "owner": {
            "py/id": 0
          },
          "inbound_connections": [],
          "outbound_connections": []
        },
        {
          "py/object": "cloudrail.knowledge.context.aws.ec2.network_interface.NetworkInterface",
          "eni_id": "eni-fk-bfdff472-2f7d-4589-823b-ee2139d3da33",
          "subnet_id": "aws_subnet.nondefault_2.id",
          "primary_ip_address": "10.1.1.42",
          "secondary_ip_addresses": [],
          "public_ip_address": null,
          "ipv6_ip_addresses": [],
          "security_groups_ids": [],
          "description": "",
          "is_primary": true,
          "availability_zone": "eu-central-1b",
          "subnet": {
            "py/object": "cloudrail.knowledge.context.aws.ec2.subnet.Subnet",
            "subnet_id": "aws_subnet.nondefault_2.id",
            "map_public_ip_on_launch": false,
            "vpc_id": "aws_vpc.nondefault.id",
            "cidr_block": "10.1.1.0/25",
            "name": "aws_subnet.nondefault_2.id",
            "state": null,
            "availability_zone": "eu-central-1b",
            "route_table": {
              "py/id": 8
            },
            "network_acl": {
              "py/id": 13
            },
            "vpc": {
              "py/id": 22
            }
          },
          "security_groups": [
            {
              "py/id": 25
            }
          ],
          "owner": {
            "py/id": 0
          },
          "inbound_connections": [],
          "outbound_connections": []
        }
      ]
    },
    "port": 5439,
    "db_name": "aws_redshift_cluster.test.database_name",
    "account": "111111111111",
    "subnet_group_name": "nondefault",
    "network_configuration": {
      "py/object": "cloudrail.knowledge.context.aws.ecs.network_configuration.NetworkConfiguration",
      "assign_public_ip": false,
      "security_groups": [],
      "subnet_list": [
        "aws_subnet.nondefault_1.id",
        "aws_subnet.nondefault_2.id"
      ]
    }
  },
  "test_public_connection_exists": {
    "py/object": "cloudrail.knowledge.context.aws.redshift.redshift.RedshiftCluster",
    "name": "redshift-defaults-only",
    "region": "eu-central-1",
    "network_resource": {
      "py/object": "cloudrail.knowledge.context.aws.networking_config.network_resource.NetworkResource",
      "network_interfaces": [
        {
          "py/object": "cloudrail.knowledge.context.aws.ec2.network_interface.NetworkInterface",
          "eni_id": "eni-fk-6557941e-195f-4504-b742-a77a5e805bd7",
          "subnet_id": "aws_subnet.nondefault_1.id",
          "primary_ip_address": "10.1.1.229",
          "secondary_ip_addresses": [],
          "public_ip_address": "0.0.0.0/0",
          "ipv6_ip_addresses": [],
          "security_groups_ids": [
            "aws_security_group.nondefault.id"
          ],
          "description": "",
          "is_primary": true,
          "availability_zone": "eu-central-1a",
          "subnet": {
            "py/object": "cloudrail.knowledge.context.aws.ec2.subnet.Subnet",
            "subnet_id": "aws_subnet.nondefault_1.id",
            "map_public_ip_on_launch": false,
            "vpc_id": "aws_vpc.nondefault.id",
            "cidr_block": "10.1.1.128/25",
            "name": "aws_subnet.nondefault_1.id",
            "state": null,
            "availability_zone": "eu-central-1a",
            "route_table": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.route_table.RouteTable",
              "route_table_id": "aws_route_table.nondefault.id",
              "vpc_id": "aws_vpc.nondefault.id",
              "routes": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.route.Route",
                  "route_table_id": "aws_route_table.nondefault.id",
                  "target": "aws_internet_gateway.igw.id",
                  "target_type": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.route.RouteTargetType"
                      },
                      {
                        "py/tuple": [
                          "GatewayId"
                        ]
                      }
                    ]
                  },
                  "destination": "0.0.0.0/0",
                  "peering_connection": null
                },
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.route.Route",
                  "route_table_id": "aws_route_table.nondefault.id",
                  "target": "local",
                  "target_type": {
                    "py/id": 11
                  },
                  "destination": "10.1.1.0/24",
                  "peering_connection": null
                }
              ],
              "name": "aws_route_table.nondefault.id",
              "_aliases": [
                "aws_route_table.nondefault.id"
              ]
            },
            "network_acl": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl.NetworkAcl",
              "network_acl_id": "aws_network_acl.public.id",
              "vpc_id": "aws_vpc.nondefault.id",
              "is_default": false,
              "name": "aws_network_acl.public.id",
              "subnets": [
                "aws_subnet.nondefault_1.id"
              ],
              "inbound_rules": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.NetworkAclRule",
                  "network_acl_id": "aws_network_acl.public.id",
                  "cidr_block": "0.0.0.0/0",
                  "from_port": 5439,
                  "to_port": 5439,
                  "rule_action": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.RuleAction"
                      },
                      {
                        "py/tuple": [
                          "allow"
                        ]
                      }
                    ]
                  },
                  "rule_number": 100,
                  "rule_type": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.RuleType"
                      },
                      {
                        "py/tuple": [
                          "inbound"
                        ]
                      }
                    ]
                  }
                }
              ],
              "outbound_rules": []
            },
            "vpc": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.vpc.Vpc",
              "vpc_id": "aws_vpc.nondefault.id",
              "cidr_block": [
                "10.1.1.0/24"
              ],
              "name": "aws_vpc.nondefault.id",
              "region": "us-east-1",
              "account": "111111111111",
              "friendly_name": "aws_vpc.nondefault.id",
              "main_route_table_id": "aws_vpc.nondefault.main_route_table_id",
              "default_route_table_id": "rt-fk-f5f988bf-a9a0-42bb-a2a8-9208360de8da",
              "is_default": false,
              "default_route_table": {
                "py/object": "cloudrail.knowledge.context.aws.ec2.route_table.RouteTable",
                "route_table_id": "rt-fk-f5f988bf-a9a0-42bb-a2a8-9208360de8da",
                "vpc_id": "aws_vpc.nondefault.id",
                "routes": [
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.route.Route",
                    "route_table_id": "rt-fk-f5f988bf-a9a0-42bb-a2a8-9208360de8da",
                    "target": "local",
                    "target_type": {
                      "py/id": 11
                    },
                    "destination": "10.1.1.0/24",
                    "peering_connection": null
                  }
                ],
                "name": "rt-fk-f5f988bf-a9a0-42bb-a2a8-9208360de8da",
                "_aliases": [
                  "rt-fk-f5f988bf-a9a0-42bb-a2a8-9208360de8da",
                  "aws_vpc.nondefault.default_route_table_id",
                  "aws_vpc.nondefault.main_route_table_id"
                ]
              },
              "main_route_table": {
                "py/id": 23
              },
              "endpoints": [],
              "default_security_group": {
                "py/object": "cloudrail.knowledge.context.aws.ec2.security_group.SecurityGroup",
                "security_group_id": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a",
                "name": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a",
                "description": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a",
                "vpc_id": "aws_vpc.nondefault.id",
                "inbound_permissions": [
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                    "from_port": 0,
                    "to_port": 65535,
                    "ip_protocol": "-1",
                    "property_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRulePropertyType"
                        },
                        {
                          "py/tuple": [
                            {
                              "py/tuple": [
                                "UserIdGroupPairs",
                                "GroupId"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    "property_value": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a",
                    "connection_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.ConnectionType"
                        },
                        {
                          "py/tuple": [
                            "inbound"
                          ]
                        }
                      ]
                    },
                    "security_group_id": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a"
                  }
                ],
                "outbound_permissions": [
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                    "from_port": 0,
                    "to_port": 65535,
                    "ip_protocol": "-1",
                    "property_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRulePropertyType"
                        },
                        {
                          "py/tuple": [
                            {
                              "py/tuple": [
                                "IpRanges",
                                "CidrIp"
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    "property_value": "0.0.0.0/0",
                    "connection_type": {
                      "py/reduce": [
                        {
                          "py/type": "cloudrail.knowledge.context.aws.ec2.security_group_rule.ConnectionType"
                        },
                        {
                          "py/tuple": [
                            "outbound"
                          ]
                        }
                      ]
                    },
                    "security_group_id": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a"
                  },
                  {
                    "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                    "from_port": 0,
                    "to_port": 65535,
                    "ip_protocol": "-1",
                    "property_type": {
                      "py/id": 35
                    },
                    "property_value": "::/0",
                    "connection_type": {
                      "py/id": 36
                    },
                    "security_group_id": "sg-fk-4d42fe34-f4f0-45f5-b14c-a634bfda0d9a"
                  }
                ],
                "is_default": true,
                "vpc": {
                  "py/id": 21
                }
              }
            }
          },
          "security_groups": [
            {
              "py/object": "cloudrail.knowledge.context.aws.ec2.security_group.SecurityGroup",
              "security_group_id": "aws_security_group.nondefault.id",
              "name": "aws_security_group.nondefault.id",
              "description": "Managed by Terraform",
              "vpc_id": "aws_vpc.nondefault.id",
              "inbound_permissions": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.security_group_rule.SecurityGroupRule",
                  "from_port": 5439,
                  "to_port": 5439,
                  "ip_protocol": "tcp",
                  "property_type": {
                    "py/id": 35
                  },
                  "property_value": "0.0.0.0/0",
                  "connection_type": {
                    "py/id": 32
                  },
                  "security_group_id": "aws_security_group.nondefault.id"
                }
              ],
              "outbound_permissions": [],
              "is_default": false,
              "vpc": {
                "py/id": 21
              }
            }
          ],
          "owner": {
            "py/id": 0
          },
          "inbound_connections": [
            {
              "py/object": "cloudrail.knowledge.context.connection.PublicConnectionDetail",
              "connection_property": {
                "py/object": "cloudrail.knowledge.context.connection.PortConnectionProperty",
                "ports": [
                  {
                    "py/tuple": [
                      5439,
                      5439
                    ]
                  }
                ],
                "friendly_connection_property": "Ports ranges: (5439 - 5439)",
                "cidr_block": "8.8.8.8"

              },
              "connection_direction_type": {
                "py/reduce": [
                  {
                    "py/type": "cloudrail.knowledge.context.connection.ConnectionDirectionType"
                  },
                  {
                    "py/tuple": [
                      "inbound"
                    ]
                  }
                ]
              }
            }
          ],
          "outbound_connections": []
        },
        {
          "py/object": "cloudrail.knowledge.context.aws.ec2.network_interface.NetworkInterface",
          "eni_id": "eni-fk-83250220-8926-42e2-b5fa-d725f43172da",
          "subnet_id": "aws_subnet.nondefault_2.id",
          "primary_ip_address": "10.1.1.104",
          "secondary_ip_addresses": [],
          "public_ip_address": "0.0.0.0/0",
          "ipv6_ip_addresses": [],
          "security_groups_ids": {
            "py/id": 6
          },
          "description": "",
          "is_primary": true,
          "availability_zone": "eu-central-1b",
          "subnet": {
            "py/object": "cloudrail.knowledge.context.aws.ec2.subnet.Subnet",
            "subnet_id": "aws_subnet.nondefault_2.id",
            "map_public_ip_on_launch": false,
            "vpc_id": "aws_vpc.nondefault.id",
            "cidr_block": "10.1.1.0/25",
            "name": "aws_subnet.nondefault_2.id",
            "state": null,
            "availability_zone": "eu-central-1b",
            "route_table": {
              "py/id": 8
            },
            "network_acl": {
              "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl.NetworkAcl",
              "network_acl_id": "aws_network_acl.private.id",
              "vpc_id": "aws_vpc.nondefault.id",
              "is_default": false,
              "name": "aws_network_acl.private.id",
              "subnets": [
                "aws_subnet.nondefault_2.id"
              ],
              "inbound_rules": [
                {
                  "py/object": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.NetworkAclRule",
                  "network_acl_id": "aws_network_acl.private.id",
                  "cidr_block": "0.0.0.0/0",
                  "from_port": 0,
                  "to_port": 65535,
                  "rule_action": {
                    "py/reduce": [
                      {
                        "py/type": "cloudrail.knowledge.context.aws.ec2.network_acl_rule.RuleAction"
                      },
                      {
                        "py/tuple": [
                          "deny"
                        ]
                      }
                    ]
                  },
                  "rule_number": 100,
                  "rule_type": {
                    "py/id": 19
                  }
                }
              ],
              "outbound_rules": []
            },
            "vpc": {
              "py/id": 21
            }
          },
          "security_groups": [
            {
              "py/id": 39
            }
          ],
          "owner": {
            "py/id": 0
          },
          "inbound_connections": [],
          "outbound_connections": []
        }
      ]
    },
    "port": 5439,
    "db_name": "aws_redshift_cluster.test.database_name",
    "account": "111111111111",
    "subnet_group_name": "nondefault",
    "network_configuration": {
      "py/object": "cloudrail.knowledge.context.aws.ecs.network_configuration.NetworkConfiguration",
      "assign_public_ip": true,
      "security_groups": {
        "py/id": 6
      },
      "subnet_list": [
        "aws_subnet.nondefault_1.id",
        "aws_subnet.nondefault_2.id"
      ]
    }
  }
}